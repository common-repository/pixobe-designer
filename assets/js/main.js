var IC=Object.defineProperty,TC=Object.defineProperties;var MC=Object.getOwnPropertyDescriptors;var zf=Object.getOwnPropertySymbols;var AC=Object.prototype.hasOwnProperty,OC=Object.prototype.propertyIsEnumerable;var $f=(i,e,t)=>e in i?IC(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ne=(i,e)=>{for(var t in e||={})AC.call(e,t)&&$f(i,t,e[t]);if(zf)for(var t of zf(e))OC.call(e,t)&&$f(i,t,e[t]);return i},ke=(i,e)=>TC(i,MC(e));function kC(i,e){return Object.is(i,e)}var Pe=null,Uo=!1,Go=1,cr=Symbol("SIGNAL");function X(i){let e=Pe;return Pe=i,e}function Wf(){return Pe}var zo={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Yf(i){if(Uo)throw new Error("");if(Pe===null)return;Pe.consumerOnSignalRead(i);let e=Pe.nextProducerIndex++;if(Wo(Pe),e<Pe.producerNode.length&&Pe.producerNode[e]!==i&&Ts(Pe)){let t=Pe.producerNode[e];$o(t,Pe.producerIndexOfThis[e])}Pe.producerNode[e]!==i&&(Pe.producerNode[e]=i,Pe.producerIndexOfThis[e]=Ts(Pe)?Kf(i,Pe,e):0),Pe.producerLastReadVersion[e]=i.version}function PC(){Go++}function NC(i){if(!(Ts(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===Go)){if(!i.producerMustRecompute(i)&&!El(i)){i.dirty=!1,i.lastCleanEpoch=Go;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=Go}}function qf(i){if(i.liveConsumerNode===void 0)return;let e=Uo;Uo=!0;try{for(let t of i.liveConsumerNode)t.dirty||RC(t)}finally{Uo=e}}function Xf(){return Pe?.consumerAllowSignalWrites!==!1}function RC(i){i.dirty=!0,qf(i),i.consumerMarkedDirty?.(i)}function xl(i){return i&&(i.nextProducerIndex=0),X(i)}function Zf(i,e){if(X(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(Ts(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)$o(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function El(i){Wo(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(NC(t),n!==t.version))return!0}return!1}function Il(i){if(Wo(i),Ts(i))for(let e=0;e<i.producerNode.length;e++)$o(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function Kf(i,e,t){if(Qf(i),i.liveConsumerNode.length===0&&Jf(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=Kf(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(t),i.liveConsumerNode.push(e)-1}function $o(i,e){if(Qf(i),i.liveConsumerNode.length===1&&Jf(i))for(let n=0;n<i.producerNode.length;n++)$o(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];Wo(r),r.producerIndexOfThis[n]=e}}function Ts(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function Wo(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function Qf(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function Jf(i){return i.producerNode!==void 0}function FC(){throw new Error}var ep=FC;function tp(){ep()}function np(i){ep=i}var LC=null;function ip(i){let e=Object.create(sp);e.value=i;let t=()=>(Yf(e),e.value);return t[cr]=e,t}function Tl(i,e){Xf()||tp(),i.equal(i.value,e)||(i.value=e,jC(i))}function rp(i,e){Xf()||tp(),Tl(i,e(i.value))}var sp=ke(ne({},zo),{equal:kC,value:void 0});function jC(i){i.version++,PC(),qf(i),LC?.()}function z(i){return typeof i=="function"}function Yo(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var qo=Yo(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ui(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var fe=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(z(n))try{n()}catch(s){e=s instanceof qo?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{op(s)}catch(o){e=e??[],o instanceof qo?e=[...e,...o.errors]:e.push(o)}}if(e)throw new qo(e)}}add(e){var t;if(e&&e!==this)if(this.closed)op(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ui(t,e)}remove(e){let{_finalizers:t}=this;t&&ui(t,e),e instanceof i&&e._removeParent(this)}};fe.EMPTY=(()=>{let i=new fe;return i.closed=!0,i})();var Ml=fe.EMPTY;function Xo(i){return i instanceof fe||i&&"closed"in i&&z(i.remove)&&z(i.add)&&z(i.unsubscribe)}function op(i){z(i)?i():i.unsubscribe()}var At={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var lr={setTimeout(i,e,...t){let{delegate:n}=lr;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=lr;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Zo(i){lr.setTimeout(()=>{let{onUnhandledError:e}=At;if(e)e(i);else throw i})}function Ms(){}var ap=Al("C",void 0,void 0);function cp(i){return Al("E",void 0,i)}function lp(i){return Al("N",i,void 0)}function Al(i,e,t){return{kind:i,value:e,error:t}}var di=null;function ur(i){if(At.useDeprecatedSynchronousErrorHandling){let e=!di;if(e&&(di={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=di;if(di=null,t)throw n}}else i()}function up(i){At.useDeprecatedSynchronousErrorHandling&&di&&(di.errorThrown=!0,di.error=i)}var hi=class extends fe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Xo(e)&&e.add(this)):this.destination=HC}static create(e,t,n){return new dr(e,t,n)}next(e){this.isStopped?kl(lp(e),this):this._next(e)}error(e){this.isStopped?kl(cp(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?kl(ap,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},VC=Function.prototype.bind;function Ol(i,e){return VC.call(i,e)}var Pl=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Ko(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Ko(n)}else Ko(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ko(t)}}},dr=class extends hi{constructor(e,t,n){super();let r;if(z(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&At.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Ol(e.next,s),error:e.error&&Ol(e.error,s),complete:e.complete&&Ol(e.complete,s)}):r=e}this.destination=new Pl(r)}};function Ko(i){At.useDeprecatedSynchronousErrorHandling?up(i):Zo(i)}function BC(i){throw i}function kl(i,e){let{onStoppedNotification:t}=At;t&&lr.setTimeout(()=>t(i,e))}var HC={closed:!0,next:Ms,error:BC,complete:Ms};var hr=typeof Symbol=="function"&&Symbol.observable||"@@observable";function fr(i){return i}function dp(i){return i.length===0?fr:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var de=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=GC(t)?t:new dr(t,n,r);return ur(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=hp(n),new n((r,s)=>{let o=new dr({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[hr](){return this}pipe(...t){return dp(t)(this)}toPromise(t){return t=hp(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function hp(i){var e;return(e=i??At.Promise)!==null&&e!==void 0?e:Promise}function UC(i){return i&&z(i.next)&&z(i.error)&&z(i.complete)}function GC(i){return i&&i instanceof hi||UC(i)&&Xo(i)}function zC(i){return z(i?.lift)}function we(i){return e=>{if(zC(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function _e(i,e,t,n,r){return new Nl(i,e,t,n,r)}var Nl=class extends hi{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var pr={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame,{delegate:n}=pr;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);let r=e(s=>{t=void 0,i(s)});return new fe(()=>t?.(r))},requestAnimationFrame(...i){let{delegate:e}=pr;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){let{delegate:e}=pr;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};var fp=Yo(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $=(()=>{class i extends de{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new Qo(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new fp}next(t){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?Ml:(this.currentObservers=null,s.push(t),new fe(()=>{this.currentObservers=null,ui(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new de;return t.source=this,t}}return i.create=(e,t)=>new Qo(e,t),i})(),Qo=class extends ${constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:Ml}};var fi=class extends ${constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var As={now(){return(As.delegate||Date).now()},delegate:void 0};var Os=class extends ${constructor(e=1/0,t=1/0,n=As){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){let o=t.now(),a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}};var Jo=class extends fe{constructor(e,t){super()}schedule(e,t=0){return this}};var ks={setInterval(i,e,...t){let{delegate:n}=ks;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){let{delegate:e}=ks;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};var gr=class extends Jo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return ks.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return t;t!=null&&ks.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(e,t);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n=!1,r;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ui(n,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var mr=class i{constructor(e,t=i.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}};mr.now=As.now;var vr=class extends mr{constructor(e,t=mr.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let n;this._active=!0;do if(n=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}};var Ps=new vr(gr),pp=Ps;var ea=class extends gr{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return n!==null&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=pr.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){var r;if(n!=null?n>0:this.delay>0)return super.recycleAsyncId(e,t,n);let{actions:s}=e;t!=null&&((r=s[s.length-1])===null||r===void 0?void 0:r.id)!==t&&(pr.cancelAnimationFrame(t),e._scheduled=void 0)}};var ta=class extends vr{flush(e){this._active=!0;let t=this._scheduled;this._scheduled=void 0;let{actions:n}=this,r;e=e||n.shift();do if(r=e.execute(e.state,e.delay))break;while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}}};var na=new ta(ea);var ia=new de(i=>i.complete());function ra(i){return i&&z(i.schedule)}function Rl(i){return i[i.length-1]}function gp(i){return z(Rl(i))?i.pop():void 0}function yr(i){return ra(Rl(i))?i.pop():void 0}function mp(i,e){return typeof Rl(i)=="number"?i.pop():e}function yp(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((n=n.apply(i,e||[])).next())})}function vp(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pi(i){return this instanceof pi?(this.v=i,this):new pi(i)}function _p(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r={},a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){n[f]&&(r[f]=function(g){return new Promise(function(y,_){s.push([f,g,y,_])>1||c(f,g)})},p&&(r[f]=p(r[f])))}function c(f,p){try{l(n[f](p))}catch(g){h(s[0][3],g)}}function l(f){f.value instanceof pi?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,p){f(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Cp(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof vp=="function"?vp(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,c){o=i[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var sa=i=>i&&typeof i.length=="number"&&typeof i!="function";function oa(i){return z(i?.then)}function aa(i){return z(i[hr])}function ca(i){return Symbol.asyncIterator&&z(i?.[Symbol.asyncIterator])}function la(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function $C(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ua=$C();function da(i){return z(i?.[ua])}function ha(i){return _p(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield pi(t.read());if(r)return yield pi(void 0);yield yield pi(n)}}finally{t.releaseLock()}})}function fa(i){return z(i?.getReader)}function Te(i){if(i instanceof de)return i;if(i!=null){if(aa(i))return WC(i);if(sa(i))return YC(i);if(oa(i))return qC(i);if(ca(i))return wp(i);if(da(i))return XC(i);if(fa(i))return ZC(i)}throw la(i)}function WC(i){return new de(e=>{let t=i[hr]();if(z(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function YC(i){return new de(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function qC(i){return new de(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Zo)})}function XC(i){return new de(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function wp(i){return new de(e=>{KC(i,e).catch(t=>e.error(t))})}function ZC(i){return wp(ha(i))}function KC(i,e){var t,n,r,s;return yp(this,void 0,void 0,function*(){try{for(t=Cp(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function vt(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function pa(i,e=0){return we((t,n)=>{t.subscribe(_e(n,r=>vt(n,i,()=>n.next(r),e),()=>vt(n,i,()=>n.complete(),e),r=>vt(n,i,()=>n.error(r),e)))})}function ga(i,e=0){return we((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function bp(i,e){return Te(i).pipe(ga(e),pa(e))}function Dp(i,e){return Te(i).pipe(ga(e),pa(e))}function Sp(i,e){return new de(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function xp(i,e){return new de(t=>{let n;return vt(t,e,()=>{n=i[ua](),vt(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>z(n?.return)&&n.return()})}function ma(i,e){if(!i)throw new Error("Iterable cannot be null");return new de(t=>{vt(t,e,()=>{let n=i[Symbol.asyncIterator]();vt(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Ep(i,e){return ma(ha(i),e)}function Ip(i,e){if(i!=null){if(aa(i))return bp(i,e);if(sa(i))return Sp(i,e);if(oa(i))return Dp(i,e);if(ca(i))return ma(i,e);if(da(i))return xp(i,e);if(fa(i))return Ep(i,e)}throw la(i)}function gi(i,e){return e?Ip(i,e):Te(i)}function Tp(i){return i instanceof Date&&!isNaN(i)}function ct(i,e){return we((t,n)=>{let r=0;t.subscribe(_e(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:QC}=Array;function JC(i,e){return QC(e)?i(...e):i(e)}function Mp(i){return ct(e=>JC(i,e))}var{isArray:e1}=Array,{getPrototypeOf:t1,prototype:n1,keys:i1}=Object;function Ap(i){if(i.length===1){let e=i[0];if(e1(e))return{args:e,keys:null};if(r1(e)){let t=i1(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function r1(i){return i&&typeof i=="object"&&t1(i)===n1}function Op(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function kp(i,e,t,n,r,s,o,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=g=>l<n?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let y=!1;Te(t(g,u++)).subscribe(_e(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{y=!0},void 0,()=>{if(y)try{for(l--;c.length&&l<n;){let _=c.shift();o?vt(e,o,()=>p(_)):p(_)}h()}catch(_){e.error(_)}}))};return i.subscribe(_e(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Fl(i,e,t=1/0){return z(e)?Fl((n,r)=>ct((s,o)=>e(n,s,r,o))(Te(i(n,r))),t):(typeof e=="number"&&(t=e),we((n,r)=>kp(n,r,i,t)))}function va(i=1/0){return Fl(fr,i)}function Pp(){return va(1)}function Ll(...i){return Pp()(gi(i,yr(i)))}function jl(...i){let e=gp(i),{args:t,keys:n}=Ap(i),r=new de(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;Te(t[u]).subscribe(_e(s,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(n?Op(n,a):a),s.complete())}))}});return e?r.pipe(Mp(e)):r}function ya(i=0,e,t=pp){let n=-1;return e!=null&&(ra(e)?t=e:n=e),new de(r=>{let s=Tp(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}function Vl(i=0,e=Ps){return i<0&&(i=0),ya(i,i,e)}function _r(...i){let e=yr(i),t=mp(i,1/0),n=i;return n.length?n.length===1?Te(n[0]):va(t)(gi(n,e)):ia}function Ns(i,e){return we((t,n)=>{let r=0;t.subscribe(_e(n,s=>i.call(e,s,r++)&&n.next(s)))})}function Np(i){return we((e,t)=>{let n=!1,r=null,s=null,o=!1,a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;let l=r;r=null,t.next(l)}o&&t.complete()},c=()=>{s=null,o&&t.complete()};e.subscribe(_e(t,l=>{n=!0,r=l,s||Te(i(l)).subscribe(s=_e(t,a,c))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}function Bl(i,e=Ps){return Np(()=>ya(i,e))}function Hl(i){return i<=0?()=>ia:we((e,t)=>{let n=0;e.subscribe(_e(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function _a(...i){let e=yr(i);return we((t,n)=>{(e?Ll(i,t,e):Ll(i,t)).subscribe(n)})}function Cr(i,e){return we((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(_e(n,c=>{r?.unsubscribe();let l=0,u=s++;Te(i(c,u)).subscribe(r=_e(n,d=>n.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Rs(i){return we((e,t)=>{Te(i).subscribe(_e(t,()=>t.complete(),Ms)),!t.closed&&e.subscribe(t)})}function Ul(i,e,t){let n=z(i)||e||t?{next:i,error:e,complete:t}:i;return n?we((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(_e(s,c=>{var l;(l=n.next)===null||l===void 0||l.call(n,c),s.next(c)},()=>{var c;a=!1,(c=n.complete)===null||c===void 0||c.call(n),s.complete()},c=>{var l;a=!1,(l=n.error)===null||l===void 0||l.call(n,c),s.error(c)},()=>{var c,l;a&&((c=n.unsubscribe)===null||c===void 0||c.call(n)),(l=n.finalize)===null||l===void 0||l.call(n)}))}):fr}var yg="https://g.co/ng/security#xss",G=class extends Error{constructor(e,t){super(td(e,t)),this.code=e}};function td(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}function Ys(i){return{toString:i}.toString()}var Ca="__parameters__";function s1(i){return function(...t){if(i){let n=i(...t);for(let r in n)this[r]=n[r]}}}function _g(i,e,t){return Ys(()=>{let n=s1(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(Ca)?c[Ca]:Object.defineProperty(c,Ca,{value:[]})[Ca];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}var ru=globalThis;function pe(i){for(let e in i)if(i[e]===pe)return e;throw Error("Could not find renamed property on target object.")}function o1(i,e){for(let t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function _t(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(_t).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function su(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var a1=pe({__forward_ref__:pe});function Vn(i){return i.__forward_ref__=Vn,i.toString=function(){return _t(this())},i}function je(i){return Cg(i)?i():i}function Cg(i){return typeof i=="function"&&i.hasOwnProperty(a1)&&i.__forward_ref__===Vn}function V(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function mn(i){return{providers:i.providers||[],imports:i.imports||[]}}function nd(i){return Rp(i,wg)||Rp(i,bg)}function Rp(i,e){return i.hasOwnProperty(e)?i[e]:null}function c1(i){let e=i&&(i[wg]||i[bg]);return e||null}function Fp(i){return i&&(i.hasOwnProperty(Lp)||i.hasOwnProperty(l1))?i[Lp]:null}var wg=pe({\u0275prov:pe}),Lp=pe({\u0275inj:pe}),bg=pe({ngInjectableDef:pe}),l1=pe({ngInjectorDef:pe}),L=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=V({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Dg(i){return i&&!!i.\u0275providers}var u1=pe({\u0275cmp:pe}),d1=pe({\u0275dir:pe}),h1=pe({\u0275pipe:pe});var Ma=pe({\u0275fac:pe}),Fs=pe({__NG_ELEMENT_ID__:pe}),jp=pe({__NG_ENV_ID__:pe});function Ka(i){return typeof i=="string"?i:i==null?"":String(i)}function f1(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():Ka(i)}function p1(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new G(-200,i)}function id(i,e){throw new G(-201,!1)}var W=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(W||{}),ou;function Sg(){return ou}function yt(i){let e=ou;return ou=i,e}function xg(i,e,t){let n=nd(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&W.Optional)return null;if(e!==void 0)return e;id(i,"Injector")}var g1={},Ls=g1,au="__NG_DI_FLAG__",Aa="ngTempTokenPath",m1="ngTokenPath",v1=/\n/gm,y1="\u0275",Vp="__source",xr;function _1(){return xr}function Nn(i){let e=xr;return xr=i,e}function C1(i,e=W.Default){if(xr===void 0)throw new G(-203,!1);return xr===null?xg(i,void 0,e):xr.get(i,e&W.Optional?null:void 0,e)}function N(i,e=W.Default){return(Sg()||C1)(je(i),e)}function B(i,e=W.Default){return N(i,Qa(e))}function Qa(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function cu(i){let e=[];for(let t=0;t<i.length;t++){let n=je(i[t]);if(Array.isArray(n)){if(n.length===0)throw new G(900,!1);let r,s=W.Default;for(let o=0;o<n.length;o++){let a=n[o],c=w1(a);typeof c=="number"?c===-1?r=a.token:s|=c:r=a}e.push(N(r,s))}else e.push(N(n))}return e}function Eg(i,e){return i[au]=e,i.prototype[au]=e,i}function w1(i){return i[au]}function b1(i,e,t,n){let r=i[Aa];throw e[Vp]&&r.unshift(e[Vp]),i.message=D1(`
`+i.message,r,t,n),i[m1]=r,i[Aa]=null,i}function D1(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==y1?i.slice(2):i;let r=_t(e);if(Array.isArray(e))r=e.map(_t).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):_t(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(v1,`
  `)}`}var Ig=Eg(_g("Optional"),8);var S1=Eg(_g("SkipSelf"),4);function Ir(i,e){let t=i.hasOwnProperty(Ma);return t?i[Ma]:null}function x1(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function E1(i){return i.flat(Number.POSITIVE_INFINITY)}function rd(i,e){i.forEach(t=>Array.isArray(t)?rd(t,e):e(t))}function Tg(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Oa(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function I1(i,e){let t=[];for(let n=0;n<i;n++)t.push(e);return t}function T1(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function sd(i,e,t){let n=qs(i,e);return n>=0?i[n|1]=t:(n=~n,T1(i,n,e,t)),n}function Gl(i,e){let t=qs(i,e);if(t>=0)return i[t|1]}function qs(i,e){return M1(i,e,1)}function M1(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var fn={},tt=[],js=new L(""),Mg=new L("",-1),Ag=new L(""),ka=class{get(e,t=Ls){if(t===Ls){let n=new Error(`NullInjectorError: No provider for ${_t(e)}!`);throw n.name="NullInjectorError",n}return t}},Og=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(Og||{}),$t=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}($t||{}),Tr=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(Tr||{});function A1(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function lu(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];k1(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function O1(i){return i===3||i===4||i===6}function k1(i){return i.charCodeAt(0)===64}function Vs(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?Bp(i,t,r,null,e[++n]):Bp(i,t,r,null,null))}}return i}function Bp(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var kg="ng-template";function P1(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&A1(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(od(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function od(i){return i.type===4&&i.value!==kg}function N1(i,e,t){let n=i.type===4&&!t?kg:i.value;return e===n}function R1(i,e,t){let n=4,r=i.attrs,s=r!==null?j1(r):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Ot(n)&&!Ot(c))return!1;if(o&&Ot(c))continue;o=!1,n=c|n&1;continue}if(!o)if(n&4){if(n=2|n&1,c!==""&&!N1(i,c,t)||c===""&&e.length===1){if(Ot(n))return!1;o=!0}}else if(n&8){if(r===null||!P1(i,r,c,t)){if(Ot(n))return!1;o=!0}}else{let l=e[++a],u=F1(c,r,od(i),t);if(u===-1){if(Ot(n))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=r[u+1].toLowerCase(),n&2&&l!==d){if(Ot(n))return!1;o=!0}}}}return Ot(n)||o}function Ot(i){return(i&1)===0}function F1(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return V1(e,i)}function Pg(i,e,t=!1){for(let n=0;n<e.length;n++)if(R1(i,e[n],t))return!0;return!1}function L1(i){let e=i.attrs;if(e!=null){let t=e.indexOf(5);if(!(t&1))return e[t+1]}return null}function j1(i){for(let e=0;e<i.length;e++){let t=i[e];if(O1(t))return e}return i.length}function V1(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function B1(i,e){e:for(let t=0;t<e.length;t++){let n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function Hp(i,e){return i?":not("+e.trim()+")":e}function H1(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!Ot(o)&&(e+=Hp(s,r),r=""),n=o,s=s||!Ot(n);t++}return r!==""&&(e+=Hp(s,r)),e}function U1(i){return i.map(H1).join(",")}function G1(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!Ot(r))break;r=s}n++}return{attrs:e,classes:t}}function J(i){return Ys(()=>{let e=Rg(i),t=ke(ne({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===Og.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||$t.Emulated,styles:i.styles||tt,_:null,schemas:i.schemas||null,tView:null,id:""});Fg(t);let n=i.dependencies;return t.directiveDefs=Gp(n,!1),t.pipeDefs=Gp(n,!0),t.id=Y1(t),t})}function z1(i){return yi(i)||ad(i)}function $1(i){return i!==null}function vn(i){return Ys(()=>({type:i.type,bootstrap:i.bootstrap||tt,declarations:i.declarations||tt,imports:i.imports||tt,exports:i.exports||tt,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function Up(i,e){if(i==null)return fn;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=Tr.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==Tr.None?[n,a]:n,e[s]=o):t[s]=n}return t}function ve(i){return Ys(()=>{let e=Rg(i);return Fg(e),e})}function yi(i){return i[u1]||null}function ad(i){return i[d1]||null}function Ng(i){return i[h1]||null}function W1(i){let e=yi(i)||ad(i)||Ng(i);return e!==null?e.standalone:!1}function Rg(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||fn,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||tt,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Up(i.inputs,e),outputs:Up(i.outputs),debugInfo:null}}function Fg(i){i.features?.forEach(e=>e(i))}function Gp(i,e){if(!i)return null;let t=e?Ng:z1;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter($1)}function Y1(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Lg(i){return{\u0275providers:i}}function q1(...i){return{\u0275providers:jg(!0,i),\u0275fromNgModule:!0}}function jg(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return rd(e,o=>{let a=o;uu(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&Vg(r,s),t}function Vg(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];cd(r,s=>{e(s,n)})}}function uu(i,e,t,n){if(i=je(i),!i)return!1;let r=null,s=Fp(i),o=!s&&yi(i);if(!s&&!o){let c=i.ngModule;if(s=Fp(c),s)r=c;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)uu(l,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let l;try{rd(s.imports,u=>{uu(u,e,t,n)&&(l||=[],l.push(u))})}finally{}l!==void 0&&Vg(l,e)}if(!a){let l=Ir(r)||(()=>new r);e({provide:r,useFactory:l,deps:tt},r),e({provide:Ag,useValue:r,multi:!0},r),e({provide:js,useValue:()=>N(r),multi:!0},r)}let c=s.providers;if(c!=null&&!a){let l=i;cd(c,u=>{e(u,l)})}}else return!1;return r!==i&&i.providers!==void 0}function cd(i,e){for(let t of i)Dg(t)&&(t=t.\u0275providers),Array.isArray(t)?cd(t,e):e(t)}var X1=pe({provide:String,useValue:pe});function Bg(i){return i!==null&&typeof i=="object"&&X1 in i}function Z1(i){return!!(i&&i.useExisting)}function K1(i){return!!(i&&i.useFactory)}function Mr(i){return typeof i=="function"}function Q1(i){return!!i.useClass}var Ja=new L(""),Da={},J1={},zl;function ec(){return zl===void 0&&(zl=new ka),zl}var Wt=class{},Bs=class extends Wt{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hu(e,o=>this.processProvider(o)),this.records.set(Mg,wr(void 0,this)),r.has("environment")&&this.records.set(Wt,wr(void 0,this));let s=this.records.get(Ja);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Ag,tt,W.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=X(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),X(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Nn(this),n=yt(void 0),r;try{return e()}finally{Nn(t),yt(n)}}get(e,t=Ls,n=W.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(jp))return e[jp](this);n=Qa(n);let r,s=Nn(this),o=yt(void 0);try{if(!(n&W.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=rw(e)&&nd(e);l&&this.injectableDefInScope(l)?c=wr(du(e),Da):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=n&W.Self?ec():this.parent;return t=n&W.Optional&&t===Ls?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Aa]=a[Aa]||[]).unshift(_t(e)),s)throw a;return b1(a,e,"R3InjectorError",this.source)}else throw a}finally{yt(o),Nn(s)}}resolveInjectorInitializers(){let e=X(null),t=Nn(this),n=yt(void 0),r;try{let s=this.get(js,tt,W.Self);for(let o of s)o()}finally{Nn(t),yt(n),X(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(_t(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new G(205,!1)}processProvider(e){e=je(e);let t=Mr(e)?e:je(e&&e.provide),n=tw(e);if(!Mr(e)&&e.multi===!0){let r=this.records.get(t);r||(r=wr(void 0,Da,!0),r.factory=()=>cu(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=X(null);try{return t.value===Da&&(t.value=J1,t.value=t.factory()),typeof t.value=="object"&&t.value&&iw(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{X(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=je(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function du(i){let e=nd(i),t=e!==null?e.factory:Ir(i);if(t!==null)return t;if(i instanceof L)throw new G(204,!1);if(i instanceof Function)return ew(i);throw new G(204,!1)}function ew(i){if(i.length>0)throw new G(204,!1);let t=c1(i);return t!==null?()=>t.factory(i):()=>new i}function tw(i){if(Bg(i))return wr(void 0,i.useValue);{let e=Hg(i);return wr(e,Da)}}function Hg(i,e,t){let n;if(Mr(i)){let r=je(i);return Ir(r)||du(r)}else if(Bg(i))n=()=>je(i.useValue);else if(K1(i))n=()=>i.useFactory(...cu(i.deps||[]));else if(Z1(i))n=()=>N(je(i.useExisting));else{let r=je(i&&(i.useClass||i.provide));if(nw(i))n=()=>new r(...cu(i.deps));else return Ir(r)||du(r)}return n}function wr(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function nw(i){return!!i.deps}function iw(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function rw(i){return typeof i=="function"||typeof i=="object"&&i instanceof L}function hu(i,e){for(let t of i)Array.isArray(t)?hu(t,e):t&&Dg(t)?hu(t.\u0275providers,e):e(t)}function sw(i,e){i instanceof Bs&&i.assertNotDestroyed();let t,n=Nn(i),r=yt(void 0);try{return e()}finally{Nn(n),yt(r)}}function Ug(){return Sg()!==void 0||_1()!=null}function ow(i){if(!Ug())throw new G(-203,!1)}function aw(i){return typeof i=="function"}var yn=0,P=1,k=2,$e=3,Pt=4,nt=5,Ar=6,Pa=7,Ge=8,Or=9,Yt=10,Ne=11,Hs=12,zp=13,Vr=14,lt=15,_i=16,br=17,pn=18,tc=19,Gg=20,Rn=21,$l=22,Ct=23,ut=25,zg=1;var Ci=7,Na=8,kr=9,ze=10,Ra=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Ra||{});function Fn(i){return Array.isArray(i)&&typeof i[zg]=="object"}function _n(i){return Array.isArray(i)&&i[zg]===!0}function $g(i){return(i.flags&4)!==0}function nc(i){return i.componentOffset>-1}function ld(i){return(i.flags&1)===1}function Ln(i){return!!i.template}function fu(i){return(i[k]&512)!==0}var Us=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function Wg(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function Kt(){return Yg}function Yg(i){return i.type.prototype.ngOnChanges&&(i.setInput=lw),cw}Kt.ngInherit=!0;function cw(){let i=Xg(this),e=i?.current;if(e){let t=i.previous;if(t===fn)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function lw(i,e,t,n,r){let s=this.declaredInputs[n],o=Xg(i)||uw(i,{previous:fn,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Us(l&&l.currentValue,t,c===fn),Wg(i,e,r,t)}var qg="__ngSimpleChanges__";function Xg(i){return i[qg]||null}function uw(i,e){return i[qg]=e}var $p=null;var Gt=function(i,e,t){$p?.(i,e,t)},Zg="svg",dw="math";function qt(i){for(;Array.isArray(i);)i=i[yn];return i}function Kg(i,e){return qt(e[i])}function wt(i,e){return qt(e[i.index])}function ud(i,e){return i.data[e]}function Bn(i,e){let t=e[i];return Fn(t)?t:t[yn]}function hw(i){return(i[k]&4)===4}function dd(i){return(i[k]&128)===128}function fw(i){return _n(i[$e])}function Pr(i,e){return e==null?null:i[e]}function Qg(i){i[br]=0}function Jg(i){i[k]&1024||(i[k]|=1024,dd(i)&&ic(i))}function pw(i,e){for(;i>0;)e=e[Vr],i--;return e}function Gs(i){return!!(i[k]&9216||i[Ct]?.dirty)}function pu(i){i[Yt].changeDetectionScheduler?.notify(7),i[k]&64&&(i[k]|=1024),Gs(i)&&ic(i)}function ic(i){i[Yt].changeDetectionScheduler?.notify(0);let e=wi(i);for(;e!==null&&!(e[k]&8192||(e[k]|=8192,!dd(e)));)e=wi(e)}function em(i,e){if((i[k]&256)===256)throw new G(911,!1);i[Rn]===null&&(i[Rn]=[]),i[Rn].push(e)}function gw(i,e){if(i[Rn]===null)return;let t=i[Rn].indexOf(e);t!==-1&&i[Rn].splice(t,1)}function wi(i){let e=i[$e];return _n(e)?e[$e]:e}var j={lFrame:hm(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var tm=!1;function mw(){return j.lFrame.elementDepthCount}function vw(){j.lFrame.elementDepthCount++}function yw(){j.lFrame.elementDepthCount--}function nm(){return j.bindingsEnabled}function im(){return j.skipHydrationRootTNode!==null}function _w(i){return j.skipHydrationRootTNode===i}function Cw(){j.skipHydrationRootTNode=null}function Y(){return j.lFrame.lView}function Ve(){return j.lFrame.tView}function Be(i){return j.lFrame.contextLView=i,i[Ge]}function He(i){return j.lFrame.contextLView=null,i}function it(){let i=rm();for(;i!==null&&i.type===64;)i=i.parent;return i}function rm(){return j.lFrame.currentTNode}function ww(){let i=j.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function Xs(i,e){let t=j.lFrame;t.currentTNode=i,t.isParent=e}function sm(){return j.lFrame.isParent}function om(){j.lFrame.isParent=!1}function am(){return tm}function Wp(i){tm=i}function bw(){let i=j.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function Dw(i){return j.lFrame.bindingIndex=i}function Zs(){return j.lFrame.bindingIndex++}function cm(i){let e=j.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function Sw(){return j.lFrame.inI18n}function xw(i,e){let t=j.lFrame;t.bindingIndex=t.bindingRootIndex=i,gu(e)}function Ew(){return j.lFrame.currentDirectiveIndex}function gu(i){j.lFrame.currentDirectiveIndex=i}function Iw(i){let e=j.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function lm(){return j.lFrame.currentQueryIndex}function hd(i){j.lFrame.currentQueryIndex=i}function Tw(i){let e=i[P];return e.type===2?e.declTNode:e.type===1?i[nt]:null}function um(i,e,t){if(t&W.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&W.Host);)if(r=Tw(s),r===null||(s=s[Vr],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=j.lFrame=dm();return n.currentTNode=e,n.lView=i,!0}function fd(i){let e=dm(),t=i[P];j.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function dm(){let i=j.lFrame,e=i===null?null:i.child;return e===null?hm(i):e}function hm(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function fm(){let i=j.lFrame;return j.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var pm=fm;function pd(){let i=fm();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Mw(i){return(j.lFrame.contextLView=pw(i,j.lFrame.contextLView))[Ge]}function Hn(){return j.lFrame.selectedIndex}function bi(i){j.lFrame.selectedIndex=i}function gm(){let i=j.lFrame;return ud(i.tView,i.selectedIndex)}function ae(){j.lFrame.currentNamespace=Zg}function Ze(){Aw()}function Aw(){j.lFrame.currentNamespace=null}function Ow(){return j.lFrame.currentNamespace}var mm=!0;function gd(){return mm}function md(i){mm=i}function kw(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=Yg(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function vd(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),c&&(i.viewHooks??=[]).push(-t,c),l&&((i.viewHooks??=[]).push(t,l),(i.viewCheckHooks??=[]).push(t,l)),u!=null&&(i.destroyHooks??=[]).push(t,u)}}function Sa(i,e,t){vm(i,e,3,t)}function xa(i,e,t,n){(i[k]&3)===t&&vm(i,e,t,n)}function Wl(i,e){let t=i[k];(t&3)===e&&(t&=16383,t+=1,i[k]=t)}function vm(i,e,t,n){let r=n!==void 0?i[br]&65535:0,s=n??-1,o=e.length-1,a=0;for(let c=r;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],n!=null&&a>=n)break}else e[c]<0&&(i[br]+=65536),(a<s||s==-1)&&(Pw(i,t,e,c),i[br]=(i[br]&4294901760)+c+2),c++}function Yp(i,e){Gt(4,i,e);let t=X(null);try{e.call(i)}finally{X(t),Gt(5,i,e)}}function Pw(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[k]>>14<i[br]>>16&&(i[k]&3)===e&&(i[k]+=16384,Yp(a,s)):Yp(a,s)}var Er=-1,Di=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function Nw(i){return i instanceof Di}function Rw(i){return(i.flags&8)!==0}function Fw(i){return(i.flags&16)!==0}var Yl={},mu=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Qa(n);let r=this.injector.get(e,Yl,n);return r!==Yl||t===Yl?r:this.parentInjector.get(e,t,n)}};function ym(i){return i!==Er}function Fa(i){return i&32767}function Lw(i){return i>>16}function La(i,e){let t=Lw(i),n=e;for(;t>0;)n=n[Vr],t--;return n}var vu=!0;function qp(i){let e=vu;return vu=i,e}var jw=256,_m=jw-1,Cm=5,Vw=0,zt={};function Bw(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(Fs)&&(n=t[Fs]),n==null&&(n=t[Fs]=Vw++);let r=n&_m,s=1<<r;e.data[i+(r>>Cm)]|=s}function ja(i,e){let t=wm(i,e);if(t!==-1)return t;let n=e[P];n.firstCreatePass&&(i.injectorIndex=e.length,ql(n.data,i),ql(e,null),ql(n.blueprint,null));let r=yd(i,e),s=i.injectorIndex;if(ym(r)){let o=Fa(r),a=La(r,e),c=a[P].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function ql(i,e){i.push(0,0,0,0,0,0,0,0,e)}function wm(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function yd(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=Em(r),n===null)return Er;if(t++,r=r[Vr],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return Er}function yu(i,e,t){Bw(i,e,t)}function bm(i,e,t){if(t&W.Optional||i!==void 0)return i;id(e,"NodeInjector")}function Dm(i,e,t,n){if(t&W.Optional&&n===void 0&&(n=null),!(t&(W.Self|W.Host))){let r=i[Or],s=yt(void 0);try{return r?r.get(e,n,t&W.Optional):xg(e,n,t&W.Optional)}finally{yt(s)}}return bm(n,e,t)}function Sm(i,e,t,n=W.Default,r){if(i!==null){if(e[k]&2048&&!(n&W.Self)){let o=zw(i,e,t,n,zt);if(o!==zt)return o}let s=xm(i,e,t,n,zt);if(s!==zt)return s}return Dm(e,t,n,r)}function xm(i,e,t,n,r){let s=Uw(t);if(typeof s=="function"){if(!um(e,i,n))return n&W.Host?bm(r,t,n):Dm(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&W.Optional))id(t);else return o}finally{pm()}}else if(typeof s=="number"){let o=null,a=wm(i,e),c=Er,l=n&W.Host?e[lt][nt]:null;for((a===-1||n&W.SkipSelf)&&(c=a===-1?yd(i,e):e[a+8],c===Er||!Zp(n,!1)?a=-1:(o=e[P],a=Fa(c),e=La(c,e)));a!==-1;){let u=e[P];if(Xp(s,a,u.data)){let d=Hw(a,e,t,o,n,l);if(d!==zt)return d}c=e[a+8],c!==Er&&Zp(n,e[P].data[a+8]===l)&&Xp(s,a,e)?(o=u,a=Fa(c),e=La(c,e)):a=-1}}return r}function Hw(i,e,t,n,r,s){let o=e[P],a=o.data[i+8],c=n==null?nc(a)&&vu:n!=o&&(a.type&3)!==0,l=r&W.Host&&s===a,u=Ea(a,o,t,c,l);return u!==null?Si(e,o,u,a):zt}function Ea(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,c=i.directiveStart,l=i.directiveEnd,u=s>>20,d=n?a:a+u,h=r?a+u:l;for(let f=d;f<h;f++){let p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){let f=o[c];if(f&&Ln(f)&&f.type===t)return c}return null}function Si(i,e,t,n){let r=i[t],s=e.data;if(Nw(r)){let o=r;o.resolving&&p1(f1(s[t]));let a=qp(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?yt(o.injectImpl):null,u=um(i,n,W.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&kw(t,s[t],e)}finally{l!==null&&yt(l),qp(a),o.resolving=!1,pm()}}return r}function Uw(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(Fs)?i[Fs]:void 0;return typeof e=="number"?e>=0?e&_m:Gw:e}function Xp(i,e,t){let n=1<<i;return!!(t[e+(i>>Cm)]&n)}function Zp(i,e){return!(i&W.Self)&&!(i&W.Host&&e)}var vi=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Sm(this._tNode,this._lView,e,Qa(n),t)}};function Gw(){return new vi(it(),Y())}function _d(i){return Ys(()=>{let e=i.prototype.constructor,t=e[Ma]||_u(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[Ma]||_u(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function _u(i){return Cg(i)?()=>{let e=_u(je(i));return e&&e()}:Ir(i)}function zw(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[k]&2048&&!(o[k]&512);){let a=xm(s,o,t,n|W.Self,zt);if(a!==zt)return a;let c=s.parent;if(!c){let l=o[Gg];if(l){let u=l.get(t,zt,n);if(u!==zt)return u}c=Em(o),o=o[Vr]}s=c}return r}function Em(i){let e=i[P],t=e.type;return t===2?e.declTNode:t===1?i[nt]:null}function Kp(i,e=null,t=null,n){let r=$w(i,e,t,n);return r.resolveInjectorInitializers(),r}function $w(i,e=null,t=null,n,r=new Set){let s=[t||tt,q1(i)];return n=n||(typeof i=="object"?void 0:_t(i)),new Bs(s,e||ec(),n||null,r)}var mi=class mi{static create(e,t){if(Array.isArray(e))return Kp({name:""},t,e,"");{let n=e.name??"";return Kp({name:n},e.parent,e.providers,n)}}};mi.THROW_IF_NOT_FOUND=Ls,mi.NULL=new ka,mi.\u0275prov=V({token:mi,providedIn:"any",factory:()=>N(Mg)}),mi.__NG_ELEMENT_ID__=-1;var dt=mi;var Ww=new L("");Ww.__NG_ELEMENT_ID__=i=>{let e=it();if(e===null)throw new G(204,!1);if(e.type&2)return e.value;if(i&W.Optional)return null;throw new G(204,!1)};var Yw="ngOriginalError";function Xl(i){return i[Yw]}var Xt=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Xl(e);for(;t&&Xl(t);)t=Xl(t);return t||null}},Im=new L("",{providedIn:"root",factory:()=>B(Xt).handleError.bind(void 0)}),Cd=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=qw,e.__NG_ENV_ID__=n=>n;let i=e;return i})(),Cu=class extends Cd{constructor(e){super(),this._lView=e}onDestroy(e){return em(this._lView,e),()=>gw(this._lView,e)}};function qw(){return new Cu(Y())}function Xw(){return Br(it(),Y())}function Br(i,e){return new ye(wt(i,e))}var ye=(()=>{let e=class e{constructor(n){this.nativeElement=n}};e.__NG_ELEMENT_ID__=Xw;let i=e;return i})();function Zw(i){return i instanceof ye?i.nativeElement:i}var rc=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new fi(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let i=e;return i})();var wu=class extends ${constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,Ug()&&(this.destroyRef=B(Cd,{optional:!0})??void 0,this.pendingTasks=B(rc,{optional:!0})??void 0)}emit(e){let t=X(null);try{super.next(e)}finally{X(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof fe&&e.add(a),a}wrapInTimeout(e){return t=>{let n=this.pendingTasks?.add();setTimeout(()=>{e(t),n!==void 0&&this.pendingTasks?.remove(n)})}}},se=wu;function Kw(){return this._results[Symbol.iterator]()}var bu=class i{get changes(){return this._changes??=new se}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=Kw)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=E1(e);(this._changesDetected=!x1(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function Tm(i){return(i.flags&128)===128}var Mm=new Map,Qw=0;function Jw(){return Qw++}function eb(i){Mm.set(i[tc],i)}function tb(i){Mm.delete(i[tc])}var Qp="__ngContext__";function xi(i,e){Fn(e)?(i[Qp]=e[tc],eb(e)):i[Qp]=e}function Am(i){return km(i[Hs])}function Om(i){return km(i[Pt])}function km(i){for(;i!==null&&!_n(i);)i=i[Pt];return i}var Du;function Pm(i){Du=i}function nb(){if(Du!==void 0)return Du;if(typeof document<"u")return document;throw new G(210,!1)}var wd=new L("",{providedIn:"root",factory:()=>ib}),ib="ng",bd=new L(""),Cn=new L("",{providedIn:"platform",factory:()=>"unknown"});var Dd=new L("",{providedIn:"root",factory:()=>nb().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var rb="h",sb="b";var ob=()=>null;function Sd(i,e,t=!1){return ob(i,e,t)}var Nm=!1,ab=new L("",{providedIn:"root",factory:()=>Nm});var Va=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${yg})`}};function Ks(i){return i instanceof Va?i.changingThisBreaksApplicationSecurity:i}function Rm(i,e){let t=cb(i);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${yg})`)}return t===e}function cb(i){return i instanceof Va&&i.getTypeName()||null}var lb=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Fm(i){return i=String(i),i.match(lb)?i:"unsafe:"+i}var xd=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(xd||{});function Qs(i){let e=ub();return e?e.sanitize(xd.URL,i)||"":Rm(i,"URL")?Ks(i):Fm(Ka(i))}function ub(){let i=Y();return i&&i[Yt].sanitizer}function db(i){return(i??B(dt)).get(Cn)==="browser"}var Zt=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(Zt||{}),hb;function Ed(i,e){return hb(i,e)}function Dr(i,e,t,n,r){if(n!=null){let s,o=!1;_n(n)?s=n:Fn(n)&&(o=!0,n=n[yn]);let a=qt(n);i===0&&t!==null?r==null?Hm(e,t,a):Ba(e,t,a,r||null,!0):i===1&&t!==null?Ba(e,t,a,r||null,!0):i===2?Eb(e,a,o):i===3&&e.destroyNode(a),s!=null&&Tb(e,i,s,t,r)}}function fb(i,e){return i.createText(e)}function pb(i,e,t){i.setValue(e,t)}function Lm(i,e,t){return i.createElement(e,t)}function gb(i,e){jm(i,e),e[yn]=null,e[nt]=null}function mb(i,e,t,n,r,s){n[yn]=r,n[nt]=e,oc(i,n,t,1,r,s)}function jm(i,e){e[Yt].changeDetectionScheduler?.notify(8),oc(i,e,e[Ne],2,null,null)}function vb(i){let e=i[Hs];if(!e)return Zl(i[P],i);for(;e;){let t=null;if(Fn(e))t=e[Hs];else{let n=e[ze];n&&(t=n)}if(!t){for(;e&&!e[Pt]&&e!==i;)Fn(e)&&Zl(e[P],e),e=e[$e];e===null&&(e=i),Fn(e)&&Zl(e[P],e),t=e&&e[Pt]}e=t}}function yb(i,e,t,n){let r=ze+n,s=t.length;n>0&&(t[r-1][Pt]=e),n<s-ze?(e[Pt]=t[r],Tg(t,ze+n,e)):(t.push(e),e[Pt]=null),e[$e]=t;let o=e[_i];o!==null&&t!==o&&Vm(o,e);let a=e[pn];a!==null&&a.insertView(i),pu(e),e[k]|=128}function Vm(i,e){let t=i[kr],n=e[$e];if(Fn(n))i[k]|=Ra.HasTransplantedViews;else{let r=n[$e][lt];e[lt]!==r&&(i[k]|=Ra.HasTransplantedViews)}t===null?i[kr]=[e]:t.push(e)}function Id(i,e){let t=i[kr],n=t.indexOf(e);t.splice(n,1)}function zs(i,e){if(i.length<=ze)return;let t=ze+e,n=i[t];if(n){let r=n[_i];r!==null&&r!==i&&Id(r,n),e>0&&(i[t-1][Pt]=n[Pt]);let s=Oa(i,ze+e);gb(n[P],n);let o=s[pn];o!==null&&o.detachView(s[P]),n[$e]=null,n[Pt]=null,n[k]&=-129}return n}function sc(i,e){if(!(e[k]&256)){let t=e[Ne];t.destroyNode&&oc(i,e,t,3,null,null),vb(e)}}function Zl(i,e){if(e[k]&256)return;let t=X(null);try{e[k]&=-129,e[k]|=256,e[Ct]&&Il(e[Ct]),Cb(i,e),_b(i,e),e[P].type===1&&e[Ne].destroy();let n=e[_i];if(n!==null&&_n(e[$e])){n!==e[$e]&&Id(n,e);let r=e[pn];r!==null&&r.detachView(i)}tb(e)}finally{X(t)}}function _b(i,e){let t=i.cleanup,n=e[Pa];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[Pa]=null);let r=e[Rn];if(r!==null){e[Rn]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function Cb(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof Di)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],c=s[o+1];Gt(4,a,c);try{c.call(a)}finally{Gt(5,a,c)}}else{Gt(4,r,s);try{s.call(r)}finally{Gt(5,r,s)}}}}}function Bm(i,e,t){return wb(i,e.parent,t)}function wb(i,e,t){let n=e;for(;n!==null&&n.type&168;)e=n,n=e.parent;if(n===null)return t[yn];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===$t.None||s===$t.Emulated)return null}return wt(n,t)}}function Ba(i,e,t,n,r){i.insertBefore(e,t,n,r)}function Hm(i,e,t){i.appendChild(e,t)}function Jp(i,e,t,n,r){n!==null?Ba(i,e,t,n,r):Hm(i,e,t)}function bb(i,e,t,n){i.removeChild(e,t,n)}function Td(i,e){return i.parentNode(e)}function Db(i,e){return i.nextSibling(e)}function Um(i,e,t){return xb(i,e,t)}function Sb(i,e,t){return i.type&40?wt(i,t):null}var xb=Sb,eg;function Md(i,e,t,n){let r=Bm(i,n,e),s=e[Ne],o=n.parent||e[nt],a=Um(o,n,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)Jp(s,r,t[c],a,!1);else Jp(s,r,t,a,!1);eg!==void 0&&eg(s,n,e,t,r)}function Ia(i,e){if(e!==null){let t=e.type;if(t&3)return wt(e,i);if(t&4)return Su(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return Ia(i,n);{let r=i[e.index];return _n(r)?Su(-1,r):qt(r)}}else{if(t&32)return Ed(e,i)()||qt(i[e.index]);{let n=Gm(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=wi(i[lt]);return Ia(r,n)}else return Ia(i,e.next)}}}return null}function Gm(i,e){if(e!==null){let n=i[lt][nt],r=e.projection;return n.projection[r]}return null}function Su(i,e){let t=ze+i+1;if(t<e.length){let n=e[t],r=n[P].firstChild;if(r!==null)return Ia(n,r)}return e[Ci]}function Eb(i,e,t){let n=Td(i,e);n&&bb(i,n,e,t)}function Ad(i,e,t,n,r,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=n[t.index],c=t.type;if(o&&e===0&&(a&&xi(qt(a),n),t.flags|=2),(t.flags&32)!==32)if(c&8)Ad(i,e,t.child,n,r,s,!1),Dr(e,i,r,a,s);else if(c&32){let l=Ed(t,n),u;for(;u=l();)Dr(e,i,r,u,s);Dr(e,i,r,a,s)}else c&16?zm(i,e,n,t,r,s):Dr(e,i,r,a,s);t=o?t.projectionNext:t.next}}function oc(i,e,t,n,r,s){Ad(t,n,i.firstChild,e,r,s,!1)}function Ib(i,e,t){let n=e[Ne],r=Bm(i,t,e),s=t.parent||e[nt],o=Um(s,t,e);zm(n,0,e,t,r,o)}function zm(i,e,t,n,r,s){let o=t[lt],c=o[nt].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Dr(e,i,r,u,s)}else{let l=c,u=o[$e];Tm(n)&&(l.flags|=128),Ad(i,e,l,u,r,s,!0)}}function Tb(i,e,t,n,r){let s=t[Ci],o=qt(t);s!==o&&Dr(e,i,n,s,r);for(let a=ze;a<t.length;a++){let c=t[a];oc(c[P],c,i,e,n,s)}}function Mb(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:Zt.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Zt.Important),i.setStyle(t,n,r,s))}}function Ab(i,e,t){i.setAttribute(e,"style",t)}function $m(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function Wm(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&lu(i,e,n),r!==null&&$m(i,e,r),s!==null&&Ab(i,e,s)}var Qt={};function F(i=1){Ym(Ve(),Y(),Hn()+i,!1)}function Ym(i,e,t,n){if(!n)if((e[k]&3)===3){let s=i.preOrderCheckHooks;s!==null&&Sa(e,s,t)}else{let s=i.preOrderHooks;s!==null&&xa(e,s,0,t)}bi(t)}function D(i,e=W.Default){let t=Y();if(t===null)return N(i,e);let n=it();return Sm(n,t,je(i),e)}function qm(i,e,t,n,r,s){let o=X(null);try{let a=null;r&Tr.SignalBased&&(a=e[n][cr]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&Tr.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):Wg(e,a,n,s)}finally{X(o)}}function Ob(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)bi(~r);else{let s=r,o=t[++n],a=t[++n];xw(o,s);let c=e[s];a(2,c)}}}finally{bi(-1)}}function ac(i,e,t,n,r,s,o,a,c,l,u){let d=e.blueprint.slice();return d[yn]=r,d[k]=n|4|128|8|64,(l!==null||i&&i[k]&2048)&&(d[k]|=2048),Qg(d),d[$e]=d[Vr]=i,d[Ge]=t,d[Yt]=o||i&&i[Yt],d[Ne]=a||i&&i[Ne],d[Or]=c||i&&i[Or]||null,d[nt]=s,d[tc]=Jw(),d[Ar]=u,d[Gg]=l,d[lt]=e.type==2?i[lt]:d,d}function Js(i,e,t,n,r){let s=i.data[e];if(s===null)s=kb(i,e,t,n,r),Sw()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=ww();s.injectorIndex=o===null?-1:o.injectorIndex}return Xs(s,!0),s}function kb(i,e,t,n,r){let s=rm(),o=sm(),a=o?s:s&&s.parent,c=i.data[e]=jb(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function Xm(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function Zm(i,e,t,n,r){let s=Hn(),o=n&2;try{bi(-1),o&&e.length>ut&&Ym(i,e,ut,!1),Gt(o?2:0,r),t(n,r)}finally{bi(s),Gt(o?3:1,r)}}function Km(i,e,t){if($g(e)){let n=X(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{X(n)}}}function Qm(i,e,t){nm()&&($b(i,e,t,wt(t,e)),(t.flags&64)===64&&iv(i,e,t))}function Jm(i,e,t=wt){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function ev(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=Od(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function Od(i,e,t,n,r,s,o,a,c,l,u){let d=ut+n,h=d+r,f=Pb(d,h),p=typeof l=="function"?l():l;return f[P]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function Pb(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:Qt);return t}function Nb(i,e,t,n){let s=n.get(ab,Nm)||t===$t.ShadowDom,o=i.selectRootElement(e,s);return Rb(o),o}function Rb(i){Fb(i)}var Fb=()=>null;function Lb(i,e,t,n){let r=ov(e);r.push(t),i.firstCreatePass&&av(i).push(n,r.length-1)}function jb(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return im()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function tg(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,c=Tr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(r!==null){if(!r.hasOwnProperty(s))continue;l=r[s]}i===0?ng(n,t,l,a,c):ng(n,t,l,a)}return n}function ng(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function Vb(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],c=null,l=null;for(let u=n;u<r;u++){let d=s[u],h=t?t.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=tg(0,d.inputs,u,c,f),l=tg(1,d.outputs,u,l,p);let g=c!==null&&o!==null&&!od(e)?nD(c,u,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function Bb(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function Hb(i,e,t,n,r,s,o,a){let c=wt(e,t),l=e.inputs,u;!a&&l!=null&&(u=l[n])?(kd(i,t,u,n,r),nc(e)&&Ub(t,e.index)):e.type&3?(n=Bb(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(c,n,r)):e.type&12}function Ub(i,e){let t=Bn(e,i);t[k]&16||(t[k]|=64)}function tv(i,e,t,n){if(nm()){let r=n===null?null:{"":-1},s=Yb(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&nv(i,e,t,o,r,a),r&&qb(t,n,r)}t.mergedAttrs=Vs(t.mergedAttrs,t.attrs)}function nv(i,e,t,n,r,s){for(let l=0;l<n.length;l++)yu(ja(t,e),i,n[l].type);Zb(t,i.data.length,n.length);for(let l=0;l<n.length;l++){let u=n[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=Xm(i,e,n.length,null);for(let l=0;l<n.length;l++){let u=n[l];t.mergedAttrs=Vs(t.mergedAttrs,u.hostAttrs),Kb(i,t,e,c,u),Xb(c,u,r),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}Vb(i,t,s)}function Gb(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;zb(o)!=a&&o.push(a),o.push(t,n,s)}}function zb(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function $b(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;nc(t)&&Qb(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||ja(t,e),xi(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let c=i.data[a],l=Si(e,i,a,t);if(xi(l,e),o!==null&&tD(e,a-r,l,c,t,o),Ln(c)){let u=Bn(t.index,e);u[Ge]=Si(e,i,a,t)}}}function iv(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=Ew();try{bi(s);for(let a=n;a<r;a++){let c=i.data[a],l=e[a];gu(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Wb(c,l)}}finally{bi(-1),gu(o)}}function Wb(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function Yb(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(Pg(e,o.selectors,!1))if(n||(n=[]),Ln(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let c=a.length;xu(i,e,c)}else n.unshift(o),xu(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function xu(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function qb(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new G(-301,!1);n.push(e[r],s)}}}function Xb(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Ln(e)&&(t[""]=i)}}function Zb(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function Kb(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=Ir(r.type,!0)),o=new Di(s,Ln(r),D);i.blueprint[n]=o,t[n]=o,Gb(i,e,n,Xm(i,t,r.hostVars,Qt),r)}function Qb(i,e,t){let n=wt(e,i),r=ev(t),s=i[Yt].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=cc(i,ac(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function Jb(i,e,t,n,r,s){let o=wt(i,e);eD(e[Ne],o,s,i.value,t,n,r)}function eD(i,e,t,n,r,s,o){if(s==null)i.removeAttribute(e,r,t);else{let a=o==null?Ka(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}function tD(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],d=o[a++];qm(n,t,c,l,u,d)}}function nD(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function rv(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function sv(i,e){let t=i.contentQueries;if(t!==null){let n=X(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];hd(s),a.contentQueries(2,e[o],o)}}}finally{X(n)}}}function cc(i,e){return i[Hs]?i[zp][Pt]=e:i[Hs]=e,i[zp]=e,e}function Eu(i,e,t){hd(0);let n=X(null);try{e(i,t)}finally{X(n)}}function ov(i){return i[Pa]??=[]}function av(i){return i.cleanup??=[]}function cv(i,e){let t=i[Or],n=t?t.get(Xt,null):null;n&&n.handleError(e)}function kd(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],u=i.data[o];qm(u,l,n,a,c,r)}}function iD(i,e,t){let n=Kg(e,i);pb(i[Ne],n,t)}function rD(i,e){let t=Bn(e,i),n=t[P];sD(n,t);let r=t[yn];r!==null&&t[Ar]===null&&(t[Ar]=Sd(r,t[Or])),Pd(n,t,t[Ge])}function sD(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function Pd(i,e,t){fd(e);try{let n=i.viewQuery;n!==null&&Eu(1,n,t);let r=i.template;r!==null&&Zm(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[pn]?.finishViewCreation(i),i.staticContentQueries&&sv(i,e),i.staticViewQueries&&Eu(2,i.viewQuery,t);let s=i.components;s!==null&&oD(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[k]&=-5,pd()}}function oD(i,e){for(let t=0;t<e.length;t++)rD(i,e[t])}function eo(i,e,t,n){let r=X(null);try{let s=e.tView,a=i[k]&4096?4096:16,c=ac(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),l=i[e.index];c[_i]=l;let u=i[pn];return u!==null&&(c[pn]=u.createEmbeddedView(s)),Pd(s,c,t),c}finally{X(r)}}function lv(i,e){let t=ze+e;if(t<i.length)return i[t]}function Nr(i,e){return!e||e.firstChild===null||Tm(i)}function to(i,e,t,n=!0){let r=e[P];if(yb(r,e,i,t),n){let o=Su(t,i),a=e[Ne],c=Td(a,i[Ci]);c!==null&&mb(r,i[nt],a,e,c,o)}let s=e[Ar];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function uv(i,e){let t=zs(i,e);return t!==void 0&&sc(t[P],t),t}function Ha(i,e,t,n,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&n.push(qt(s)),_n(s)&&aD(s,n);let o=t.type;if(o&8)Ha(i,e,t.child,n);else if(o&32){let a=Ed(t,e),c;for(;c=a();)n.push(c)}else if(o&16){let a=Gm(e,t);if(Array.isArray(a))n.push(...a);else{let c=wi(e[lt]);Ha(c[P],c,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function aD(i,e){for(let t=ze;t<i.length;t++){let n=i[t],r=n[P].firstChild;r!==null&&Ha(n[P],n,r,e)}i[Ci]!==i[yn]&&e.push(i[Ci])}var dv=[];function cD(i){return i[Ct]??lD(i)}function lD(i){let e=dv.pop()??Object.create(dD);return e.lView=i,e}function uD(i){i.lView[Ct]!==i&&(i.lView=null,dv.push(i))}var dD=ke(ne({},zo),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{ic(i.lView)},consumerOnSignalRead(){this.lView[Ct]=this}});function hD(i){let e=i[Ct]??Object.create(fD);return e.lView=i,e}var fD=ke(ne({},zo),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{let e=wi(i.lView);for(;e&&!hv(e[P]);)e=wi(e);e&&Jg(e)},consumerOnSignalRead(){this.lView[Ct]=this}});function hv(i){return i.type!==2}var pD=100;function fv(i,e=!0,t=0){let n=i[Yt],r=n.rendererFactory,s=!1;s||r.begin?.();try{gD(i,t)}catch(o){throw e&&cv(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function gD(i,e){let t=am();try{Wp(!0),Iu(i,e);let n=0;for(;Gs(i);){if(n===pD)throw new G(103,!1);n++,Iu(i,1)}}finally{Wp(t)}}function mD(i,e,t,n){let r=e[k];if((r&256)===256)return;let s=!1,o=!1;!s&&e[Yt].inlineEffectRunner?.flush(),fd(e);let a=!0,c=null,l=null;s||(hv(i)?(l=cD(e),c=xl(l)):Wf()===null?(a=!1,l=hD(e),c=xl(l)):e[Ct]&&(Il(e[Ct]),e[Ct]=null));try{Qg(e),Dw(i.bindingStartIndex),t!==null&&Zm(i,e,t,2,n);let u=(r&3)===3;if(!s)if(u){let f=i.preOrderCheckHooks;f!==null&&Sa(e,f,null)}else{let f=i.preOrderHooks;f!==null&&xa(e,f,0,null),Wl(e,0)}if(o||vD(e),pv(e,0),i.contentQueries!==null&&sv(i,e),!s)if(u){let f=i.contentCheckHooks;f!==null&&Sa(e,f)}else{let f=i.contentHooks;f!==null&&xa(e,f,1),Wl(e,1)}Ob(i,e);let d=i.components;d!==null&&mv(e,d,0);let h=i.viewQuery;if(h!==null&&Eu(2,h,n),!s)if(u){let f=i.viewCheckHooks;f!==null&&Sa(e,f)}else{let f=i.viewHooks;f!==null&&xa(e,f,2),Wl(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[$l]){for(let f of e[$l])f();e[$l]=null}s||(e[k]&=-73)}catch(u){throw s||ic(e),u}finally{l!==null&&(Zf(l,c),a&&uD(l)),pd()}}function pv(i,e){for(let t=Am(i);t!==null;t=Om(t))for(let n=ze;n<t.length;n++){let r=t[n];gv(r,e)}}function vD(i){for(let e=Am(i);e!==null;e=Om(e)){if(!(e[k]&Ra.HasTransplantedViews))continue;let t=e[kr];for(let n=0;n<t.length;n++){let r=t[n];Jg(r)}}}function yD(i,e,t){let n=Bn(e,i);gv(n,t)}function gv(i,e){dd(i)&&Iu(i,e)}function Iu(i,e){let n=i[P],r=i[k],s=i[Ct],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&El(s)),o||=!1,s&&(s.dirty=!1),i[k]&=-9217,o)mD(n,i,n.template,i[Ge]);else if(r&8192){pv(i,1);let a=n.components;a!==null&&mv(i,a,1)}}function mv(i,e,t){for(let n=0;n<e.length;n++)yD(i,e[n],t)}function Nd(i,e){let t=am()?64:1088;for(i[Yt].changeDetectionScheduler?.notify(e);i;){i[k]|=t;let n=wi(i);if(fu(i)&&!n)return i;i=n}return null}var Ei=class{get rootNodes(){let e=this._lView,t=e[P];return Ha(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ge]}set context(e){this._lView[Ge]=e}get destroyed(){return(this._lView[k]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[$e];if(_n(e)){let t=e[Na],n=t?t.indexOf(this):-1;n>-1&&(zs(e,n),Oa(t,n))}this._attachedToViewContainer=!1}sc(this._lView[P],this._lView)}onDestroy(e){em(this._lView,e)}markForCheck(){Nd(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[k]&=-129}reattach(){pu(this._lView),this._lView[k]|=128}detectChanges(){this._lView[k]|=1024,fv(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new G(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=fu(this._lView),t=this._lView[_i];t!==null&&!e&&Id(t,this._lView),jm(this._lView[P],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new G(902,!1);this._appRef=e;let t=fu(this._lView),n=this._lView[_i];n!==null&&!t&&Vm(n,this._lView),pu(this._lView)}},gn=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=wD;let i=e;return i})(),_D=gn,CD=class extends _D{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=eo(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new Ei(r)}};function wD(){return Rd(it(),Y())}function Rd(i,e){return i.type&4?new CD(e,i,Br(i,e)):null}var GP=new RegExp(`^(\\d+)*(${sb}|${rb})*(.*)`);var bD=()=>null;function Rr(i,e){return bD(i,e)}var Ii=class{},Fd=new L("",{providedIn:"root",factory:()=>!1});var vv=new L(""),Tu=class{},Ua=class{};function DD(i){let e=Error(`No component factory found for ${_t(i)}.`);return e[SD]=i,e}var SD="ngComponent";var Mu=class{resolveComponentFactory(e){throw DD(e)}},$d=class $d{};$d.NULL=new Mu;var jn=$d,Fr=class{},bt=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>xD();let i=e;return i})();function xD(){let i=Y(),e=it(),t=Bn(e.index,i);return(Fn(t)?t:i)[Ne]}var ED=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let i=e;return i})();var ig=new Set;function Mi(i){ig.has(i)||(ig.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function yv(i){let e=!0;return setTimeout(()=>{e&&(e=!1,i())}),typeof ru.requestAnimationFrame=="function"&&ru.requestAnimationFrame(()=>{e&&(e=!1,i())}),()=>{e=!1}}function rg(i){let e=!0;return queueMicrotask(()=>{e&&i()}),()=>{e=!1}}function sg(...i){}var oe=class i{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new se(!1),this.onMicrotaskEmpty=new se(!1),this.onStable=new se(!1),this.onError=new se(!1),typeof Zone>"u")throw new G(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.callbackScheduled=!1,MD(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new G(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new G(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,ID,sg,sg);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},ID={};function Ld(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function TD(i){i.isCheckStableRunning||i.callbackScheduled||(i.callbackScheduled=!0,Zone.root.run(()=>{yv(()=>{i.callbackScheduled=!1,Au(i),i.isCheckStableRunning=!0,Ld(i),i.isCheckStableRunning=!1})}),Au(i))}function MD(i){let e=()=>{TD(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{if(AD(a))return t.invokeTask(r,s,o,a);try{return og(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),ag(i)}},onInvoke:(t,n,r,s,o,a,c)=>{try{return og(i),t.invoke(r,s,o,a,c)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!OD(a)&&e(),ag(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&(s.change=="microTask"?(i._hasPendingMicrotasks=s.microTask,Au(i),Ld(i)):s.change=="macroTask"&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}function Au(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function og(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function ag(i){i._nesting--,Ld(i)}var Ga=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new se,this.onMicrotaskEmpty=new se,this.onStable=new se,this.onError=new se}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}};function AD(i){return _v(i,"__ignore_ng_zone__")}function OD(i){return _v(i,"__scheduler_tick__")}function _v(i,e){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[e]===!0}var Sr=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(Sr||{}),kD={destroy(){}};function jd(i,e){!e&&ow(jd);let t=e?.injector??B(dt);if(!db(t))return kD;Mi("NgAfterNextRender");let n=t.get(Vd),r=n.handler??=new ku,s=e?.phase??Sr.MixedReadWrite,o=()=>{r.unregister(c),a()},a=t.get(Cd).onDestroy(o),c=sw(t,()=>new Ou(s,()=>{o(),i()}));return r.register(c),{destroy:o}}var Ou=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=B(oe),this.errorHandler=B(Xt,{optional:!0}),B(Ii,{optional:!0})?.notify(6)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},ku=class{constructor(){this.executingCallbacks=!1,this.buckets={[Sr.EarlyRead]:new Set,[Sr.Write]:new Set,[Sr.MixedReadWrite]:new Set,[Sr.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Vd=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of n)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let i=e;return i})();function Pu(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=su(r,a);else if(s==2){let c=a,l=e[++o];n=su(n,c+": "+l+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var Nu=class extends jn{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=yi(e);return new $s(t,this.ngModule)}};function cg(i){let e=[];for(let t in i){if(!i.hasOwnProperty(t))continue;let n=i[t];n!==void 0&&e.push({propName:Array.isArray(n)?n[0]:n,templateName:t})}return e}function PD(i){let e=i.toLowerCase();return e==="svg"?Zg:e==="math"?dw:null}var $s=class extends Ua{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=cg(e.inputs);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return cg(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=U1(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=X(null);try{r=r||this.ngModule;let o=r instanceof Wt?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new mu(e,o):e,c=a.get(Fr,null);if(c===null)throw new G(407,!1);let l=a.get(ED,null),u=a.get(Vd,null),d=a.get(Ii,null),h={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=n?Nb(f,n,this.componentDef.encapsulation,a):Lm(f,p,PD(p)),y=512;this.componentDef.signals?y|=4096:this.componentDef.onPush||(y|=16);let _=null;g!==null&&(_=Sd(g,a,!0));let b=Od(0,null,null,1,0,null,null,null,null,null,null),S=ac(null,b,null,y,null,null,h,f,a,null,_);fd(S);let E,A;try{let O=this.componentDef,R,M=null;O.findHostDirectiveDefs?(R=[],M=new Map,O.findHostDirectiveDefs(O,R,M),R.push(O)):R=[O];let le=ND(S,g),me=RD(le,g,O,R,S,h,f);A=ud(b,ut),g&&jD(f,O,g,n),t!==void 0&&VD(A,this.ngContentSelectors,t),E=LD(me,O,R,M,S,[BD]),Pd(b,S,null)}finally{pd()}return new Ru(this.componentType,E,Br(A,S),S,A)}finally{X(s)}}},Ru=class extends Tu{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ei(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;kd(s[P],s,r,e,t),this.previousInputValues.set(e,t);let o=Bn(this._tNode.index,s);Nd(o,1)}}get injector(){return new vi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function ND(i,e){let t=i[P],n=ut;return i[n]=e,Js(t,n,2,"#host",null)}function RD(i,e,t,n,r,s,o){let a=r[P];FD(n,i,e,o);let c=null;e!==null&&(c=Sd(e,r[Or]));let l=s.rendererFactory.createRenderer(e,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let d=ac(r,ev(t),null,u,r[i.index],i,s,l,null,null,c);return a.firstCreatePass&&xu(a,i,n.length-1),cc(r,d),r[i.index]=d}function FD(i,e,t,n){for(let r of i)e.mergedAttrs=Vs(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(Pu(e,e.mergedAttrs,!0),t!==null&&Wm(n,t,e))}function LD(i,e,t,n,r,s){let o=it(),a=r[P],c=wt(o,r);nv(a,r,o,t,null,n);for(let u=0;u<t.length;u++){let d=o.directiveStart+u,h=Si(r,a,d,o);xi(h,r)}iv(a,r,o),c&&xi(c,r);let l=Si(r,a,o.directiveStart+o.componentOffset,o);if(i[Ge]=r[Ge]=l,s!==null)for(let u of s)u(l,e);return Km(a,o,r),l}function jD(i,e,t,n){if(n)lu(i,t,["ng-version","18.0.5"]);else{let{attrs:r,classes:s}=G1(e.selectors[0]);r&&lu(i,t,r),s&&s.length>0&&$m(i,t,s.join(" "))}}function VD(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function BD(){let i=it();vd(Y()[P],i)}var Nt=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=HD;let i=e;return i})();function HD(){let i=it();return wv(i,Y())}var UD=Nt,Cv=class extends UD{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Br(this._hostTNode,this._hostLView)}get injector(){return new vi(this._hostTNode,this._hostLView)}get parentInjector(){let e=yd(this._hostTNode,this._hostLView);if(ym(e)){let t=La(e,this._hostLView),n=Fa(e),r=t[P].data[n+8];return new vi(r,t)}else return new vi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=lg(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ze}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=Rr(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,Nr(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!aw(e),a;if(o)a=t;else{let p=t||{};a=p.index,n=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new $s(yi(e)),l=n||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?l:this.parentInjector).get(Wt,null);g&&(s=g)}let u=yi(c.componentType??{}),d=Rr(this._lContainer,u?.id??null),h=d?.firstChild??null,f=c.create(l,r,h,s);return this.insertImpl(f.hostView,a,Nr(this._hostTNode,d)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(fw(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[$e],l=new Cv(c,c[nt],c[$e]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return to(o,r,s,n),e.attachToViewContainerRef(),Tg(Kl(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=lg(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=zs(this._lContainer,t);n&&(Oa(Kl(this._lContainer),t),sc(n[P],n))}detach(e){let t=this._adjustIndex(e,-1),n=zs(this._lContainer,t);return n&&Oa(Kl(this._lContainer),t)!=null?new Ei(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function lg(i){return i[Na]}function Kl(i){return i[Na]||(i[Na]=[])}function wv(i,e){let t,n=e[i.index];return _n(n)?t=n:(t=rv(n,e,null,i),e[i.index]=t,cc(e,t)),zD(t,e,i,n),new Cv(t,i,e)}function GD(i,e){let t=i[Ne],n=t.createComment(""),r=wt(e,i),s=Td(t,r);return Ba(t,s,n,Db(t,r),!1),n}var zD=YD,$D=()=>!1;function WD(i,e,t){return $D(i,e,t)}function YD(i,e,t,n){if(i[Ci])return;let r;t.type&8?r=qt(n):r=GD(e,t),i[Ci]=r}var Fu=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},Lu=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Bd(e,t).matches!==null&&this.queries[t].setDirty()}},za=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=tS(e):this.predicate=e}},ju=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Vu=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,qD(t,s)),this.matchTNodeWithReadOption(e,t,Ea(t,e,s,!1,!1))}else n===gn?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ea(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===ye||r===Nt||r===gn&&t.type&4)this.addMatch(t.index,-2);else{let s=Ea(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function qD(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function XD(i,e){return i.type&11?Br(i,e):i.type&4?Rd(i,e):null}function ZD(i,e,t,n){return t===-1?XD(e,i):t===-2?KD(i,e,n):Si(i,i[P],t,e)}function KD(i,e,t){if(t===ye)return Br(e,i);if(t===gn)return Rd(e,i);if(t===Nt)return wv(e,i)}function bv(i,e,t,n){let r=e[pn].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let u=s[l];a.push(ZD(e,u,o[c+1],t.metadata.read))}}r.matches=a}return r.matches}function Bu(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=bv(i,e,r,t);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)n.push(o[a/2]);else{let l=s[a+1],u=e[-c];for(let d=ze;d<u.length;d++){let h=u[d];h[_i]===h[$e]&&Bu(h[P],h,l,n)}if(u[kr]!==null){let d=u[kr];for(let h=0;h<d.length;h++){let f=d[h];Bu(f[P],f,l,n)}}}}}return n}function QD(i,e){return i[pn].queries[e].queryList}function Dv(i,e,t){let n=new bu((t&4)===4);return Lb(i,e,n,n.destroy),(e[pn]??=new Lu).queries.push(new Fu(n))-1}function JD(i,e,t){let n=Ve();return n.firstCreatePass&&(Sv(n,new za(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),Dv(n,Y(),e)}function eS(i,e,t,n){let r=Ve();if(r.firstCreatePass){let s=it();Sv(r,new za(e,t,n),s.index),nS(r,i),(t&2)===2&&(r.staticContentQueries=!0)}return Dv(r,Y(),t)}function tS(i){return i.split(",").map(e=>e.trim())}function Sv(i,e,t){i.queries===null&&(i.queries=new ju),i.queries.track(new Vu(e,t))}function nS(i,e){let t=i.contentQueries||(i.contentQueries=[]),n=t.length?t[t.length-1]:-1;e!==n&&t.push(i.queries.length-1,e)}function Bd(i,e){return i.queries.getByIndex(e)}function iS(i,e){let t=i[P],n=Bd(t,e);return n.crossesNgTemplate?Bu(t,i,e,[]):bv(t,i,n,e)}function Dt(i,e){Mi("NgSignals");let t=ip(i),n=t[cr];return e?.equal&&(n.equal=e.equal),t.set=r=>Tl(n,r),t.update=r=>rp(n,r),t.asReadonly=rS.bind(t),t}function rS(){let i=this[cr];if(i.readonlyFn===void 0){let e=()=>this();e[cr]=i,i.readonlyFn=e}return i.readonlyFn}function sS(i){return Object.getPrototypeOf(i.prototype).constructor}function Rt(i){let e=sS(i.type),t=!0,n=[i];for(;e;){let r;if(Ln(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new G(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);let o=i;o.inputs=wa(i.inputs),o.inputTransforms=wa(i.inputTransforms),o.declaredInputs=wa(i.declaredInputs),o.outputs=wa(i.outputs);let a=r.hostBindings;a&&uS(i,a);let c=r.viewQuery,l=r.contentQueries;if(c&&cS(i,c),l&&lS(i,l),oS(i,r),o1(i.outputs,r.outputs),Ln(r)&&r.data.animation){let u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}let s=r.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(i),a===Rt&&(t=!1)}}e=Object.getPrototypeOf(e)}aS(n)}function oS(i,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||i.inputs.hasOwnProperty(t))continue;let n=e.inputs[t];if(n!==void 0&&(i.inputs[t]=n,i.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let r=Array.isArray(n)?n[0]:n;if(!e.inputTransforms.hasOwnProperty(r))continue;i.inputTransforms??={},i.inputTransforms[r]=e.inputTransforms[r]}}}function aS(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){let r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=Vs(r.hostAttrs,t=Vs(t,r.hostAttrs))}}function wa(i){return i===fn?{}:i===tt?[]:i}function cS(i,e){let t=i.viewQuery;t?i.viewQuery=(n,r)=>{e(n,r),t(n,r)}:i.viewQuery=e}function lS(i,e){let t=i.contentQueries;t?i.contentQueries=(n,r,s)=>{e(n,r,s),t(n,r,s)}:i.contentQueries=e}function uS(i,e){let t=i.hostBindings;t?i.hostBindings=(n,r)=>{e(n,r),t(n,r)}:i.hostBindings=e}function xv(i){let e=t=>{let n=(Array.isArray(i)?i:i()).map(r=>typeof r=="function"?{directive:je(r),inputs:fn,outputs:fn}:{directive:je(r.directive),inputs:ug(r.inputs),outputs:ug(r.outputs)});t.hostDirectives===null?(t.findHostDirectiveDefs=Ev,t.hostDirectives=n):t.hostDirectives.unshift(...n)};return e.ngInherit=!0,e}function Ev(i,e,t){if(i.hostDirectives!==null)for(let n of i.hostDirectives){let r=ad(n.directive);dS(r.declaredInputs,n.inputs),Ev(r,e,t),t.set(r,n),e.push(r)}}function ug(i){if(i===void 0||i.length===0)return fn;let e={};for(let t=0;t<i.length;t+=2)e[i[t]]=i[t+1];return e}function dS(i,e){for(let t in e)if(e.hasOwnProperty(t)){let n=e[t],r=i[t];i[n]=r}}function no(i){let e=i.inputConfig,t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];Array.isArray(r)&&r[3]&&(t[n]=r[3])}i.inputTransforms=t}var Lr=class{};var $a=class extends Lr{constructor(e){super(),this.componentFactoryResolver=new Nu(this),this.instance=null;let t=new Bs([...e.providers,{provide:Lr,useValue:this},{provide:jn,useValue:this.componentFactoryResolver}],e.parent||ec(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function hS(i,e,t=null){return new $a({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function Iv(i){return i!==null&&(typeof i=="function"||typeof i=="object")}function fS(i,e,t){return i[e]=t}function Un(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function pS(i){return(i.flags&32)===32}function gS(i,e,t,n,r,s,o,a,c){let l=e.consts,u=Js(e,i,4,o||null,a||null);tv(e,t,u,Pr(l,c)),vd(e,u);let d=u.tView=Od(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function Wa(i,e,t,n,r,s,o,a,c,l){let u=t+ut,d=e.firstCreatePass?gS(u,e,i,n,r,s,o,a,c):e.data[u];Xs(d,!1);let h=mS(e,i,d,t);gd()&&Md(e,i,h,d),xi(h,i);let f=rv(h,i,h,d);return i[u]=f,cc(i,f),WD(f,d,i),ld(d)&&Qm(e,i,d),c!=null&&Jm(i,d,l),d}function Re(i,e,t,n,r,s,o,a){let c=Y(),l=Ve(),u=Pr(l.consts,s);return Wa(c,l,i,e,t,n,r,u,o,a),Re}var mS=vS;function vS(i,e,t,n){return md(!0),e[Ne].createComment("")}function Hr(i,e,t,n){let r=Y(),s=Zs();if(Un(r,s,e)){let o=Ve(),a=gm();Jb(a,r,i,e,t,n)}return Hr}function Tv(i,e,t,n){return Un(i,Zs(),t)?e+Ka(t)+n:Qt}function ba(i,e){return i<<17|e<<2}function Ti(i){return i>>17&32767}function yS(i){return(i&2)==2}function _S(i,e){return i&131071|e<<17}function Hu(i){return i|2}function jr(i){return(i&131068)>>2}function Ql(i,e){return i&-131069|e<<2}function CS(i){return(i&1)===1}function Uu(i){return i|1}function wS(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Ti(o),c=jr(o);i[n]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||qs(d,u)>0)&&(l=!0)}else u=t;if(r)if(c!==0){let h=Ti(i[a+1]);i[n+1]=ba(h,a),h!==0&&(i[h+1]=Ql(i[h+1],n)),i[a+1]=_S(i[a+1],n)}else i[n+1]=ba(a,0),a!==0&&(i[a+1]=Ql(i[a+1],n)),a=n;else i[n+1]=ba(c,0),a===0?a=n:i[c+1]=Ql(i[c+1],n),c=n;l&&(i[n+1]=Hu(i[n+1])),dg(i,u,n,!0),dg(i,u,n,!1),bS(e,u,i,n,s),o=ba(a,c),s?e.classBindings=o:e.styleBindings=o}function bS(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&qs(s,e)>=0&&(t[n+1]=Uu(t[n+1]))}function dg(i,e,t,n){let r=i[t+1],s=e===null,o=n?Ti(r):jr(r),a=!1;for(;o!==0&&(a===!1||s);){let c=i[o],l=i[o+1];DS(c,e)&&(a=!0,i[o+1]=n?Uu(l):Hu(l)),o=n?Ti(l):jr(l)}a&&(i[t+1]=n?Hu(r):Uu(r))}function DS(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?qs(i,e)>=0:!1}var kt={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function SS(i){return i.substring(kt.key,kt.keyEnd)}function xS(i){return ES(i),Mv(i,Av(i,0,kt.textEnd))}function Mv(i,e){let t=kt.textEnd;return t===e?-1:(e=kt.keyEnd=IS(i,kt.key=e,t),Av(i,e,t))}function ES(i){kt.key=0,kt.keyEnd=0,kt.value=0,kt.valueEnd=0,kt.textEnd=i.length}function Av(i,e,t){for(;e<t&&i.charCodeAt(e)<=32;)e++;return e}function IS(i,e,t){for(;e<t&&i.charCodeAt(e)>32;)e++;return e}function H(i,e,t){let n=Y(),r=Zs();if(Un(n,r,e)){let s=Ve(),o=gm();Hb(s,o,n,i,e,n[Ne],t,!1)}return H}function Gu(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";kd(i,t,s[o],o,n)}function Ai(i,e,t){return Ov(i,e,t,!1),Ai}function Oi(i,e){return Ov(i,e,null,!0),Oi}function TS(i,e){for(let t=xS(e);t>=0;t=Mv(e,t))sd(i,SS(e),!0)}function Ov(i,e,t,n){let r=Y(),s=Ve(),o=cm(2);if(s.firstUpdatePass&&Pv(s,i,o,n),e!==Qt&&Un(r,o,e)){let a=s.data[Hn()];Nv(s,a,r,r[Ne],i,r[o+1]=FS(e,t),n,o)}}function MS(i,e,t,n){let r=Ve(),s=cm(2);r.firstUpdatePass&&Pv(r,null,s,n);let o=Y();if(t!==Qt&&Un(o,s,t)){let a=r.data[Hn()];if(Rv(a,n)&&!kv(r,s)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=su(c,t||"")),Gu(r,a,o,t,n)}else RS(r,a,o,o[Ne],o[s+1],o[s+1]=NS(i,e,t),n,s)}}function kv(i,e){return e>=i.expandoStartIndex}function Pv(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[Hn()],o=kv(i,t);Rv(s,n)&&e===null&&!o&&(e=!1),e=AS(r,s,e,n),wS(r,s,e,t,o,n)}}function AS(i,e,t,n){let r=Iw(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=Jl(null,i,e,t,n),t=Ws(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=Jl(r,i,e,t,n),s===null){let c=OS(i,e,n);c!==void 0&&Array.isArray(c)&&(c=Jl(null,i,e,c[1],n),c=Ws(c,e.attrs,n),kS(i,e,n,c))}else s=PS(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function OS(i,e,t){let n=t?e.classBindings:e.styleBindings;if(jr(n)!==0)return i[Ti(n)]}function kS(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[Ti(r)]=n}function PS(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=Ws(n,o,t)}return Ws(n,e.attrs,t)}function Jl(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=Ws(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function Ws(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),sd(i,o,t?!0:e[++s]))}return i===void 0?null:i}function NS(i,e,t){if(t==null||t==="")return tt;let n=[],r=Ks(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)i(n,r[s],!0);else if(typeof r=="object")for(let s in r)r.hasOwnProperty(s)&&i(n,s,r[s]);else typeof r=="string"&&e(n,r);return n}function RS(i,e,t,n,r,s,o,a){r===Qt&&(r=tt);let c=0,l=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;u!==null||d!==null;){let h=c<r.length?r[c+1]:void 0,f=l<s.length?s[l+1]:void 0,p=null,g;u===d?(c+=2,l+=2,h!==f&&(p=d,g=f)):d===null||u!==null&&u<d?(c+=2,p=u):(l+=2,p=d,g=f),p!==null&&Nv(i,e,t,n,p,g,o,a),u=c<r.length?r[c]:null,d=l<s.length?s[l]:null}}function Nv(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let c=i.data,l=c[a+1],u=CS(l)?hg(c,e,t,r,jr(l),o):void 0;if(!Ya(u)){Ya(s)||yS(l)&&(s=hg(c,null,t,r,a,o));let d=Kg(Hn(),t);Mb(n,o,d,r,s)}}function hg(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let c=i[r],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=t[r+1];h===Qt&&(h=d?tt:void 0);let f=d?Gl(h,n):u===n?h:void 0;if(l&&!Ya(f)&&(f=Gl(c,n)),Ya(f)&&(a=f,o))return a;let p=i[r+1];r=o?Ti(p):jr(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Gl(c,n))}return a}function Ya(i){return i!==void 0}function FS(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=_t(Ks(i)))),i}function Rv(i,e){return(i.flags&(e?8:16))!==0}function Fv(i,e,t){let n=Y(),r=Tv(n,i,e,t);MS(sd,TS,r,!0)}var zu=class{destroy(e){}updateValue(e,t){}swap(e,t){let n=Math.min(e,t),r=Math.max(e,t),s=this.detach(r);if(r-n>1){let o=this.detach(n);this.attach(n,s),this.attach(r,o)}else this.attach(n,s)}move(e,t){this.attach(t,this.detach(e))}};function eu(i,e,t,n,r){return i===t&&Object.is(e,n)?1:Object.is(r(i,e),r(t,n))?-1:0}function LS(i,e,t){let n,r,s=0,o=i.length-1,a=void 0;if(Array.isArray(e)){let c=e.length-1;for(;s<=o&&s<=c;){let l=i.at(s),u=e[s],d=eu(s,l,s,u,t);if(d!==0){d<0&&i.updateValue(s,u),s++;continue}let h=i.at(o),f=e[c],p=eu(o,h,c,f,t);if(p!==0){p<0&&i.updateValue(o,f),o--,c--;continue}let g=t(s,l),y=t(o,h),_=t(s,u);if(Object.is(_,y)){let b=t(c,f);Object.is(b,g)?(i.swap(s,o),i.updateValue(o,f),c--,o--):i.move(o,s),i.updateValue(s,u),s++;continue}if(n??=new qa,r??=pg(i,s,o,t),$u(i,n,s,_))i.updateValue(s,u),s++,o++;else if(r.has(_))n.set(g,i.detach(s)),o--;else{let b=i.create(s,e[s]);i.attach(s,b),s++,o++}}for(;s<=c;)fg(i,n,t,s,e[s]),s++}else if(e!=null){let c=e[Symbol.iterator](),l=c.next();for(;!l.done&&s<=o;){let u=i.at(s),d=l.value,h=eu(s,u,s,d,t);if(h!==0)h<0&&i.updateValue(s,d),s++,l=c.next();else{n??=new qa,r??=pg(i,s,o,t);let f=t(s,d);if($u(i,n,s,f))i.updateValue(s,d),s++,o++,l=c.next();else if(!r.has(f))i.attach(s,i.create(s,d)),s++,o++,l=c.next();else{let p=t(s,u);n.set(p,i.detach(s)),o--}}}for(;!l.done;)fg(i,n,t,i.length,l.value),l=c.next()}for(;s<=o;)i.destroy(i.detach(o--));n?.forEach(c=>{i.destroy(c)})}function $u(i,e,t,n){return e!==void 0&&e.has(n)?(i.attach(t,e.get(n)),e.delete(n),!0):!1}function fg(i,e,t,n,r){if($u(i,e,n,t(n,r)))i.updateValue(n,r);else{let s=i.create(n,r);i.attach(n,s)}}function pg(i,e,t,n){let r=new Set;for(let s=e;s<=t;s++)r.add(n(s,i.at(s)));return r}var qa=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let n=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(n);)n=r.get(n);r.set(n,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,n]of this.kvMap)if(e(n,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(n);)n=r.get(n),e(n,t)}}};function Ft(i,e){Mi("NgControlFlow");let t=Y(),n=Zs(),r=t[n]!==Qt?t[n]:-1,s=r!==-1?Xa(t,ut+r):void 0,o=0;if(Un(t,n,i)){let a=X(null);try{if(s!==void 0&&uv(s,o),i!==-1){let c=ut+i,l=Xa(t,c),u=Xu(t[P],c),d=Rr(l,u.tView.ssrId),h=eo(t,u,e,{dehydratedView:d});to(l,h,o,Nr(u,d))}}finally{X(a)}}else if(s!==void 0){let a=lv(s,o);a!==void 0&&(a[Ge]=e)}}var Wu=class{constructor(e,t,n){this.lContainer=e,this.$implicit=t,this.$index=n}get $count(){return this.lContainer.length-ze}};function Ur(i,e){return e}var Yu=class{constructor(e,t,n){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=n}};function Jt(i,e,t,n,r,s,o,a,c,l,u,d,h){Mi("NgControlFlow");let f=Y(),p=Ve(),g=c!==void 0,y=Y(),_=a?o.bind(y[lt][Ge]):o,b=new Yu(g,_);y[ut+i]=b,Wa(f,p,i+1,e,t,n,r,Pr(p.consts,s)),g&&Wa(f,p,i+2,c,l,u,d,Pr(p.consts,h))}var qu=class extends zu{constructor(e,t,n){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=n,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-ze}at(e){return this.getLView(e)[Ge].$implicit}attach(e,t){let n=t[Ar];this.needsIndexUpdate||=e!==this.length,to(this.lContainer,t,e,Nr(this.templateTNode,n))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,jS(this.lContainer,e)}create(e,t){let n=Rr(this.lContainer,this.templateTNode.tView.ssrId),r=eo(this.hostLView,this.templateTNode,new Wu(this.lContainer,t,e),{dehydratedView:n});return this.operationsCounter?.recordCreate(),r}destroy(e){sc(e[P],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[Ge].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ge].$index=e}getLView(e){return VS(this.lContainer,e)}};function en(i){let e=X(null),t=Hn();try{let n=Y(),r=n[P],s=n[t],o=t+1,a=Xa(n,o);if(s.liveCollection===void 0){let l=Xu(r,o);s.liveCollection=new qu(a,n,l)}else s.liveCollection.reset();let c=s.liveCollection;if(LS(c,i,s.trackByFn),c.updateIndexes(),s.hasEmptyBlock){let l=Zs(),u=c.length===0;if(Un(n,l,u)){let d=t+2,h=Xa(n,d);if(u){let f=Xu(r,d),p=Rr(h,f.tView.ssrId),g=eo(n,f,void 0,{dehydratedView:p});to(h,g,0,Nr(f,p))}else uv(h,0)}}}finally{X(e)}}function Xa(i,e){return i[e]}function jS(i,e){return zs(i,e)}function VS(i,e){return lv(i,e)}function Xu(i,e){return ud(i,e)}function BS(i,e,t,n,r,s){let o=e.consts,a=Pr(o,r),c=Js(e,i,2,n,a);return tv(e,t,c,Pr(o,s)),c.attrs!==null&&Pu(c,c.attrs,!1),c.mergedAttrs!==null&&Pu(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function w(i,e,t,n){let r=Y(),s=Ve(),o=ut+i,a=r[Ne],c=s.firstCreatePass?BS(o,s,r,e,t,n):s.data[o],l=HS(s,r,c,a,e,i);r[o]=l;let u=ld(c);return Xs(c,!0),Wm(a,l,c),!pS(c)&&gd()&&Md(s,r,l,c),mw()===0&&xi(l,r),vw(),u&&(Qm(s,r,c),Km(s,c,r)),n!==null&&Jm(r,c),w}function x(){let i=it();sm()?om():(i=i.parent,Xs(i,!1));let e=i;_w(e)&&Cw(),yw();let t=Ve();return t.firstCreatePass&&(vd(t,i),$g(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&Rw(e)&&Gu(t,e,Y(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Fw(e)&&Gu(t,e,Y(),e.stylesWithoutHost,!1),x}function T(i,e,t,n){return w(i,e,t,n),x(),T}var HS=(i,e,t,n,r,s)=>(md(!0),Lm(n,r,Ow()));function We(){return Y()}var Za="en-US";var US=Za;function GS(i){typeof i=="string"&&(US=i.toLowerCase().replace(/_/g,"-"))}var zS=(i,e,t)=>{};function ee(i,e,t,n){let r=Y(),s=Ve(),o=it();return WS(s,r,r[Ne],o,i,e,n),ee}function $S(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[Pa],c=r[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function WS(i,e,t,n,r,s,o){let a=ld(n),l=i.firstCreatePass&&av(i),u=e[Ge],d=ov(e),h=!0;if(n.type&3||o){let g=wt(n,e),y=o?o(g):g,_=d.length,b=o?E=>o(qt(E[n.index])):n.index,S=null;if(!o&&a&&(S=$S(i,e,r,n.index)),S!==null){let E=S.__ngLastListenerFn__||S;E.__ngNextListenerFn__=s,S.__ngLastListenerFn__=s,h=!1}else{s=mg(n,e,u,s),zS(g,r,s);let E=t.listen(y,r,s);d.push(s,E),l&&l.push(r,b,_,_+1)}}else s=mg(n,e,u,s);let f=n.outputs,p;if(h&&f!==null&&(p=f[r])){let g=p.length;if(g)for(let y=0;y<g;y+=2){let _=p[y],b=p[y+1],A=e[_][b].subscribe(s),O=d.length;d.push(s,A),l&&l.push(r,n.index,O,-(O+1))}}}function gg(i,e,t,n){let r=X(null);try{return Gt(6,e,t),t(n)!==!1}catch(s){return cv(i,s),!1}finally{Gt(7,e,t),X(r)}}function mg(i,e,t,n){return function r(s){if(s===Function)return n;let o=i.componentOffset>-1?Bn(i.index,e):e;Nd(o,5);let a=gg(e,t,n,s),c=r.__ngNextListenerFn__;for(;c;)a=gg(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function ie(i=1){return Mw(i)}function YS(i,e){let t=null,n=L1(i);for(let r=0;r<e.length;r++){let s=e[r];if(s==="*"){t=r;continue}if(n===null?Pg(i,s,!0):B1(n,s))return r}return t}function wn(i){let e=Y()[lt][nt];if(!e.projection){let t=i?i.length:1,n=e.projection=I1(t,null),r=n.slice(),s=e.child;for(;s!==null;){if(s.type!==128){let o=i?YS(s,i):0;o!==null&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s)}s=s.next}}}function bn(i,e=0,t,n,r,s){let o=Y(),a=Ve(),c=n?i+1:null;c!==null&&Wa(o,a,c,n,r,s,null,t);let l=Js(a,ut+i,16,null,t||null);l.projection===null&&(l.projection=e),om();let d=!o[Ar]||im();o[lt][nt].projection[l.projection]===null&&c!==null?qS(o,a,c):d&&(l.flags&32)!==32&&Ib(a,o,l)}function qS(i,e,t){let n=ut+t,r=e.data[n],s=i[n],o=Rr(s,r.tView.ssrId),a=eo(i,r,void 0,{dehydratedView:o});to(s,a,0,Nr(r,o))}function Lv(i,e,t,n){eS(i,e,t,n)}function Hd(i,e,t){JD(i,e,t)}function io(i){let e=Y(),t=Ve(),n=lm();hd(n+1);let r=Bd(t,n);if(i.dirty&&hw(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let s=iS(e,n);i.reset(s,Zw),i.notifyOnChanges()}return!0}return!1}function ro(){return QD(Y(),lm())}function Lt(i,e=""){let t=Y(),n=Ve(),r=i+ut,s=n.firstCreatePass?Js(n,r,1,e,null):n.data[r],o=XS(n,t,s,e,i);t[r]=o,gd()&&Md(n,t,o,s),Xs(s,!1)}var XS=(i,e,t,n,r)=>(md(!0),fb(e[Ne],n));function Ud(i){return Gr("",i,""),Ud}function Gr(i,e,t){let n=Y(),r=Tv(n,i,e,t);return r!==Qt&&iD(n,Hn(),r),Gr}function ZS(i,e,t){let n=Ve();if(n.firstCreatePass){let r=Ln(i);Zu(t,n.data,n.blueprint,r,!0),Zu(e,n.data,n.blueprint,r,!1)}}function Zu(i,e,t,n,r){if(i=je(i),Array.isArray(i))for(let s=0;s<i.length;s++)Zu(i[s],e,t,n,r);else{let s=Ve(),o=Y(),a=it(),c=Mr(i)?i:je(i.provide),l=Hg(i),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Mr(i)||!i.multi){let f=new Di(l,r,D),p=nu(c,e,r?u:u+h,d);p===-1?(yu(ja(a,o),s,c),tu(s,i,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{let f=nu(c,e,u+h,d),p=nu(c,e,u,u+h),g=f>=0&&t[f],y=p>=0&&t[p];if(r&&!y||!r&&!g){yu(ja(a,o),s,c);let _=JS(r?QS:KS,t.length,r,n,l);!r&&y&&(t[p].providerFactory=_),tu(s,i,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(_),o.push(_)}else{let _=jv(t[r?p:f],l,!r&&n);tu(s,i,f>-1?f:p,_)}!r&&n&&y&&t[p].componentProviders++}}}function tu(i,e,t,n){let r=Mr(e),s=Q1(e);if(r||s){let c=(s?je(e.useClass):e).prototype.ngOnDestroy;if(c){let l=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let u=l.indexOf(t);u===-1?l.push(t,[n,c]):l[u+1].push(n,c)}else l.push(t,c)}}}function jv(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function nu(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function KS(i,e,t,n){return Ku(this.multi,[])}function QS(i,e,t,n){let r=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Si(t,t[P],this.providerFactory.index,n);s=a.slice(0,o),Ku(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],Ku(r,s);return s}function Ku(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function JS(i,e,t,n,r){let s=new Di(i,t,D);return s.multi=[],s.index=e,s.componentProviders=0,jv(s,r,n&&!t),s}function ht(i,e=[]){return t=>{t.providersResolver=(n,r)=>ZS(n,r?r(i):i,e)}}var ex=(()=>{let e=class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=jg(!1,n.type),s=r.length>0?hS([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(N(Wt))});let i=e;return i})();function te(i){Mi("NgStandalone"),i.getStandaloneInjector=e=>e.get(ex).getOrCreateStandaloneInjector(i)}function lc(i,e,t,n){return nx(Y(),bw(),i,e,t,n)}function tx(i,e){let t=i[e];return t===Qt?void 0:t}function nx(i,e,t,n,r,s){let o=e+t;return Un(i,o,r)?fS(i,o+1,s?n.call(s,r):n(r)):tx(i,o+1)}var Vv=new L("");function so(i){return!!i&&typeof i.then=="function"}function Bv(i){return!!i&&typeof i.subscribe=="function"}var ix=new L(""),Hv=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=B(ix,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let n=[];for(let s of this.appInits){let o=s();if(so(o))n.push(o);else if(Bv(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),n.length===0&&r(),this.initialized=!0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),rx=new L("");function sx(){np(()=>{throw new G(600,!1)})}function ox(i){return i.isBoundToModule}var ax=10;function cx(i,e,t){try{let n=t();return so(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}var Gn=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=B(Im),this.afterRenderEffectManager=B(Vd),this.zonelessEnabled=B(Fd),this.externalTestViews=new Set,this.beforeRender=new $,this.afterTick=new $,this.componentTypes=[],this.components=[],this.isStable=B(rc).hasPendingTasks.pipe(ct(n=>!n)),this._injector=B(Wt)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){let s=n instanceof Ua;if(!this._injector.get(Hv).done){let f=!s&&W1(n),p=!1;throw new G(405,p)}let a;s?a=n:a=this._injector.get(jn).resolveComponentFactory(n),this.componentTypes.push(a.componentType);let c=ox(a)?void 0:this._injector.get(Lr),l=r||a.selector,u=a.create(dt.NULL,[],l,c),d=u.location.nativeElement,h=u.injector.get(Vv,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),iu(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new G(101,!1);let r=X(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(s){this.internalErrorHandler(s)}finally{this._runningTick=!1,X(r),this.afterTick.next()}}detectChangesInAttachedViews(n){let r=null;this._injector.destroyed||(r=this._injector.get(Fr,null,{optional:!0}));let s=0,o=this.afterRenderEffectManager;for(;s<ax;){let a=s===0;if(n||!a){this.beforeRender.next(a);for(let{_lView:c,notifyErrorHandler:l}of this._views)lx(c,l,a,this.zonelessEnabled)}else r?.begin?.(),r?.end?.();if(s++,o.executeInternalCallbacks(),!this.allViews.some(({_lView:c})=>Gs(c))&&(o.execute(),!this.allViews.some(({_lView:c})=>Gs(c))))break}}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;iu(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);let r=this._injector.get(rx,[]);[...this._bootstrapListeners,...r].forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>iu(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new G(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function iu(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function lx(i,e,t,n){if(!t&&!Gs(i))return;fv(i,e,t&&!n?0:1)}var ux=(()=>{let e=class e{constructor(){this.zone=B(oe),this.changeDetectionScheduler=B(Ii),this.applicationRef=B(Gn)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function dx({ngZoneFactory:i,ignoreChangesOutsideZone:e}){return i??=()=>new oe(fx()),[{provide:oe,useFactory:i},{provide:js,multi:!0,useFactory:()=>{let t=B(ux,{optional:!0});return()=>t.initialize()}},{provide:js,multi:!0,useFactory:()=>{let t=B(px);return()=>{t.initialize()}}},{provide:Im,useFactory:hx},e===!0?{provide:vv,useValue:!0}:[]]}function hx(){let i=B(oe),e=B(Xt);return t=>i.runOutsideAngular(()=>e.handleError(t))}function fx(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var px=(()=>{let e=class e{constructor(){this.subscription=new fe,this.initialized=!1,this.zone=B(oe),this.pendingTasks=B(rc)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{oe.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{oe.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Uv=(()=>{let e=class e{constructor(){this.appRef=B(Gn),this.taskService=B(rc),this.ngZone=B(oe),this.zonelessEnabled=B(Fd),this.disableScheduling=B(vv,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new fe,this.cancelScheduledCallback=null,this.shouldRefreshViews=!1,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ga||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&n===5)return;switch(n){case 3:case 2:case 0:case 4:case 5:case 1:{this.shouldRefreshViews=!0;break}case 8:case 7:case 6:case 9:default:}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?rg:yv;this.pendingRenderTaskId=this.taskService.add(),this.zoneIsDefined?Zone.root.run(()=>{this.cancelScheduledCallback=r(()=>{this.tick(this.shouldRefreshViews)})}):this.cancelScheduledCallback=r(()=>{this.tick(this.shouldRefreshViews)})}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&oe.isInAngularZone())}tick(n){if(this.runningTick||this.appRef.destroyed)return;let r=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick(n)},void 0,this.schedulerTickApplyArgs)}catch(s){throw this.taskService.remove(r),s}finally{this.cleanup()}this.useMicrotaskScheduler=!0,rg(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(r)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.shouldRefreshViews=!1,this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function Gv(){return Mi("NgZoneless"),Lg([{provide:Ii,useExisting:Uv},{provide:oe,useClass:Ga},{provide:Fd,useValue:!0},[]])}function gx(){return typeof $localize<"u"&&$localize.locale||Za}var Gd=new L("",{providedIn:"root",factory:()=>B(Gd,W.Optional|W.SkipSelf)||gx()});var zv=new L("");var Ta=null;function mx(i=[],e){return dt.create({name:e,providers:[{provide:Ja,useValue:"platform"},{provide:zv,useValue:new Set([()=>Ta=null])},...i]})}function vx(i=[]){if(Ta)return Ta;let e=mx(i);return Ta=e,sx(),yx(e),e}function yx(i){i.get(bd,null)?.forEach(t=>t())}var zn=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=_x;let i=e;return i})();function _x(i){return Cx(it(),Y(),(i&16)===16)}function Cx(i,e,t){if(nc(i)&&!t){let n=Bn(i.index,e);return new Ei(n,n)}else if(i.type&175){let n=e[lt];return new Ei(n,e)}return null}var Qu=class{constructor(){}supports(e){return e instanceof Map||Iv(e)}create(){return new Ju}},Ju=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||Iv(e)))throw new G(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{let s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;n!==null;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let r=this._records.get(e);this._maybeAddToChanges(r,t);let s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}let n=new ed(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}},ed=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function vg(){return new zd([new Qu])}var zd=(()=>{let e=class e{constructor(n){this.factories=n}static create(n,r){if(r){let s=r.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||vg()),deps:[[e,new S1,new Ig]]}}find(n){let r=this.factories.find(s=>s.supports(n));if(r)return r;throw new G(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:vg});let i=e;return i})();function $v(i){try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=vx(n),s=[dx({}),{provide:Ii,useExisting:Uv},...t||[]],a=new $a({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,c=a.get(oe);return c.run(()=>{a.resolveInjectorInitializers();let l=a.get(Xt,null),u;c.runOutsideAngular(()=>{u=c.onError.subscribe({next:f=>{l.handleError(f)}})});let d=()=>a.destroy(),h=r.get(zv);return h.add(d),a.onDestroy(()=>{u.unsubscribe(),h.delete(d)}),cx(l,c,()=>{let f=a.get(Hv);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(Gd,Za);GS(p||Za);let g=a.get(Gn);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}function oo(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function Wv(i,e){let t=yi(i),n=e.elementInjector||ec();return new $s(t).create(n,e.projectableNodes,e.hostElement,e.environmentInjector)}var uc={schedule(i,e){let t=setTimeout(i,e);return()=>clearTimeout(t)},scheduleBeforeRender(i){if(typeof window>"u")return uc.schedule(i,0);if(typeof window.requestAnimationFrame>"u")return uc.schedule(i,16);let e=window.requestAnimationFrame(i);return()=>window.cancelAnimationFrame(e)}};function wx(i){return i.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function bx(i){return!!i&&i.nodeType===Node.ELEMENT_NODE}function Dx(i){return typeof i=="function"}var Wd;function Sx(i,e){if(!Wd){let t=Element.prototype;Wd=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return i.nodeType===Node.ELEMENT_NODE?Wd.call(i,e):!1}function xx(i,e){return i===e||i!==i&&e!==e}function Ex(i){let e={};return i.forEach(({propName:t,templateName:n,transform:r})=>{e[wx(n)]=[t,r]}),e}function Ix(i,e){return e.get(jn).resolveComponentFactory(i).inputs}function Tx(i,e){let t=i.childNodes,n=e.map(()=>[]),r=-1;e.some((s,o)=>s==="*"?(r=o,!0):!1);for(let s=0,o=t.length;s<o;++s){let a=t[s],c=Mx(a,e,r);c!==-1&&n[c].push(a)}return n}function Mx(i,e,t){let n=t;return bx(i)&&e.some((r,s)=>r!=="*"&&Sx(i,r)?(n=s,!0):!1),n}var Ax=10,Yd=class{constructor(e,t){this.componentFactory=t.get(jn).resolveComponentFactory(e)}create(e){return new qd(this.componentFactory,e)}},qd=class{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new Os(1),this.events=this.eventEmitters.pipe(Cr(n=>_r(...n))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:n})=>n)),this.ngZone=this.injector.get(oe),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(this.scheduledDestroyFn!==null){this.scheduledDestroyFn(),this.scheduledDestroyFn=null;return}this.componentRef===null&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=uc.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},Ax))})}getInputValue(e){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t,n){this.runInZone(()=>{if(n&&(t=n.call(this.componentRef?.instance,t)),this.componentRef===null){this.initialInputValues.set(e,t);return}xx(t,this.getInputValue(e))&&!(t===void 0&&this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges())})}initializeComponent(e){let t=dt.create({providers:[],parent:this.injector}),n=Tx(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,n,e),this.viewChangeDetectorRef=this.componentRef.injector.get(zn),this.implementsOnChanges=Dx(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(Gn).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e,transform:t})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e),t)}),this.initialInputValues.clear()}initializeOutputs(e){let t=this.componentFactory.outputs.map(({propName:n,templateName:r})=>e.instance[n].pipe(ct(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||this.inputChanges===null)return;let t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=uc.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;this.inputChanges===null&&(this.inputChanges={});let n=this.inputChanges[e];if(n){n.currentValue=t;return}let r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Us(s,t,r)}detectChanges(){this.componentRef!==null&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}},Xd=class extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}};function Yv(i,e){let t=Ix(i,e.injector),n=e.strategyFactory||new Yd(i,e.injector),r=Ex(t),o=class o extends Xd{get ngElementStrategy(){if(!this._ngElementStrategy){let c=this._ngElementStrategy=n.create(this.injector||e.injector);t.forEach(({propName:l,transform:u})=>{if(!this.hasOwnProperty(l))return;let d=this[l];delete this[l],c.setInputValue(l,d,u)})}return this._ngElementStrategy}constructor(c){super(),this.injector=c}attributeChangedCallback(c,l,u,d){let[h,f]=r[c];this.ngElementStrategy.setInputValue(h,u,f)}connectedCallback(){let c=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),c=!0),this.ngElementStrategy.connect(this),c||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(c=>{let l=new CustomEvent(c.name,{detail:c.value});this.dispatchEvent(l)})}};o.observedAttributes=Object.keys(r);let s=o;return t.forEach(({propName:a,transform:c})=>{Object.defineProperty(s.prototype,a,{get(){return this.ngElementStrategy.getInputValue(a)},set(l){this.ngElementStrategy.setInputValue(a,l,c)},configurable:!0,enumerable:!0})}),s}var Xv=null;function zr(){return Xv}function Zv(i){Xv??=i}var dc=class{};var Ye=new L("");function Kv(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Kd=/\s+/,qv=[],fc=(()=>{let e=class e{constructor(n,r){this._ngEl=n,this._renderer=r,this.initialClasses=qv,this.stateMap=new Map}set klass(n){this.initialClasses=n!=null?n.trim().split(Kd):qv}set ngClass(n){this.rawClass=typeof n=="string"?n.trim().split(Kd):n}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(let r of n)this._updateState(r,!0);else if(n!=null)for(let r of Object.keys(n))this._updateState(r,!!n[r]);this._applyStateDiff()}_updateState(n,r){let s=this.stateMap.get(n);s!==void 0?(s.enabled!==r&&(s.changed=!0,s.enabled=r),s.touched=!0):this.stateMap.set(n,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let n of this.stateMap){let r=n[0],s=n[1];s.changed?(this._toggleClass(r,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),s.touched=!1}}_toggleClass(n,r){n=n.trim(),n.length>0&&n.split(Kd).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(r){return new(r||e)(D(ye),D(bt))},e.\u0275dir=ve({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0});let i=e;return i})();var Qv=(()=>{let e=class e{constructor(n,r,s){this._ngEl=n,this._differs=r,this._renderer=s,this._ngStyle=null,this._differ=null}set ngStyle(n){this._ngStyle=n,!this._differ&&n&&(this._differ=this._differs.find(n).create())}ngDoCheck(){if(this._differ){let n=this._differ.diff(this._ngStyle);n&&this._applyChanges(n)}}_setStyle(n,r){let[s,o]=n.split("."),a=s.indexOf("-")===-1?void 0:Zt.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,s,o?`${r}${o}`:r,a):this._renderer.removeStyle(this._ngEl.nativeElement,s,a)}_applyChanges(n){n.forEachRemovedItem(r=>this._setStyle(r.key,null)),n.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),n.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}};e.\u0275fac=function(r){return new(r||e)(D(ye),D(zd),D(bt))},e.\u0275dir=ve({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0});let i=e;return i})();var Qd="browser",kx="server";function Jv(i){return i===Qd}function Jd(i){return i===kx}var hc=class{};var nh=class extends dc{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ih=class i extends nh{static makeCurrent(){Zv(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Nx();return t==null?null:Rx(t)}resetBaseElement(){ao=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Kv(document.cookie,e)}},ao=null;function Nx(){return ao=ao||document.querySelector("base"),ao?ao.getAttribute("href"):null}function Rx(i){return new URL(i,document.baseURI).pathname}var Fx=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})(),rh=new L(""),i0=(()=>{let e=class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s){return this._findPluginFor(r).addEventListener(n,r,s)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(o=>o.supports(n)),!r)throw new G(5101,!1);return this._eventNameToPlugin.set(n,r),r}};e.\u0275fac=function(r){return new(r||e)(N(rh),N(oe))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})(),pc=class{constructor(e){this._doc=e}},eh="ng-app-id",r0=(()=>{let e=class e{constructor(n,r,s,o={}){this.doc=n,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Jd(o),this.resetHostNodes()}addStyles(n){for(let r of n)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(n){for(let r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){let r=this.styleRef;r.get(n)?.elements?.forEach(s=>s.remove()),r.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${eh}="${this.appId}"]`);if(n?.length){let r=new Map;return n.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(n,r){let s=this.styleRef;if(s.has(n)){let o=s.get(n);return o.usage+=r,o.usage}return s.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===n)return s.delete(r),o.removeAttribute(eh),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(eh,this.appId),n.appendChild(a),a}}addStyleToHost(n,r){let s=this.getStyleElement(n,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(N(Ye),N(wd),N(Dd,8),N(Cn))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})(),th={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},oh=/%COMP%/g,s0="%COMP%",Lx=`_nghost-${s0}`,jx=`_ngcontent-${s0}`,Vx=!0,Bx=new L("",{providedIn:"root",factory:()=>Vx});function Hx(i){return jx.replace(oh,i)}function Ux(i){return Lx.replace(oh,i)}function o0(i,e){return e.map(t=>t.replace(oh,i))}var e0=(()=>{let e=class e{constructor(n,r,s,o,a,c,l,u=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Jd(c),this.defaultRenderer=new co(n,a,l,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===$t.ShadowDom&&(r=ke(ne({},r),{encapsulation:$t.Emulated}));let s=this.getOrCreateRenderer(n,r);return s instanceof gc?s.applyToHost(n):s instanceof lo&&s.applyStyles(),s}getOrCreateRenderer(n,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case $t.Emulated:o=new gc(l,u,r,this.appId,d,a,c,h);break;case $t.ShadowDom:return new sh(l,u,n,r,a,c,this.nonce,h);default:o=new lo(l,u,r,d,a,c,h);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(N(i0),N(r0),N(wd),N(Bx),N(Ye),N(Cn),N(oe),N(Dd))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})(),co=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(th[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(t0(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(t0(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new G(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=th[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=th[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Zt.DashCase|Zt.Important)?e.style.setProperty(t,n,r&Zt.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Zt.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=zr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function t0(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var sh=class extends co{constructor(e,t,n,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=o0(r.id,r.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},lo=class extends co{constructor(e,t,n,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?o0(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},gc=class extends lo{constructor(e,t,n,r,s,o,a,c){let l=r+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=Hx(l),this.hostAttr=Ux(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},Gx=(()=>{let e=class e extends pc{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s){return n.addEventListener(r,s,!1),()=>this.removeEventListener(n,r,s)}removeEventListener(n,r,s){return n.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(N(Ye))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})(),n0=["alt","control","meta","shift"],zx={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$x={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},Wx=(()=>{let e=class e extends pc{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>zr().onAndCancel(n,o.domEventName,a))}static parseEventName(n){let r=n.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),n0.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),a+=u+".")}),a+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,r){let s=zx[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(s=n.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),n0.forEach(a=>{if(a!==s){let c=$x[a];c(n)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(n,r,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>r(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(r){return new(r||e)(N(Ye))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})();function a0(i){return $v(Yx(i))}function Yx(i){return{appProviders:[...Qx,...i?.providers??[]],platformProviders:Kx}}function qx(){ih.makeCurrent()}function Xx(){return new Xt}function Zx(){return Pm(document),document}var Kx=[{provide:Cn,useValue:Qd},{provide:bd,useValue:qx,multi:!0},{provide:Ye,useFactory:Zx,deps:[]}];var Qx=[{provide:Ja,useValue:"root"},{provide:Xt,useFactory:Xx,deps:[]},{provide:rh,useClass:Gx,multi:!0,deps:[Ye,oe,Cn]},{provide:rh,useClass:Wx,multi:!0,deps:[Ye]},e0,r0,i0,{provide:Fr,useExisting:e0},{provide:hc,useClass:Fx,deps:[]},[]];function c0(i,e=0){return Jx(i)?Number(i):e}function Jx(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function rt(i){return i instanceof ye?i.nativeElement:i}var ch;try{ch=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ch=!1}var l0=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?Jv(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||ch)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(N(Cn))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var uo;function eE(){if(uo==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>uo=!0}))}finally{uo=uo||!1}return uo}function ho(i){return eE()?i:!!i.capture}var ah;function tE(){if(ah==null){let i=typeof document<"u"?document.head:null;ah=!!(i&&(i.createShadowRoot||i.attachShadow))}return ah}function lh(i){if(tE()){let e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function fo(i){return i.composedPath?i.composedPath()[0]:i.target}var iE=new L("cdk-dir-doc",{providedIn:"root",factory:rE});function rE(){return B(Ye)}var sE=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function oE(i){let e=i?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?sE.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var u0=(()=>{let e=class e{constructor(n){if(this.value="ltr",this.change=new se,n){let r=n.body?n.body.dir:null,s=n.documentElement?n.documentElement.dir:null;this.value=oE(r||s||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(r){return new(r||e)(N(iE,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var cE=20,d0=(()=>{let e=class e{constructor(n,r,s){this._platform=n,this._change=new $,this._changeListener=o=>{this._change.next(o)},this._document=s,r.runOutsideAngular(()=>{if(n.isBrowser){let o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){let n=this.getViewportScrollPosition(),{width:r,height:s}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+s,right:n.left+r,height:s,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let n=this._document,r=this._getWindow(),s=n.documentElement,o=s.getBoundingClientRect(),a=-o.top||n.body.scrollTop||r.scrollY||s.scrollTop||0,c=-o.left||n.body.scrollLeft||r.scrollX||s.scrollLeft||0;return{top:a,left:c}}change(n=cE){return n>0?this._change.pipe(Bl(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(r){return new(r||e)(N(l0),N(oe),N(Ye,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function h0(i){return i.buttons===0||i.detail===0}function f0(i){let e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}function T0(i){let e=i.cloneNode(!0),t=e.querySelectorAll("[id]"),n=i.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return n==="canvas"?m0(i,e):(n==="input"||n==="select"||n==="textarea")&&g0(i,e),p0("canvas",i,e,m0),p0("input, textarea, select",i,e,g0),e}function p0(i,e,t,n){let r=e.querySelectorAll(i);if(r.length){let s=t.querySelectorAll(i);for(let o=0;o<r.length;o++)n(r[o],s[o])}}var uE=0;function g0(i,e){e.type!=="file"&&(e.value=i.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${uE++}`)}function m0(i,e){let t=e.getContext("2d");if(t)try{t.drawImage(i,0,0)}catch{}}function vh(i){let e=i.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function dh(i,e,t){let{top:n,bottom:r,left:s,right:o}=i;return t>=n&&t<=r&&e>=s&&e<=o}function go(i,e,t){i.top+=e,i.bottom=i.top+i.height,i.left+=t,i.right=i.left+i.width}function v0(i,e,t,n){let{top:r,right:s,bottom:o,left:a,width:c,height:l}=i,u=c*e,d=l*e;return n>r-d&&n<o+d&&t>a-u&&t<s+u}var _c=class{constructor(e){this._document=e,this.positions=new Map}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:vh(t)})})}handleScroll(e){let t=fo(e),n=this.positions.get(t);if(!n)return null;let r=n.scrollPosition,s,o;if(t===this._document){let l=this.getViewportScrollPosition();s=l.top,o=l.left}else s=t.scrollTop,o=t.scrollLeft;let a=r.top-s,c=r.left-o;return this.positions.forEach((l,u)=>{l.clientRect&&t!==u&&t.contains(u)&&go(l.clientRect,a,c)}),r.top=s,r.left=o,{top:a,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function M0(i,e){let t=i.rootNodes;if(t.length===1&&t[0].nodeType===e.ELEMENT_NODE)return t[0];let n=e.createElement("div");return t.forEach(r=>n.appendChild(r)),n}function yh(i,e,t){for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];r?i.setProperty(n,r,t?.has(n)?"important":""):i.removeProperty(n)}return i}function $r(i,e){let t=e?"":"none";yh(i.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function y0(i,e,t){yh(i.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function Cc(i,e){return e&&e!="none"?i+" "+e:i}function _0(i,e){i.style.width=`${e.width}px`,i.style.height=`${e.height}px`,i.style.transform=wc(e.left,e.top)}function wc(i,e){return`translate3d(${Math.round(i)}px, ${Math.round(e)}px, 0)`}function C0(i){let e=i.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(i)*e}function dE(i){let e=getComputedStyle(i),t=uh(e,"transition-property"),n=t.find(a=>a==="transform"||a==="all");if(!n)return 0;let r=t.indexOf(n),s=uh(e,"transition-duration"),o=uh(e,"transition-delay");return C0(s[r])+C0(o[r])}function uh(i,e){return i.getPropertyValue(e).split(",").map(n=>n.trim())}var hE=new Set(["position"]),hh=class{constructor(e,t,n,r,s,o,a,c,l){this._document=e,this._rootElement=t,this._direction=n,this._initialDomRect=r,this._previewTemplate=s,this._previewClass=o,this._pickupPositionOnPage=a,this._initialTransform=c,this._zIndex=l}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),"showPopover"in this._preview&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return dE(this._preview)}addEventListener(e,t){this._preview.addEventListener(e,t)}removeEventListener(e,t){this._preview.removeEventListener(e,t)}_createPreview(){let e=this._previewTemplate,t=this._previewClass,n=e?e.template:null,r;if(n&&e){let s=e.matchSize?this._initialDomRect:null,o=e.viewContainer.createEmbeddedView(n,e.context);o.detectChanges(),r=M0(o,this._document),this._previewEmbeddedView=o,e.matchSize?_0(r,s):r.style.transform=wc(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=T0(this._rootElement),_0(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return yh(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},hE),$r(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}},w0=ho({passive:!0}),mc=ho({passive:!1}),b0=ho({passive:!1,capture:!0}),fE=800,D0=new Set(["position"]),fh=class{get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>$r(t,e)))}constructor(e,t,n,r,s,o){this._config=t,this._document=n,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=Dt(!1),this._moveEvents=new $,this._pointerMoveSubscription=fe.EMPTY,this._pointerUpSubscription=fe.EMPTY,this._scrollSubscription=fe.EMPTY,this._resizeSubscription=fe.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new $,this.started=new $,this.released=new $,this.ended=new $,this.entered=new $,this.exited=new $,this.dropped=new $,this.moved=this._moveEvents,this._pointerDown=a=>{if(this.beforeStarted.next(),this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&this._initializeDragSequence(c,a)}else this.disabled||this._initializeDragSequence(this._rootElement,a)},this._pointerMove=a=>{let c=this._getPointerPositionOnPage(a);if(!this._hasStartedDragging()){let u=Math.abs(c.x-this._pickupPositionOnPage.x),d=Math.abs(c.y-this._pickupPositionOnPage.y);if(u+d>=this._config.dragStartThreshold){let f=Date.now()>=this._dragStartTime+this._getDragStartDelay(a),p=this._dropContainer;if(!f){this._endDragSequence(a);return}(!p||!p.isDragging()&&!p.isReceiving())&&(a.cancelable&&a.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(a)))}return}a.cancelable&&a.preventDefault();let l=this._getConstrainedPointerPosition(c);if(this._hasMoved=!0,this._lastKnownPointerPosition=c,this._updatePointerDirectionDelta(l),this._dropContainer)this._updateActiveDropContainer(l,c);else{let u=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,d=this._activeTransform;d.x=l.x-u.x+this._passiveTransform.x,d.y=l.y-u.y+this._passiveTransform.y,this._applyRootElementTransform(d.x,d.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:l,event:a,distance:this._getDragDistance(l),delta:this._pointerDirectionDelta})})},this._pointerUp=a=>{this._endDragSequence(a)},this._nativeDragStart=a=>{if(this._handles.length){let c=this._getTargetHandle(a);c&&!this._disabledHandles.has(c)&&!this.disabled&&a.preventDefault()}else this.disabled||a.preventDefault()},this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new _c(n),o.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(n=>rt(n)),this._handles.forEach(n=>$r(n,this.disabled)),this._toggleNativeDragInteractions();let t=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&t.add(n)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let t=rt(e);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,mc),t.addEventListener("touchstart",this._pointerDown,w0),t.addEventListener("dragstart",this._nativeDragStart,mc)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?rt(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),$r(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),$r(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",x0,b0)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){po(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let t=this._getShadowRoot(),n=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",x0,b0)}),n){let r=this._rootElement,s=r.parentNode,o=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");s.insertBefore(a,r),this._initialTransform=r.style.transform||"",this._preview=new hh(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(s,t)),y0(r,!1,D0),this._document.body.appendChild(s.replaceChild(o,r)),this.started.next({source:this,event:e}),n.start(),this._initialContainer=n,this._initialIndex=n.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(n?n.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();let n=this.isDragging(),r=po(t),s=!r&&t.button!==0,o=this._rootElement,a=fo(t),c=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+fE>Date.now(),l=r?f0(t):h0(t);if(a&&a.draggable&&t.type==="mousedown"&&t.preventDefault(),n||s||c||l)return;if(this._handles.length){let h=o.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=vh(this._boundaryElement));let u=this._previewTemplate;this._pickupPositionInElement=u&&u.template&&!u.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);let d=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:d.x,y:d.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){y0(this._rootElement,!0,D0),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let t=this._dropContainer,n=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),s=this._getDragDistance(r),o=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s,dropPoint:r,event:e}),t.drop(this,n,this._initialIndex,this._initialContainer,o,s,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:n,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,e,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let t=this._preview.getTransitionDuration();return t===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{let r=o=>{(!o||fo(o)===this._preview&&o.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",r),n(),clearTimeout(s))},s=setTimeout(r,t*1.5);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,t=e?e.template:null,n;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),n=M0(this._placeholderRef,this._document)):n=T0(this._rootElement),n.style.pointerEvents="none",n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(e,t,n){let r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():e,o=po(n)?n.targetTouches[0]:n,a=this._getViewportScrollPosition(),c=o.pageX-s.left-a.left,l=o.pageY-s.top-a.top;return{x:s.left-e.left+c,y:s.top-e.top+l}}_getPointerPositionOnPage(e){let t=this._getViewportScrollPosition(),n=po(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=n.pageX-t.left,s=n.pageY-t.top;if(this._ownerSVGElement){let o=this._ownerSVGElement.getScreenCTM();if(o){let a=this._ownerSVGElement.createSVGPoint();return a.x=r,a.y=s,a.matrixTransform(o.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(e){let t=this._dropContainer?this._dropContainer.lockAxis:null,{x:n,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||t==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||t==="y")&&(n=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:o}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:c,height:l}=this._getPreviewRect(),u=a.top+o,d=a.bottom-(l-o),h=a.left+s,f=a.right-(c-s);n=S0(n,h,f),r=S0(r,u,d)}return{x:n,y:r}}_updatePointerDirectionDelta(e){let{x:t,y:n}=e,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(t-s.x),a=Math.abs(n-s.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),a>this._config.pointerDirectionChangeThreshold&&(r.y=n>s.y?1:-1,s.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,$r(this._rootElement,e))}_removeRootElementListeners(e){e.removeEventListener("mousedown",this._pointerDown,mc),e.removeEventListener("touchstart",this._pointerDown,w0),e.removeEventListener("dragstart",this._nativeDragStart,mc)}_applyRootElementTransform(e,t){let n=wc(e,t),r=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=r.transform&&r.transform!="none"?r.transform:""),r.transform=Cc(n,this._initialTransform)}_applyPreviewTransform(e,t){let n=this._previewTemplate?.template?void 0:this._initialTransform,r=wc(e,t);this._preview.setTransform(Cc(r,n))}_getDragDistance(e){let t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(e===0&&t===0||this.isDragging()||!this._boundaryElement)return;let n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||n.width===0&&n.height===0)return;let s=r.left-n.left,o=n.right-r.right,a=r.top-n.top,c=n.bottom-r.bottom;r.width>n.width?(s>0&&(e+=s),o>0&&(e-=o)):e=0,r.height>n.height?(a>0&&(t+=a),c>0&&(t-=c)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){let t=this.dragStartDelay;return typeof t=="number"?t:po(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){let t=this._parentPositions.handleScroll(e);if(t){let n=fo(e);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&go(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=lh(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){let n=this._previewContainer||"global";if(n==="parent")return e;if(n==="global"){let r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return rt(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}};function S0(i,e,t){return Math.max(e,Math.min(t,i))}function po(i){return i.type[0]==="t"}function x0(i){i.preventDefault()}function pE(i,e,t){let n=E0(e,i.length-1),r=E0(t,i.length-1);if(n===r)return;let s=i[n],o=r<n?-1:1;for(let a=n;a!==r;a+=o)i[a]=i[a+o];i[r]=s}function E0(i,e){return Math.max(0,Math.min(e,i))}var ph=class{constructor(e,t){this._element=e,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(e){this.withItems(e)}sort(e,t,n,r){let s=this._itemPositions,o=this._getItemIndexFromPointerPosition(e,t,n,r);if(o===-1&&s.length>0)return null;let a=this.orientation==="horizontal",c=s.findIndex(y=>y.drag===e),l=s[o],u=s[c].clientRect,d=l.clientRect,h=c>o?1:-1,f=this._getItemOffsetPx(u,d,h),p=this._getSiblingOffsetPx(c,s,h),g=s.slice();return pE(s,c,o),s.forEach((y,_)=>{if(g[_]===y)return;let b=y.drag===e,S=b?f:p,E=b?e.getPlaceholderElement():y.drag.getRootElement();y.offset+=S,a?(E.style.transform=Cc(`translate3d(${Math.round(y.offset)}px, 0, 0)`,y.initialTransform),go(y.clientRect,0,S)):(E.style.transform=Cc(`translate3d(0, ${Math.round(y.offset)}px, 0)`,y.initialTransform),go(y.clientRect,S,0))}),this._previousSwap.overlaps=dh(d,t,n),this._previousSwap.drag=l.drag,this._previousSwap.delta=a?r.x:r.y,{previousIndex:c,currentIndex:o}}enter(e,t,n,r){let s=r==null||r<0?this._getItemIndexFromPointerPosition(e,t,n):r,o=this._activeDraggables,a=o.indexOf(e),c=e.getPlaceholderElement(),l=o[s];if(l===e&&(l=o[s+1]),!l&&(s==null||s===-1||s<o.length-1)&&this._shouldEnterAsFirstChild(t,n)&&(l=o[0]),a>-1&&o.splice(a,1),l&&!this._dragDropRegistry.isDragging(l)){let u=l.getRootElement();u.parentElement.insertBefore(c,u),o.splice(s,0,e)}else rt(this._element).appendChild(c),o.push(e);c.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables.forEach(e=>{let t=e.getRootElement();if(t){let n=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(n=>n.drag===e)}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:n})=>{go(n,e,t)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(t=>{let n=t.getVisibleElement();return{drag:t,offset:0,initialTransform:n.style.transform||"",clientRect:vh(n)}}).sort((t,n)=>e?t.clientRect.left-n.clientRect.left:t.clientRect.top-n.clientRect.top)}_getItemOffsetPx(e,t,n){let r=this.orientation==="horizontal",s=r?t.left-e.left:t.top-e.top;return n===-1&&(s+=r?t.width-e.width:t.height-e.height),s}_getSiblingOffsetPx(e,t,n){let r=this.orientation==="horizontal",s=t[e].clientRect,o=t[e+n*-1],a=s[r?"width":"height"]*n;if(o){let c=r?"left":"top",l=r?"right":"bottom";n===-1?a-=o.clientRect[c]-s[l]:a+=s[c]-o.clientRect[l]}return a}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;let n=this._itemPositions,r=this.orientation==="horizontal";if(n[0].drag!==this._activeDraggables[0]){let o=n[n.length-1].clientRect;return r?e>=o.right:t>=o.bottom}else{let o=n[0].clientRect;return r?e<=o.left:t<=o.top}}_getItemIndexFromPointerPosition(e,t,n,r){let s=this.orientation==="horizontal",o=this._itemPositions.findIndex(({drag:a,clientRect:c})=>{if(a===e)return!1;if(r){let l=s?r.x:r.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&l===this._previousSwap.delta)return!1}return s?t>=Math.floor(c.left)&&t<Math.floor(c.right):n>=Math.floor(c.top)&&n<Math.floor(c.bottom)});return o===-1||!this._sortPredicate(o,e)?-1:o}},I0=.05,A0=.05,St=function(i){return i[i.NONE=0]="NONE",i[i.UP=1]="UP",i[i.DOWN=2]="DOWN",i}(St||{}),Ke=function(i){return i[i.NONE=0]="NONE",i[i.LEFT=1]="LEFT",i[i.RIGHT=2]="RIGHT",i}(Ke||{}),gh=class{constructor(e,t,n,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new $,this.entered=new $,this.exited=new $,this.dropped=new $,this.sorted=new $,this.receivingStarted=new $,this.receivingStopped=new $,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=fe.EMPTY,this._verticalScrollDirection=St.NONE,this._horizontalScrollDirection=Ke.NONE,this._stopScrollTimers=new $,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),Vl(0,na).pipe(Rs(this._stopScrollTimers)).subscribe(()=>{let o=this._scrollNode,a=this.autoScrollStep;this._verticalScrollDirection===St.UP?o.scrollBy(0,-a):this._verticalScrollDirection===St.DOWN&&o.scrollBy(0,a),this._horizontalScrollDirection===Ke.LEFT?o.scrollBy(-a,0):this._horizontalScrollDirection===Ke.RIGHT&&o.scrollBy(a,0)})},this.element=rt(e),this._document=n,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new _c(n),this._sortStrategy=new ph(this.element,t),this._sortStrategy.withSortPredicate((o,a)=>this.sortPredicate(o,a,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,n,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,n,r,s,o,a,c={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:s,distance:o,dropPoint:a,event:c})}withItems(e){let t=this._draggables;return this._draggables=e,e.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>e.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._sortStrategy.direction=e,this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){return this._sortStrategy.orientation=e,this}withScrollableParents(e){let t=rt(this.element);return this._scrollableElements=e.indexOf(t)===-1?[t,...e]:e.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,n,r){if(this.sortingDisabled||!this._domRect||!v0(this._domRect,I0,t,n))return;let s=this._sortStrategy.sort(e,t,n,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let n,r=St.NONE,s=Ke.NONE;if(this._parentPositions.positions.forEach((o,a)=>{a===this._document||!o.clientRect||n||v0(o.clientRect,I0,e,t)&&([r,s]=gE(a,o.clientRect,this._sortStrategy.direction,e,t),(r||s)&&(n=a))}),!r&&!s){let{width:o,height:a}=this._viewportRuler.getViewportSize(),c={width:o,height:a,top:0,right:o,bottom:a,left:0};r=O0(c,t),s=k0(c,e),n=window}n&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=n,(r||s)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=rt(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){let e=rt(this.element);this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(e).clientRect}_reset(){this._isDragging=!1;let e=rt(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(e,t){return this._domRect!=null&&dh(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,n){return this._siblings.find(r=>r._canReceive(e,t,n))}_canReceive(e,t,n){if(!this._domRect||!dh(this._domRect,t,n)||!this.enterPredicate(e,this))return!1;let r=this._getShadowRoot().elementFromPoint(t,n);if(!r)return!1;let s=rt(this.element);return r===s||s.contains(r)}_startReceiving(e,t){let n=this._activeSiblings;!n.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=lh(rt(this.element));this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}};function O0(i,e){let{top:t,bottom:n,height:r}=i,s=r*A0;return e>=t-s&&e<=t+s?St.UP:e>=n-s&&e<=n+s?St.DOWN:St.NONE}function k0(i,e){let{left:t,right:n,width:r}=i,s=r*A0;return e>=t-s&&e<=t+s?Ke.LEFT:e>=n-s&&e<=n+s?Ke.RIGHT:Ke.NONE}function gE(i,e,t,n,r){let s=O0(e,r),o=k0(e,n),a=St.NONE,c=Ke.NONE;if(s){let l=i.scrollTop;s===St.UP?l>0&&(a=St.UP):i.scrollHeight-l>i.clientHeight&&(a=St.DOWN)}if(o){let l=i.scrollLeft;t==="rtl"?o===Ke.RIGHT?l<0&&(c=Ke.RIGHT):i.scrollWidth+l>i.clientWidth&&(c=Ke.LEFT):o===Ke.LEFT?l>0&&(c=Ke.LEFT):i.scrollWidth-l>i.clientWidth&&(c=Ke.RIGHT)}return[a,c]}var vc=ho({passive:!1,capture:!0}),yc=new Set,mE=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],standalone:!0,features:[te],decls:0,vars:0,template:function(r,s){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit}}"],encapsulation:2,changeDetection:0});let i=e;return i})(),vE=(()=>{let e=class e{constructor(n,r){this._ngZone=n,this._appRef=B(Gn),this._environmentInjector=B(Wt),this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=Dt([]),this._globalListeners=new Map,this._draggingPredicate=s=>s.isDragging(),this.pointerMove=new $,this.pointerUp=new $,this.scroll=new $,this._preventDefaultWhileDragging=s=>{this._activeDragInstances().length>0&&s.preventDefault()},this._persistentTouchmoveListener=s=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&s.preventDefault(),this.pointerMove.next(s))},this._document=r}registerDropContainer(n){this._dropInstances.has(n)||this._dropInstances.add(n)}registerDragItem(n){this._dragInstances.add(n),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,vc)})}removeDropContainer(n){this._dropInstances.delete(n)}removeDragItem(n){this._dragInstances.delete(n),this.stopDragging(n),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,vc)}startDragging(n,r){if(!(this._activeDragInstances().indexOf(n)>-1)&&(this._loadResets(),this._activeDragInstances.update(s=>[...s,n]),this._activeDragInstances().length===1)){let s=r.type.startsWith("touch");this._globalListeners.set(s?"touchend":"mouseup",{handler:o=>this.pointerUp.next(o),options:!0}).set("scroll",{handler:o=>this.scroll.next(o),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:vc}),s||this._globalListeners.set("mousemove",{handler:o=>this.pointerMove.next(o),options:vc}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((o,a)=>{this._document.addEventListener(a,o.handler,o.options)})})}}stopDragging(n){this._activeDragInstances.update(r=>{let s=r.indexOf(n);return s>-1?(r.splice(s,1),[...r]):r}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(n){return this._activeDragInstances().indexOf(n)>-1}scrolled(n){let r=[this.scroll];return n&&n!==this._document&&r.push(new de(s=>this._ngZone.runOutsideAngular(()=>{let a=c=>{this._activeDragInstances().length&&s.next(c)};return n.addEventListener("scroll",a,!0),()=>{n.removeEventListener("scroll",a,!0)}}))),_r(...r)}ngOnDestroy(){this._dragInstances.forEach(n=>this.removeDragItem(n)),this._dropInstances.forEach(n=>this.removeDropContainer(n)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((n,r)=>{this._document.removeEventListener(r,n.handler,n.options)}),this._globalListeners.clear()}_loadResets(){if(!yc.has(this._appRef)){yc.add(this._appRef);let n=Wv(mE,{environmentInjector:this._environmentInjector});this._appRef.onDestroy(()=>{yc.delete(this._appRef),yc.size===0&&n.destroy()})}}};e.\u0275fac=function(r){return new(r||e)(N(oe),N(Ye))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),yE={dragStartThreshold:5,pointerDirectionChangeThreshold:5},_E=(()=>{let e=class e{constructor(n,r,s,o){this._document=n,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=o}createDrag(n,r=yE){return new fh(n,r,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(n){return new gh(n,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}};e.\u0275fac=function(r){return new(r||e)(N(Ye),N(oe),N(d0),N(vE))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),mh=new L("CDK_DRAG_PARENT");var P0=new L("CdkDragHandle"),N0=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._stateChanges.next(this)}constructor(n,r){this.element=n,this._parentDrag=r,this._stateChanges=new $,this._disabled=!1,r?._addHandle(this)}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}};e.\u0275fac=function(r){return new(r||e)(D(ye),D(mh,12))},e.\u0275dir=ve({type:e,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",oo]},standalone:!0,features:[ht([{provide:P0,useExisting:e}]),no]});let i=e;return i})(),CE=new L("CDK_DRAG_CONFIG"),wE="cdk-drag",bE=new L("CdkDropList"),R0=(()=>{let e=class e{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(n){this._disabled=n,this._dragRef.disabled=this._disabled}constructor(n,r,s,o,a,c,l,u,d,h,f){this.element=n,this.dropContainer=r,this._ngZone=o,this._viewContainerRef=a,this._dir=l,this._changeDetectorRef=d,this._selfHandle=h,this._parentDrag=f,this._destroyed=new $,this._handles=new fi([]),this.started=new se,this.released=new se,this.ended=new se,this.entered=new se,this.exited=new se,this.dropped=new se,this.moved=new de(p=>{let g=this._dragRef.moved.pipe(ct(y=>({source:this,pointerPosition:y.pointerPosition,event:y.event,delta:y.delta,distance:y.distance}))).subscribe(p);return()=>{g.unsubscribe()}}),this._injector=B(dt),this._dragRef=u.createDrag(n,{dragStartThreshold:c&&c.dragStartThreshold!=null?c.dragStartThreshold:5,pointerDirectionChangeThreshold:c&&c.pointerDirectionChangeThreshold!=null?c.pointerDirectionChangeThreshold:5,zIndex:c?.zIndex}),this._dragRef.data=this,e._dragInstances.push(this),c&&this._assignDefaults(c),r&&(this._dragRef._withDropContainer(r._dropListRef),r.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(n){this._dragRef.setFreeDragPosition(n)}ngAfterViewInit(){jd(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(n){let r=n.rootElementSelector,s=n.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),s&&!s.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let n=e._dragInstances.indexOf(this);n>-1&&e._dragInstances.splice(n,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(n){let r=this._handles.getValue();r.push(n),this._handles.next(r)}_removeHandle(n){let r=this._handles.getValue(),s=r.indexOf(n);s>-1&&(r.splice(s,1),this._handles.next(r))}_setPreviewTemplate(n){this._previewTemplate=n}_resetPreviewTemplate(n){n===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(n){this._placeholderTemplate=n}_resetPlaceholderTemplate(n){n===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let n=this.element.nativeElement,r=n;this.rootElementSelector&&(r=n.closest!==void 0?n.closest(this.rootElementSelector):n.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||n)}_getBoundaryElement(){let n=this.boundaryElement;return n?typeof n=="string"?this.element.nativeElement.closest(n):rt(n):null}_syncInputs(n){n.beforeStarted.subscribe(()=>{if(!n.isDragging()){let r=this._dir,s=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;n.disabled=this.disabled,n.lockAxis=this.lockAxis,n.dragStartDelay=typeof s=="object"&&s?s:c0(s),n.constrainPosition=this.constrainPosition,n.previewClass=this.previewClass,n.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),r&&n.withDirection(r.value)}}),n.beforeStarted.pipe(Hl(1)).subscribe(()=>{if(this._parentDrag){n.withParent(this._parentDrag._dragRef);return}let r=this.element.nativeElement.parentElement;for(;r;){if(r.classList.contains(wE)){n.withParent(e._dragInstances.find(s=>s.element.nativeElement===r)?._dragRef||null);break}r=r.parentElement}})}_handleEvents(n){n.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),n.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),n.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),n.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),n.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),n.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(n){let{lockAxis:r,dragStartDelay:s,constrainPosition:o,previewClass:a,boundaryElement:c,draggingDisabled:l,rootElementSelector:u,previewContainer:d}=n;this.disabled=l??!1,this.dragStartDelay=s||0,r&&(this.lockAxis=r),o&&(this.constrainPosition=o),a&&(this.previewClass=a),c&&(this.boundaryElement=c),u&&(this.rootElementSelector=u),d&&(this.previewContainer=d)}_setupHandlesListener(){this._handles.pipe(Ul(n=>{let r=n.map(s=>s.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),Cr(n=>_r(...n.map(r=>r._stateChanges.pipe(_a(r))))),Rs(this._destroyed)).subscribe(n=>{let r=this._dragRef,s=n.element.nativeElement;n.disabled?r.disableHandle(s):r.enableHandle(s)})}};e._dragInstances=[],e.\u0275fac=function(r){return new(r||e)(D(ye),D(bE,12),D(Ye),D(oe),D(Nt),D(CE,8),D(u0,8),D(_E),D(zn),D(P0,10),D(mh,12))},e.\u0275dir=ve({type:e,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,s){r&2&&Oi("cdk-drag-disabled",s.disabled)("cdk-drag-dragging",s._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",oo],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[ht([{provide:mh,useExisting:e}]),no,Kt]});let i=e;return i})();var F0=(()=>{let e=class e{constructor(n){this.element=n,this.appIntersectionListener=new se}ngOnInit(){this.intersectionObserver()}ngAfterViewInit(){this.observer.observe(this.element.nativeElement)}intersectionObserver(){let n={root:null,rootMargin:"0px",threshold:.5};this.observer=new IntersectionObserver(r=>{r[0].isIntersecting&&this.appIntersectionListener.emit(this.targetItem)},n)}};e.\u0275fac=function(r){return new(r||e)(D(ye))},e.\u0275dir=ve({type:e,selectors:[["","appIntersectionListener",""]],inputs:{targetItem:"targetItem"},outputs:{appIntersectionListener:"appIntersectionListener"},standalone:!0});let i=e;return i})();var SE="Pixobe Designer",Wr=(()=>{let e=class e{constructor(){this.valid=Dt(null)}async validate(n,r,s=""){let o=new Date;if(new Date(s)<=o){this.valid.set(!1);return}let l=`${window.location.hostname}${SE}${r}${s}`,u=new TextEncoder().encode(l),d=await crypto.subtle.digest("SHA-256",u),f=Array.from(new Uint8Array(d)).map(p=>p.toString(16).padStart(2,"0")).join("");this.valid.set(f===n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var $n=(()=>{let e=class e{constructor(n,r,s){this.templateRef=n,this.viewRef=r,this.validatorService=s}ngOnInit(){this.validatorService.valid()?this.viewRef.createEmbeddedView(this.templateRef):this.viewRef.clear()}};e.\u0275fac=function(r){return new(r||e)(D(gn),D(Nt),D(Wr))},e.\u0275dir=ve({type:e,selectors:[["","validatePlan",""]],standalone:!0});let i=e;return i})();var K=function(i){return i.ADD_TEXT="ADD_TEXT",i.ADD_IMAGE="ADD_IMAGE",i.FLIP_HORIZONTAL="flipX",i.FLIP_VERTICAL="flipY",i.SEND_BACKWARDS="SEND_BACKWARDS",i.BRING_FORWARD="BRING_FORWARD",i.LOCK_OBJECT="LOCK_OBJECT",i.OPEN_GALLERY="OPEN_GALLERY",i.OPEN_TEXT_SETTINGS="OPEN_TEXT_SETTINGSt",i.OPEN_MEDIA_SETTINGS="OPEN_MEDIA_SETTINGS",i.CLOSE_MODAL="CLOSE_MODAL",i.NO_ACTION="NO_ACTION",i.LOAD_IMG_FROM_FILE="LOAD_IMG_FROM_FILE",i.APPLY_FILTER="APPLY_FILTER",i.CREATE_MASK="CREATE_MASK",i.DELETE_SELECTED="DELETE_SELECTED",i.OBJ_SELECTED="OBJ_SELECTED",i.OBJ_DESELECTED="OBJ_DESELECTED",i}(K||{}),Me=(()=>{let e=class e{constructor(){this.waiting=Dt(!1),this.activeSelection=Dt(!1),this.activeObjectLocked=Dt(!1),this.event=Dt(null)}emit(n){this.event.set(n)}wait(n=!0){this.waiting.set(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})();var xE=["*"],Yr=(()=>{let e=class e{constructor(n,r,s){this.el=n,this.eventService=r,this.renderer=s,this.position=Dt("left")}ngAfterViewInit(){this.el.nativeElement.getBoundingClientRect().right>window.innerWidth&&this.renderer.addClass(this.el.nativeElement,"right-0")}close(){this.eventService.emit({event:K.CLOSE_MODAL,props:{}})}};e.\u0275fac=function(r){return new(r||e)(D(ye),D(Me),D(bt))},e.\u0275cmp=J({type:e,selectors:[["app-card"]],standalone:!0,features:[xv([R0]),te],ngContentSelectors:xE,decls:7,vars:0,consts:[[1,"p-card"],[1,"header","absolute","right-0","top-0"],[1,"btn-icon",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor"],["fill-rule","evenodd","d","M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z","clip-rule","evenodd"],[1,"content"]],template:function(r,s){r&1&&(wn(),w(0,"div",0)(1,"div",1)(2,"button",2),ee("click",function(){return s.close()}),ae(),w(3,"svg",3),T(4,"path",4),x()()(),Ze(),w(5,"div",5),bn(6),x()())},styles:["[_nghost-%COMP%]{position:absolute;top:50px;left:100%;background-color:var(--card-background);border:1px solid var(--border-color);min-width:180px;max-width:450px;box-shadow:0 0 8px 4px #00000014}[_nghost-%COMP%]   .p-card[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   .p-card[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:4px}[_nghost-%COMP%]   .p-card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{max-height:400px}"]});let i=e;return i})();var EE=["*"],IE=i=>({height:i}),qr=(()=>{let e=class e{constructor(){this.cols=1,this.panelHeight="auto"}get gridTemplateCols(){return`repeat(${this.cols},1fr)`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-panel"]],inputs:{cols:"cols",panelHeight:"panelHeight"},standalone:!0,features:[te],ngContentSelectors:EE,decls:2,vars:6,consts:[[3,"ngStyle"]],template:function(r,s){r&1&&(wn(),w(0,"div",0),bn(1),x()),r&2&&(Fv("grid grid-",s.cols," gap-1 border-b overflow-y p-1"),H("ngStyle",lc(4,IE,s.panelHeight)))},dependencies:[Qv]});let i=e;return i})();var TE=["*"];function ME(i,e){i&1&&bn(0)}var Wn=(()=>{let e=class e{constructor(){this.active=!1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-tab"]],inputs:{title:"title",active:"active"},standalone:!0,features:[te],ngContentSelectors:TE,decls:1,vars:1,template:function(r,s){r&1&&(wn(),Re(0,ME,1,0)),r&2&&Ft(s.active?0:-1)}});let i=e;return i})();var AE=["*"],OE=(i,e)=>e.title,kE=i=>({active:i});function PE(i,e){if(i&1){let t=We();w(0,"h2",4),ee("click",function(){let r=Be(t).$implicit,s=ie();return He(s.selectTab(r))}),Lt(1),x()}if(i&2){let t=e.$implicit,n=ie();H("ngClass",lc(2,kE,t===n.activeTab)),F(),Gr(" ",t.title," ")}}var Xr=(()=>{let e=class e{ngAfterContentInit(){this.tabs.length>0&&(this.activeTab=this.tabs.get(0),this.selectTab(this.tabs.get(0)))}selectTab(n){this.activeTab.active=!1,n.active=!0,this.activeTab=n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-tabs"]],contentQueries:function(r,s,o){if(r&1&&Lv(o,Wn,4),r&2){let a;io(a=ro())&&(s.tabs=a)}},standalone:!0,features:[te],ngContentSelectors:AE,decls:6,vars:0,consts:[[1,"tabs"],["cdkDragHandle","",1,"flex","gap-1","tab-header"],[3,"ngClass"],[1,"tab-content"],[3,"click","ngClass"]],template:function(r,s){r&1&&(wn(),w(0,"div",0)(1,"div",1),Jt(2,PE,2,4,"h2",2,OE),x(),w(4,"div",3),bn(5),x()()),r&2&&(F(2),en(s.tabs.toArray()))},dependencies:[N0,fc],styles:[".tabs[_ngcontent-%COMP%]{font-size:14px}.tabs[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{padding:.25rem;margin:0;padding:0;display:inline-block;font-size:.9rem;font-weight:400;color:#999;font-family:Arial,Helvetica,sans-serif}.tabs[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:hover{color:#11182b;cursor:default}.tabs[_ngcontent-%COMP%]   h2.active[_ngcontent-%COMP%]{color:#11182b;font-weight:700}.tabs[_ngcontent-%COMP%]   .tab-header[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #e9e9e9;cursor:move}"]});let i=e;return i})();var NE=(i,e)=>e.src;function RE(i,e){if(i&1){let t=We();w(0,"img",11),ee("appIntersectionListener",function(r){Be(t);let s=ie(3);return He(s.more(r))}),x()}if(i&2){let t=ie(),n=t.$implicit,r=t.$index;H("src",n.src,Qs)("targetItem",r)}}function FE(i,e){if(i&1&&T(0,"img",10),i&2){let t=ie().$implicit;H("src",t.src,Qs)}}function LE(i,e){if(i&1){let t=We();w(0,"button",8),ee("click",function(){let r=Be(t).$implicit,s=ie(2);return He(s.mediaSelected(r.src))}),Re(1,RE,1,2,"img",9)(2,FE,1,1,"img",10),x()}if(i&2){let t=e.$index;F(),Ft(t%4===0?1:2)}}function jE(i,e){if(i&1&&(w(0,"app-panel",6),Jt(1,LE,3,1,"button",7,NE),x()),i&2){let t=ie();H("cols",2),F(),en(t.items)}}var Ch=4,wh=(()=>{let e=class e{constructor(n){this.eventService=n,this.mediaItems=[],this.ActionEventType=K,this.items=[],this.lock=!1}ngOnInit(){this.items=this.mediaItems.slice(0,2*Ch)}more(n){if(this.items.length<=n+Ch){let r=this.items.length,s=r+Ch,o=this.mediaItems.slice(r,s);this.items.push(...o)}}mediaUploadHandler(n){let r=new FileReader;r.onload=s=>{var o=new Image;o.src=s.target?.result,o.onload=()=>{this.eventService.emit({event:K.LOAD_IMG_FROM_FILE,props:{img:o}})}},r.readAsDataURL(n.target.files[0])}mediaSelected(n){this.eventService.emit({event:K.ADD_IMAGE,props:{img:n}})}};e.\u0275fac=function(r){return new(r||e)(D(Me))},e.\u0275cmp=J({type:e,selectors:[["app-media-gallery"]],inputs:{mediaItems:"mediaItems"},standalone:!0,features:[te],decls:9,vars:0,consts:[["title","Gallery"],["for","file-upload",1,"lbl-file"],["type","file","id","file-upload",3,"input"],["viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"icon"],["fill","currentColor","d","M19,13a1,1,0,0,0-1,1v.38L16.52,12.9a2.79,2.79,0,0,0-3.93,0l-.7.7L9.41,11.12a2.85,2.85,0,0,0-3.93,0L4,12.6V7A1,1,0,0,1,5,6h7a1,1,0,0,0,0-2H5A3,3,0,0,0,2,7V19a3,3,0,0,0,3,3H17a3,3,0,0,0,3-3V14A1,1,0,0,0,19,13ZM5,20a1,1,0,0,1-1-1V15.43l2.9-2.9a.79.79,0,0,1,1.09,0l3.17,3.17,0,0L15.46,20Zm13-1a.89.89,0,0,1-.18.53L13.31,15l.7-.7a.77.77,0,0,1,1.1,0L18,17.21ZM22.71,4.29l-3-3a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21l-3,3a1,1,0,0,0,1.42,1.42L18,4.41V10a1,1,0,0,0,2,0V4.41l1.29,1.3a1,1,0,0,0,1.42,0A1,1,0,0,0,22.71,4.29Z"],["class","p-gallery","panelHeight","200px",3,"cols",4,"validatePlan"],["panelHeight","200px",1,"p-gallery",3,"cols"],[1,"p-media"],[1,"p-media",3,"click"],[3,"src","targetItem"],[3,"src"],[3,"appIntersectionListener","src","targetItem"]],template:function(r,s){r&1&&(w(0,"app-card")(1,"app-tabs")(2,"app-tab",0)(3,"app-panel")(4,"label",1)(5,"input",2),ee("input",function(a){return s.mediaUploadHandler(a)}),x(),ae(),w(6,"svg",3),T(7,"path",4),x()()(),Re(8,jE,3,1,"app-panel",5),x()()())},dependencies:[Yr,F0,Xr,Wn,$n,qr],styles:[".p-gallery[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.p-gallery[_ngcontent-%COMP%]   .p-media[_ngcontent-%COMP%]{height:100px;width:100px}.p-gallery[_ngcontent-%COMP%]   .p-media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}"]});let i=e;return i})();var re=function(i){return i.Polaroid="Polaroid",i.Sepia="Sepia",i.Kodachrome="Kodachrome",i.Contrast="Contrast",i.Brightness="Brightness",i.Greyscale="Greyscale",i.Brownie="Brownie",i.Vintage="Vintage",i.Technicolor="Technicolor",i.Pixelate="Pixelate",i.Invert="Invert",i.Blur="Blur",i.Sharpen="Sharpen",i.Emboss="Emboss",i.RemoveColor="RemoveColor",i.BlacknWhite="BlacknWhite",i.Vibrance="Vibrance",i.BlendColor="BlendColor",i.BlendImage="BlendImage",i.HueRotate="HueRotate",i.Resize="Resize",i.Saturation="Saturation",i.Gamma="Gamma",i}(re||{}),Yn={nonScaling:!1,color:"#1c274c",blur:1,offsetX:1,offsetY:1,affectStroke:!1},Zr={cornerStyle:"circle",cornerColor:"#1c274c",cornerStrokeColor:"#1c274c",cornerSize:10,transparentCorners:!1,borderColor:"#1c274c"},st=ne({fontSize:36,fill:"#c1c1c1",stroke:"#1c274c",strokeWidth:1,textAlign:"center",fontStyle:"normal",underline:!1,top:100,left:100,fontFamily:"Helvetica",strokeUniform:!0},Zr),bh=ne({},Zr);function VE(i,e){if(i&1){let t=We();w(0,"div",1)(1,"h2"),Lt(2),x(),w(3,"div")(4,"figure",2),ee("click",function(){let r=Be(t).$implicit,s=ie();return He(s.selectFilter(r))}),T(5,"img",3),x()()()}if(i&2){let t=e.$implicit,n=ie();F(2),Ud(t),F(3),H("src",n.src,Qs)("ngClass",t)}}var L0=(()=>{let e=class e{constructor(n){this.eventService=n,this.filters=[re.Greyscale,re.Brownie,re.Polaroid,re.Sepia]}selectFilter(n){this.eventService.emit({event:K.APPLY_FILTER,props:{filter:{type:n}}})}};e.\u0275fac=function(r){return new(r||e)(D(Me))},e.\u0275cmp=J({type:e,selectors:[["app-filters"]],inputs:{src:"src"},standalone:!0,features:[te],decls:3,vars:0,consts:[[1,"media-settings-card"],[1,"panel","flex","flex-col","gap-1"],[1,"flex-item",3,"click"],[3,"src","ngClass"]],template:function(r,s){r&1&&(w(0,"div",0),Jt(1,VE,6,3,"div",1,Ur),x()),r&2&&(F(),en(s.filters))},dependencies:[fc],styles:[".BlacknWhite[_ngcontent-%COMP%]{filter:grayscale(100%)}.Emboss[_ngcontent-%COMP%]{filter:contrast(200%) brightness(150%)}.Vintage[_ngcontent-%COMP%]{filter:sepia(60%) contrast(90%) brightness(110%) saturate(150%)}.Brownie[_ngcontent-%COMP%]{filter:sepia(100%) contrast(90%) brightness(80%) hue-rotate(-20deg)}.Pixelate[_ngcontent-%COMP%]{image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor}.Polaroid[_ngcontent-%COMP%]{filter:sepia(50%) contrast(120%) brightness(110%) saturate(150%);box-shadow:0 4px 8px #0000001a}.Kodachrome[_ngcontent-%COMP%]{filter:sepia(20%) contrast(120%) brightness(100%) saturate(140%)}.Sepia[_ngcontent-%COMP%]{filter:sepia(100%)}img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:fit}figure[_ngcontent-%COMP%]{margin:0;padding:0;position:relative}figure[_ngcontent-%COMP%]   caption[_ngcontent-%COMP%]{position:absolute;top:0;font-size:1rem;font-weight:700;padding:1rem}.flex[_ngcontent-%COMP%]{display:flex}.flex-col[_ngcontent-%COMP%]{flex-direction:column}.gap-1[_ngcontent-%COMP%]{gap:1rem}.flex-item[_ngcontent-%COMP%]{height:100px;width:100%}h2[_ngcontent-%COMP%]{margin:0;padding:0;font-size:.9rem;font-weight:700}label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:400}.panel[_ngcontent-%COMP%]{border-bottom:1px solid #e9e9e9;box-sizing:border-box;padding:.5rem 1rem}"]});let i=e;return i})();var Dh=function(i){return i.HEART="HEART",i.STAR="STAR",i.CIRCLE="CIRCLE",i.DREAMING="DREAMING",i}(Dh||{}),bc=(()=>{let e=class e{};e.HEART="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z",e.STAR="M11.2691 4.41115C11.5006 3.89177 11.6164 3.63208 11.7776 3.55211C11.9176 3.48263 12.082 3.48263 12.222 3.55211C12.3832 3.63208 12.499 3.89177 12.7305 4.41115L14.5745 8.54808C14.643 8.70162 14.6772 8.77839 14.7302 8.83718C14.777 8.8892 14.8343 8.93081 14.8982 8.95929C14.9705 8.99149 15.0541 9.00031 15.2213 9.01795L19.7256 9.49336C20.2911 9.55304 20.5738 9.58288 20.6997 9.71147C20.809 9.82316 20.8598 9.97956 20.837 10.1342C20.8108 10.3122 20.5996 10.5025 20.1772 10.8832L16.8125 13.9154C16.6877 14.0279 16.6252 14.0842 16.5857 14.1527C16.5507 14.2134 16.5288 14.2807 16.5215 14.3503C16.5132 14.429 16.5306 14.5112 16.5655 14.6757L17.5053 19.1064C17.6233 19.6627 17.6823 19.9408 17.5989 20.1002C17.5264 20.2388 17.3934 20.3354 17.2393 20.3615C17.0619 20.3915 16.8156 20.2495 16.323 19.9654L12.3995 17.7024C12.2539 17.6184 12.1811 17.5765 12.1037 17.56C12.0352 17.5455 11.9644 17.5455 11.8959 17.56C11.8185 17.5765 11.7457 17.6184 11.6001 17.7024L7.67662 19.9654C7.18404 20.2495 6.93775 20.3915 6.76034 20.3615C6.60623 20.3354 6.47319 20.2388 6.40075 20.1002C6.31736 19.9408 6.37635 19.6627 6.49434 19.1064L7.4341 14.6757C7.46898 14.5112 7.48642 14.429 7.47814 14.3503C7.47081 14.2807 7.44894 14.2134 7.41394 14.1527C7.37439 14.0842 7.31195 14.0279 7.18708 13.9154L3.82246 10.8832C3.40005 10.5025 3.18884 10.3122 3.16258 10.1342C3.13978 9.97956 3.19059 9.82316 3.29993 9.71147C3.42581 9.58288 3.70856 9.55304 4.27406 9.49336L8.77835 9.01795C8.94553 9.00031 9.02911 8.99149 9.10139 8.95929C9.16534 8.93081 9.2226 8.8892 9.26946 8.83718C9.32241 8.77839 9.35663 8.70162 9.42508 8.54808L11.2691 4.41115Z",e.CIRCLE="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",e.DREAMING="M4,18 C5.1045695,18 6,18.8954305 6,20 C6,21.1045695 5.1045695,22 4,22 C2.8954305,22 2,21.1045695 2,20 C2,18.8954305 2.8954305,18 4,18 Z M9.5,15 C10.8807119,15 12,16.1192881 12,17.5 C12,18.8807119 10.8807119,20 9.5,20 C8.11928813,20 7,18.8807119 7,17.5 C7,16.1192881 8.11928813,15 9.5,15 Z M12,2 C14.6592222,2 16.8838018,3.92259542 17.3302255,6.47059089 L17.4117647,6.47058824 C19.4909544,6.47058824 21.1764706,8.15610447 21.1764706,10.2352941 C21.1764706,12.3144838 19.4909544,14 17.4117647,14 L6.58823529,14 C4.50904565,14 2.82352941,12.3144838 2.82352941,10.2352941 C2.82352941,8.15610447 4.50904565,6.47058824 6.58825824,6.47058824 L6.66977451,6.47059089 C7.11619821,3.92259542 9.34077777,2 12,2 Z";let i=e;return i})(),j0=()=>{let e=`data:image/svg+xml;utf8,${encodeURIComponent(`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xml:space="preserve" fill="currentColor"><path d="M293.686 333.324c5.976 52.529 58.497 59.684 74.014 59.684 15.521 0 68.042-7.155 74.01-59.684-9.545 8.358-40.582 22.691-74.01 22.691-33.424-.001-64.461-14.334-74.014-22.691zM312.681 272.069c12.31 1.33 23.671 5.338 33.591 11.37.394-17.695-12.824-33.041-30.747-34.969-17.827-1.92-33.926 10.126-37.423 27.344 10.792-3.625 22.52-5.036 34.579-3.745zM389.129 283.439c9.919-6.032 21.285-10.039 33.587-11.37 12.067-1.291 23.786.12 34.579 3.745-3.498-17.218-19.596-29.264-37.42-27.344-17.927 1.928-31.145 17.274-30.746 34.969z"/><path d="M511.724 171.919s-.02-.216-.036-.327l-.02-.104-.02-.144c-.948-6.86-5.975-12.389-13.05-13.106-5.765-.59-11.586 2.35-17.119 3.673-11.405 2.693-22.97 4.74-34.535 6.462-30.085 4.478-60.56 6.549-90.964 5.832-23.604-.55-47.223-2.621-70.552-6.278-8.7-36.101-23.006-95.259-27.058-112.023-.82-3.402-1.43-8.724-8.29-3.792-4.96 3.593-54.665 28.874-118.249 44.243C68.247 111.724 12.475 111.916 6.42 111c-8.346-1.275-6.466 3.744-5.641 7.146C5.133 136.16 21.294 203.039 29.7 237.777c20.496 84.87 111.994 128.117 164.213 115.489 11.242-2.717 22.918-8.573 34.125-16.939 11.282 46.108 43.136 86.902 84.714 109.784 13.413 7.378 28.077 12.979 43.311 15.027 14.935 2.023 29.942-.167 44.14-5.02 27.938-9.56 52.665-28.213 71.624-50.649 18.481-21.886 31.731-48.227 37.172-76.408 2.506-12.964 2.848-25.934 2.848-39.073V186.977c.001-4.948.415-10.135-.123-15.058zM61.156 185.351a81.262 81.262 0 0 0 34.487-4.493c11.656-4.176 21.776-10.733 29.99-18.932 4.534 17.098-4.705 35.129-21.679 41.2-16.868 6.056-35.348-1.864-42.798-17.775zm162.408 71.261c-13.808-2.852-33.539-3.991-52.84.685-28.596 6.908-52.18 25.576-58.625 34.691-5.744-46.156 37.694-63.134 50.98-66.354 10.202-2.47 40.001-5.832 60.485 12.629v18.349zm8.271-96.964a34.46 34.46 0 0 1-7.844 10.406 34.351 34.351 0 0 1-18.6 8.581c-17.875 2.327-34.324-9.489-38.108-26.794 11.07 3.554 23.046 4.764 35.328 3.171a81.237 81.237 0 0 0 32.734-11.76 34.063 34.063 0 0 1-3.51 16.396zm256.739 125.289c0 12.708.16 25.337-2.079 37.91-1.933 10.867-5.247 21.448-9.72 31.519a3.908 3.908 0 0 0-.164.358c-.015.048-.055.104-.071.175-.088.183-.164.374-.251.557-.159.374-.339.749-.518 1.14.048-.144.123-.263.179-.415-11.354 24.644-29.67 46.164-51.892 61.66-12.302 8.589-26.109 15.593-40.813 18.939-13.732 3.155-27.284 1.825-40.57-2.701-27.826-9.506-52.032-29.814-69.01-53.526-13.286-18.564-22.277-40.076-25.496-62.576a129.859 129.859 0 0 1-1.326-18.516V184.149c14.274 3.513 28.83 6.102 43.438 8.07 9.314 1.275 18.676 2.295 27.986 3.14a549.826 549.826 0 0 0 93.757.43c25.66-2.079 51.514-5.497 76.551-11.656v100.804z"/></svg>
     `)}`,t=document.createElement("img");return t.src=e,t},V0=()=>{let e=`data:image/svg+xml;utf8,${encodeURIComponent(`
   <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2Zm4.78 7.7-5.67 5.67a.75.75 0 0 1-1.06 0l-2.83-2.83a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l2.3 2.3 5.14-5.14c.29-.29.77-.29 1.06 0 .29.29.29.76 0 1.06Z" fill="#292D32"/></svg>
     `)}`,t=document.createElement("img");return t.src=e,t};function BE(i,e){if(i&1){let t=We();w(0,"button",1),ee("click",function(){let r=Be(t).$implicit,s=ie();return He(s.emit(r))}),ae(),w(1,"svg",2)(2,"g",3),T(3,"path"),x()()()}if(i&2){let t=e.$implicit,n=ie();F(3),Hr("d",n.MaskShapes[t])}}var B0=(()=>{let e=class e{constructor(n){this.eventService=n,this.MaskShapes=bc,this.masks=Object.values(Dh)}emit(n){this.eventService.emit({event:K.CREATE_MASK,props:{mask:n}})}};e.\u0275fac=function(r){return new(r||e)(D(Me))},e.\u0275cmp=J({type:e,selectors:[["app-mask"]],standalone:!0,features:[te],decls:3,vars:1,consts:[[3,"cols"],[3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill","#1c274c"]],template:function(r,s){r&1&&(w(0,"app-panel",0),Jt(1,BE,4,1,"button",null,Ur),x()),r&2&&(H("cols",2),F(),en(s.masks))},dependencies:[qr],styles:["button[_ngcontent-%COMP%]{margin:0;padding:0;outline:none;border:none;background-color:#e9e9e9}"]});let i=e;return i})();function HE(i,e){if(i&1&&(w(0,"div",1)(1,"app-card")(2,"app-tabs")(3,"app-tab",2)(4,"div",3),T(5,"app-mask"),x()(),w(6,"app-tab",4)(7,"div",3),T(8,"app-filters",5),x()()()()()),i&2){let t=ie();F(8),H("src",t.src)}}var Sh=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-media-settings"]],inputs:{src:"src"},standalone:!0,features:[te],decls:1,vars:0,consts:[["class","media-settings",4,"validatePlan"],[1,"media-settings"],["title","Mask"],[1,"media-settings-content"],["title","Filters"],[3,"src"]],template:function(r,s){r&1&&Re(0,HE,9,1,"div",0)},dependencies:[Yr,L0,Xr,Wn,B0,$n],styles:[".media-settings[_ngcontent-%COMP%]{font-size:14px}.media-settings-content[_ngcontent-%COMP%]{overflow-y:auto;max-height:360px}.media-settings[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;padding:0;font-size:.9rem;font-weight:700}.media-settings[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:400}.media-settings[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{border-bottom:1px solid #e9e9e9;box-sizing:border-box;padding:.5rem 1rem}.media-settings[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{display:flex}.media-settings[_ngcontent-%COMP%]   .flex-col[_ngcontent-%COMP%]{flex-direction:column}.media-settings[_ngcontent-%COMP%]   .gap-1[_ngcontent-%COMP%]{gap:1rem}.media-settings[_ngcontent-%COMP%]   .flex-item[_ngcontent-%COMP%]{height:100px;width:100%}"]});let i=e;return i})();var q0=(()=>{let e=class e{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(r){return new(r||e)(D(bt),D(ye))},e.\u0275dir=ve({type:e});let i=e;return i})(),Th=(()=>{let e=class e extends q0{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=_d(e)))(s||e)}})(),e.\u0275dir=ve({type:e,features:[Rt]});let i=e;return i})(),Ac=new L(""),UE={provide:Ac,useExisting:Vn(()=>Mh),multi:!0},Mh=(()=>{let e=class e extends Th{writeValue(n){this.setProperty("checked",n)}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=_d(e)))(s||e)}})(),e.\u0275dir=ve({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,s){r&1&&ee("change",function(a){return s.onChange(a.target.checked)})("blur",function(){return s.onTouched()})},features:[ht([UE]),Rt]});let i=e;return i})(),GE={provide:Ac,useExisting:Vn(()=>Xn),multi:!0};function zE(){let i=zr()?zr().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var $E=new L(""),Xn=(()=>{let e=class e extends q0{constructor(n,r,s){super(n,r),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!zE())}writeValue(n){let r=n??"";this.setProperty("value",r)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(r){return new(r||e)(D(bt),D(ye),D($E,8))},e.\u0275dir=ve({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&ee("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[ht([GE]),Rt]});let i=e;return i})();var X0=new L(""),Z0=new L("");function K0(i){return i!=null}function Q0(i){return so(i)?gi(i):i}function J0(i){let e={};return i.forEach(t=>{e=t!=null?ne(ne({},e),t):e}),Object.keys(e).length===0?null:e}function ey(i,e){return e.map(t=>t(i))}function WE(i){return!i.validate}function ty(i){return i.map(e=>WE(e)?e:t=>e.validate(t))}function YE(i){if(!i)return null;let e=i.filter(K0);return e.length==0?null:function(t){return J0(ey(t,e))}}function ny(i){return i!=null?YE(ty(i)):null}function qE(i){if(!i)return null;let e=i.filter(K0);return e.length==0?null:function(t){let n=ey(t,e).map(Q0);return jl(n).pipe(ct(J0))}}function iy(i){return i!=null?qE(ty(i)):null}function H0(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function ry(i){return i._rawValidators}function sy(i){return i._rawAsyncValidators}function xh(i){return i?Array.isArray(i)?i:[i]:[]}function Sc(i,e){return Array.isArray(i)?i.includes(e):i===e}function U0(i,e){let t=xh(e);return xh(i).forEach(r=>{Sc(t,r)||t.push(r)}),t}function G0(i,e){return xh(e).filter(t=>!Sc(i,t))}var xc=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=ny(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=iy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Jr=class extends xc{get formDirective(){return null}get path(){return null}},es=class extends xc{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ec=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},XE={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},JF=ke(ne({},XE),{"[class.ng-submitted]":"isSubmitted"}),ts=(()=>{let e=class e extends Ec{constructor(n){super(n)}};e.\u0275fac=function(r){return new(r||e)(D(es,2))},e.\u0275dir=ve({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&Oi("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Rt]});let i=e;return i})(),ns=(()=>{let e=class e extends Ec{constructor(n){super(n)}};e.\u0275fac=function(r){return new(r||e)(D(Jr,10))},e.\u0275dir=ve({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,s){r&2&&Oi("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Rt]});let i=e;return i})();var mo="VALID",Dc="INVALID",Kr="PENDING",vo="DISABLED",qn=class{},ki=class extends qn{constructor(e,t){super(),this.value=e,this.source=t}},yo=class extends qn{constructor(e,t){super(),this.pristine=e,this.source=t}},_o=class extends qn{constructor(e,t){super(),this.touched=e,this.source=t}},Qr=class extends qn{constructor(e,t){super(),this.status=e,this.source=t}},Eh=class extends qn{constructor(e){super(),this.source=e}},Ih=class extends qn{constructor(e){super(),this.source=e}};function oy(i){return(Oc(i)?i.validators:i)||null}function ZE(i){return Array.isArray(i)?ny(i):i||null}function ay(i,e){return(Oc(e)?e.asyncValidators:i)||null}function KE(i){return Array.isArray(i)?iy(i):i||null}function Oc(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function QE(i,e,t){let n=i.controls;if(!(e?Object.keys(n):n).length)throw new G(1e3,"");if(!n[t])throw new G(1001,"")}function JE(i,e,t){i._forEachChild((n,r)=>{if(t[r]===void 0)throw new G(1002,"")})}var Ic=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._events=new $,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===mo}get invalid(){return this.status===Dc}get pending(){return this.status==Kr}get disabled(){return this.status===vo}get enabled(){return this.status!==vo}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(U0(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(U0(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(G0(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(G0(e,this._rawAsyncValidators))}hasValidator(e){return Sc(this._rawValidators,e)}hasAsyncValidator(e){return Sc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ke(ne({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new _o(!0,n))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new _o(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ke(ne({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new yo(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new yo(!0,n))}markAsPending(e={}){this.status=Kr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Qr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ke(ne({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=vo,this.errors=null,this._forEachChild(r=>{r.disable(ke(ne({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ki(this.value,n)),this._events.next(new Qr(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ke(ne({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=mo,this._forEachChild(n=>{n.enable(ke(ne({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ke(ne({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===mo||this.status===Kr)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ki(this.value,t)),this._events.next(new Qr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ke(ne({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?vo:mo}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Kr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=Q0(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new Qr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new se,this.statusChanges=new se}_calculateStatus(){return this._allControlsDisabled()?vo:this.errors?Dc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Kr)?Kr:this._anyControlsHaveStatus(Dc)?Dc:mo}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new yo(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new _o(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Oc(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=ZE(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=KE(this._rawAsyncValidators)}},Co=class extends Ic{constructor(e,t,n){super(oy(t),ay(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){JE(this,!0,e),Object.keys(e).forEach(n=>{QE(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(n=>{let r=this.controls[n];r&&r.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>n._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,n,r)=>((n.enabled||this.disabled)&&(t[r]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Ah=new L("CallSetDisabledState",{providedIn:"root",factory:()=>kc}),kc="always";function eI(i,e){return[...e.path,i]}function z0(i,e,t=kc){Oh(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),nI(i,e),rI(i,e),iI(i,e),tI(i,e)}function $0(i,e,t=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),Mc(i,e),i&&(e._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function Tc(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function tI(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function Oh(i,e){let t=ry(i);e.validator!==null?i.setValidators(H0(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=sy(i);e.asyncValidator!==null?i.setAsyncValidators(H0(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();Tc(e._rawValidators,r),Tc(e._rawAsyncValidators,r)}function Mc(i,e){let t=!1;if(i!==null){if(e.validator!==null){let r=ry(i);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.validator);s.length!==r.length&&(t=!0,i.setValidators(s))}}if(e.asyncValidator!==null){let r=sy(i);if(Array.isArray(r)&&r.length>0){let s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(t=!0,i.setAsyncValidators(s))}}}let n=()=>{};return Tc(e._rawValidators,n),Tc(e._rawAsyncValidators,n),t}function nI(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&cy(i,e)})}function iI(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&cy(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function cy(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function rI(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function sI(i,e){i==null,Oh(i,e)}function oI(i,e){return Mc(i,e)}function aI(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function cI(i){return Object.getPrototypeOf(i.constructor)===Th}function lI(i,e){i._syncPendingControls(),e.forEach(t=>{let n=t.control;n.updateOn==="submit"&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function uI(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(s=>{s.constructor===Xn?t=s:cI(s)?n=s:r=s}),r||n||t||null}function dI(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function W0(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function Y0(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var ft=class extends Ic{constructor(e=null,t,n){super(oy(t),ay(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Oc(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Y0(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){W0(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){W0(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Y0(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var hI=i=>i instanceof ft;var fI={provide:Ac,useExisting:Vn(()=>kh),multi:!0};var pI=(()=>{let e=class e{constructor(){this._accessors=[]}add(n,r){this._accessors.push([n,r])}remove(n){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===n){this._accessors.splice(r,1);return}}select(n){this._accessors.forEach(r=>{this._isSameGroup(r,n)&&r[1]!==n&&r[1].fireUncheck(n.value)})}_isSameGroup(n,r){return n[0].control?n[0]._parent===r._control._parent&&n[1].name===r.name:!1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),kh=(()=>{let e=class e extends Th{constructor(n,r,s,o){super(n,r),this._registry=s,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=B(Ah,{optional:!0})??kc}ngOnInit(){this._control=this._injector.get(es),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(n){this._state=n===this.value,this.setProperty("checked",this._state)}registerOnChange(n){this._fn=n,this.onChange=()=>{n(this.value),this._registry.select(this)}}setDisabledState(n){(this.setDisabledStateFired||n||this.callSetDisabledState==="whenDisabledForLegacyCode")&&this.setProperty("disabled",n),this.setDisabledStateFired=!0}fireUncheck(n){this.writeValue(n)}_checkName(){this.name&&this.formControlName&&(this.name,this.formControlName),!this.name&&this.formControlName&&(this.name=this.formControlName)}};e.\u0275fac=function(r){return new(r||e)(D(bt),D(ye),D(pI),D(dt))},e.\u0275dir=ve({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(r,s){r&1&&ee("change",function(){return s.onChange()})("blur",function(){return s.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[ht([fI]),Rt]});let i=e;return i})();var ly=new L("");var gI={provide:Jr,useExisting:Vn(()=>Pi)},Pi=(()=>{let e=class e extends Jr{constructor(n,r,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new se,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Mc(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let r=this.form.get(n.path);return z0(r,n,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){$0(n.control||null,n,!1),dI(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,r){this.form.get(n.path).setValue(r)}onSubmit(n){return this.submitted=!0,lI(this.form,this.directives),this.ngSubmit.emit(n),this.form._events.next(new Eh(this.control)),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1,this.form._events.next(new Ih(this.form))}_updateDomValue(){this.directives.forEach(n=>{let r=n.control,s=this.form.get(n.path);r!==s&&($0(r||null,n),hI(s)&&(z0(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let r=this.form.get(n.path);sI(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let r=this.form.get(n.path);r&&oI(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Oh(this.form,this),this._oldForm&&Mc(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(r){return new(r||e)(D(X0,10),D(Z0,10),D(Ah,8))},e.\u0275dir=ve({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,s){r&1&&ee("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ht([gI]),Rt,Kt]});let i=e;return i})();var mI={provide:es,useExisting:Vn(()=>Ni)},Ni=(()=>{let e=class e extends es{set isDisabled(n){}constructor(n,r,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new se,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=uI(this,o)}ngOnChanges(n){this._added||this._setUpControl(),aI(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return eI(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(r){return new(r||e)(D(Jr,13),D(X0,10),D(Z0,10),D(Ac,10),D(ly,8))},e.\u0275dir=ve({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[ht([mI]),Rt,Kt]});let i=e;return i})();var vI=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=vn({type:e}),e.\u0275inj=mn({});let i=e;return i})();var is=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:ly,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:Ah,useValue:n.callSetDisabledState??kc}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=vn({type:e}),e.\u0275inj=mn({imports:[vI]});let i=e;return i})();async function dy(i){try{return i.url?await yI(i):await _I(i)}catch(e){return console.error(`Error loading font ${i.name}:`,e),st.fontFamily}}async function yI(i){let e=new FontFace(i.name,`url(${i.url})`);return await e.load(),document.fonts.add(e),i.name}async function _I(i){if(await uy(i.name))return i.name;try{return await document.fonts.load(`14px "${i.name}"`),await uy(i.name)?i.name:st.fontFamily}catch(e){return console.warn(`Failed to load system font ${i.name}:`,e),st.fontFamily}}async function uy(i){return await document.fonts.ready,document.fonts.check(`14px "${i}"`)}var hy=(()=>{let e=class e{get color(){return this.group.get(this.name)?.value}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-color"]],inputs:{group:"group",name:"name"},standalone:!0,features:[te],decls:2,vars:6,consts:[[1,"lbl-color",3,"htmlFor","formGroup"],["type","color",3,"formControlName","id"]],template:function(r,s){r&1&&(w(0,"label",0),T(1,"input",1),x()),r&2&&(Ai("background-color",s.color),H("htmlFor",s.name)("formGroup",s.group),F(),H("formControlName",s.name)("id",s.name))},dependencies:[is,Xn,ts,ns,Pi,Ni],changeDetection:0});let i=e;return i})();var fy=(()=>{let e=class e{get stepper(){return this.group.get(this.name)}set stepper(n){this.stepper.setValue(n)}increment(){this.stepper=this.stepper.value+1}decrement(){this.stepper=this.stepper.value-1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=J({type:e,selectors:[["app-stepper"]],inputs:{group:"group",name:"name"},standalone:!0,features:[te],decls:15,vars:2,consts:[[1,"stepper","flex",3,"formGroup"],[3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"icon"],["stroke-width","0"],["stroke-linecap","round","stroke-linejoin","round"],["d","M6 12L18 12","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","text",3,"formControlName"],["d","M4 12H20M12 4V20","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(r,s){r&1&&(w(0,"div",0)(1,"button",1),ee("click",function(){return s.decrement()}),ae(),w(2,"svg",2),T(3,"g",3)(4,"g",4),w(5,"g"),T(6,"path",5),x()()(),Ze(),w(7,"div"),T(8,"input",6),x(),w(9,"button",1),ee("click",function(){return s.increment()}),ae(),w(10,"svg",2),T(11,"g",3)(12,"g",4),w(13,"g"),T(14,"path",7),x()()()()),r&2&&(H("formGroup",s.group),F(8),H("formControlName",s.name))},dependencies:[is,Xn,ts,ns,Pi,Ni],styles:[".stepper[_ngcontent-%COMP%]{display:flex;font-size:14px;width:100%;background-color:#cecdcc;color:#11182b;border-radius:4px}.stepper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;box-sizing:border-box}.stepper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.9rem;width:.9rem;padding:.25rem}.stepper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;width:32px;height:100%;background-color:#f1f1f1;display:block;box-sizing:border-box;text-align:center}"]});let i=e;return i})();var rs=(()=>{let e=class e{constructor(){this.mediaItems=[],this.fonts=[],this.saveEnabled=!0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function m(i,e,t){return(e=$y(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function py(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function v(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?py(Object(t),!0).forEach(function(n){m(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):py(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function ge(i,e){if(i==null)return{};var t,n,r=function(o,a){if(o==null)return{};var c={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(a.indexOf(l)>=0)continue;c[l]=o[l]}return c}(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function ln(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function $y(i){var e=function(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}(i,"string");return typeof e=="symbol"?e:e+""}var Bc=class{constructor(){m(this,"browserShadowBlurConstant",1),m(this,"DPI",96),m(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),m(this,"perfLimitSizeTotal",2097152),m(this,"maxCacheSideLimit",4096),m(this,"minCacheSideLimit",256),m(this,"disableStyleCopyPaste",!1),m(this,"enableGLFiltering",!0),m(this,"textureSize",4096),m(this,"forceGLPutImageData",!1),m(this,"cachesBoundsOfCurve",!0),m(this,"fontPaths",{}),m(this,"NUM_FRACTION_DIGITS",4)}},q=new class extends Bc{constructor(i){super(),this.configure(i)}configure(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,i)}addFonts(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=v(v({},this.fontPaths),i)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(i=>{delete this.fontPaths[i]})}clearFonts(){this.fontPaths={}}restoreDefaults(i){let e=new Bc,t=i?.reduce((n,r)=>(n[r]=e[r],n),{})||e;this.configure(t)}},ti=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[i]("fabric",...t)},Tt=class extends Error{constructor(e,t){super("fabric: ".concat(e),t)}},Hc=class extends Tt{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},Yh=class{},qh=class extends Yh{testPrecision(e,t){let n="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,n),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){let t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),ti("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}},CI={},gy;var cn=()=>gy||(gy={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new qh,dispose(){},copyPasteData:CI}),bs=()=>cn().document,ul=()=>cn().window,Wy=()=>{var i;return Math.max((i=q.devicePixelRatio)!==null&&i!==void 0?i:ul().devicePixelRatio,1)},So=new class{constructor(){m(this,"charWidthsCache",{}),m(this,"boundsOfCurveCache",{})}getFontCache(i){let{fontFamily:e,fontStyle:t,fontWeight:n}=i;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});let r=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return r[s]||(r[s]={}),r[s]}clearFontCache(i){(i=(i||"").toLowerCase())?this.charWidthsCache[i]&&delete this.charWidthsCache[i]:this.charWidthsCache={}}limitDimsByArea(i){let{perfLimitSizeTotal:e}=q,t=Math.sqrt(e*i);return[Math.floor(t),Math.floor(e/t)]}},Xh="6.0.0";function er(){}var ni=Math.PI/2,Mn=2*Math.PI,Ef=Math.PI/180,Je=Object.freeze([1,0,0,1,0,0]),If=16,Zn=.4477152502,U="center",Q="left",Xe="top",Zh="bottom",Se="right",at="none",Tf=/\r?\n/,wo="json",Rh="svg",I=new class{constructor(){this[wo]=new Map,this[Rh]=new Map}getClass(i){let e=this[wo].get(i);if(!e)throw new Tt("No class registered for ".concat(i));return e}setClass(i,e){e?this[wo].set(e,i):(this[wo].set(i.type,i),this[wo].set(i.type.toLowerCase(),i))}getSVGClass(i){return this[Rh].get(i)}setSVGClass(i,e){this[Rh].set(e??i.type.toLowerCase(),i)}},Uc=new class extends Array{remove(i){let e=this.indexOf(i);e>-1&&this.splice(e,1)}cancelAll(){let i=this.splice(0);return i.forEach(e=>e.abort()),i}cancelByCanvas(i){if(!i)return[];let e=this.filter(t=>{var n;return t.target===i||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===i});return e.forEach(t=>t.abort()),e}cancelByTarget(i){if(!i)return[];let e=this.filter(t=>t.target===i);return e.forEach(t=>t.abort()),e}},Kh=class{constructor(){m(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[r,s]=n;this.on(r,s)}),()=>this.off(e);if(t){let n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){let n=[];return Object.entries(e).forEach(r=>{let[s,o]=r;n.push(this.once(s,o))}),()=>n.forEach(r=>r())}if(t){let n=this.on(e,function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];t.call(this,...s),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){let n=this.__eventListeners[e],r=n.indexOf(t);r>-1&&n.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(let n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[r,s]=n;this._removeEventListener(r,s)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;let r=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(r)for(let s=0;s<r.length;s++)r[s].call(this,t||{})}},wI=(i,e)=>Math.floor(Math.random()*(e-i+1))+i,os=(i,e)=>isNaN(i)&&typeof e=="number"?e:i,Fi=(i,e)=>{let t=i.indexOf(e);return t!==-1&&i.splice(t,1),i},Ht=i=>{if(i===0)return 1;switch(Math.abs(i)/ni){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},Ut=i=>{if(i===0)return 0;let e=i/ni,t=Math.sign(i);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(i)},C=class i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new i(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new i(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new i(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new i(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new i(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new i(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new i(this.x/e.x,this.y/e.y)}scalarDivide(e){return new i(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new i(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){let t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new i(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new i(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new i(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mf,n=Ut(e),r=Ht(e),s=this.subtract(t);return new i(s.x*r-s.y*n,s.x*n+s.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new i(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}},Mf=new C(0,0),Vc=i=>!!i&&Array.isArray(i._objects);function Yy(i){class e extends i{constructor(){super(...arguments),m(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];let o=this._objects.push(...r);return r.forEach(a=>this._onObjectAdded(a)),o}insertAt(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._objects.splice(n,0,...s),s.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){let n=this._objects,r=[];for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return o.forEach(c=>{let l=n.indexOf(c);l!==-1&&(n.splice(l,1),r.push(c),this._onObjectRemoved(c))}),r}forEachObject(n){this.getObjects().forEach((r,s,o)=>n(r,s,o))}getObjects(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return r.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...r))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,r){return!!this._objects.includes(n)||!!r&&this._objects.some(s=>s instanceof e&&s.contains(n,!0))}complexity(){return this._objects.reduce((n,r)=>n+=r.complexity?r.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Fi(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Fi(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,r){if(!n)return!1;let s=this._objects.indexOf(n);if(s!==0){let o=this.findNewLowerIndex(n,s,r);return Fi(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,r){if(!n)return!1;let s=this._objects.indexOf(n);if(s!==this._objects.length-1){let o=this.findNewUpperIndex(n,s,r);return Fi(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,r){return n!==this._objects[r]&&(Fi(this._objects,n),this._objects.splice(r,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,r,s){let o;if(s){o=r;for(let a=r-1;a>=0;--a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=r-1;return o}findNewUpperIndex(n,r,s){let o;if(s){o=r;for(let a=r+1;a<this._objects.length;++a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=r+1;return o}collectObjects(n){let{left:r,top:s,width:o,height:a}=n,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[],u=new C(r,s),d=u.add(new C(o,a));for(let h=this._objects.length-1;h>=0;h--){let f=this._objects[h];f.selectable&&f.visible&&(c&&f.intersectsWithRect(u,d)||f.isContainedWithinRect(u,d)||c&&f.containsPoint(u)||c&&f.containsPoint(d))&&l.push(f)}return l}}return e}var Gc=class extends Kh{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let t in e)this.set(t,e[t])}_setObject(e){for(let t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){let t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function xo(i){return ul().requestAnimationFrame(i)}function qy(i){return ul().cancelAnimationFrame(i)}var bI=0,ii=()=>bI++,Ee=()=>{let i=bs().createElement("canvas");if(!i||i.getContext===void 0)throw new Tt("Failed to create `canvas` element");return i},Xy=()=>bs().createElement("img"),Af=(i,e,t)=>i.toDataURL("image/".concat(e),t),be=i=>i*Ef,ri=i=>i/Ef,Zy=i=>i.every((e,t)=>e===Je[t]),qe=(i,e,t)=>new C(i).transform(e,t),gt=i=>{let e=1/(i[0]*i[3]-i[1]*i[2]),t=[e*i[3],-e*i[1],-e*i[2],e*i[0],0,0],{x:n,y:r}=new C(i[4],i[5]).transform(t,!0);return t[4]=-n,t[5]=-r,t},xe=(i,e,t)=>[i[0]*e[0]+i[2]*e[1],i[1]*e[0]+i[3]*e[1],i[0]*e[2]+i[2]*e[3],i[1]*e[2]+i[3]*e[3],t?0:i[0]*e[4]+i[2]*e[5]+i[4],t?0:i[1]*e[4]+i[3]*e[5]+i[5]],dl=(i,e)=>i.reduceRight((t,n)=>n&&t?xe(n,t,e):n||t,void 0)||Je.concat(),Ky=i=>{let[e,t]=i;return Math.atan2(t,e)},ms=i=>{let e=Ky(i),t=Math.pow(i[0],2)+Math.pow(i[1],2),n=Math.sqrt(t),r=(i[0]*i[3]-i[2]*i[1])/n,s=Math.atan2(i[0]*i[2]+i[1]*i[3],t);return{angle:ri(e),scaleX:n,scaleY:r,skewX:ri(s),skewY:0,translateX:i[4]||0,translateY:i[5]||0}},Ds=function(i){return[1,0,0,1,i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Ss(){let{angle:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=be(i),r=Ht(n),s=Ut(n);return[r,s,-s,r,e?e-(r*e-s*t):0,t?t-(s*e+r*t):0]}var hl=function(i){return[i,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,0,0]},Qy=i=>Math.tan(be(i)),Of=i=>[1,0,Qy(i),1,0,0],kf=i=>[1,Qy(i),0,1,0,0],Lo=i=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:r=!1,skewX:s=0,skewY:o=0}=i,a=hl(n?-e:e,r?-t:t);return s&&(a=xe(a,Of(s),!0)),o&&(a=xe(a,kf(o),!0)),a},Jy=i=>{let{translateX:e=0,translateY:t=0,angle:n=0}=i,r=Ds(e,t);n&&(r=xe(r,Ss({angle:n})));let s=Lo(i);return Zy(s)||(r=xe(r,s)),r},Eo=function(i){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,r){if(e&&e.aborted)return r(new Hc("loadImage"));let s=Xy(),o;e&&(o=function(c){s.src="",r(c)},e.addEventListener("abort",o,{once:!0}));let a=function(){s.onload=s.onerror=null,o&&e?.removeEventListener("abort",o),n(s)};i?(s.onload=a,s.onerror=function(){o&&e?.removeEventListener("abort",o),r(new Tt("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=i):a()})},vs=function(i){let{signal:e,reviver:t=er}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{let s=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(i.map(o=>I.getClass(o.type).fromObject(o,{signal:e}).then(a=>(t(o,a),s.push(a),a)))).then(n).catch(o=>{s.forEach(a=>{a.dispose&&a.dispose()}),r(o)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},jo=function(i){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{let r=[];e&&e.addEventListener("abort",n,{once:!0});let s=Object.values(i).map(a=>a&&(a.type?vs([a],{signal:e}).then(c=>{let[l]=c;return r.push(l),l}):a.source?I.getClass("pattern").fromObject(a,{signal:e}).then(c=>(r.push(c),c)):a)),o=Object.keys(i);Promise.all(s).then(a=>a.reduce((c,l,u)=>(c[o[u]]=l,c),{})).then(t).catch(a=>{r.forEach(c=>{c.dispose&&c.dispose()}),n(a)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},sr=function(i){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in i&&(e[t]=i[t]),e),{})},Pf=(i,e)=>Object.keys(i).reduce((t,n)=>(e(i[n],n,i)&&(t[n]=i[n]),t),{}),my={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Fh=(i,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+(e-i)*(2/3-t)*6:i),vy=(i,e,t,n)=>{i/=255,e/=255,t/=255;let r=Math.max(i,e,t),s=Math.min(i,e,t),o,a,c=(r+s)/2;if(r===s)o=a=0;else{let l=r-s;switch(a=c>.5?l/(2-r-s):l/(r+s),r){case i:o=(e-t)/l+(e<t?6:0);break;case e:o=(t-i)/l+2;break;case t:o=(i-e)/l+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*c),n]},yy=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(i)/(i.endsWith("%")?100:1)},Pc=i=>Math.min(Math.round(i),255).toString(16).toUpperCase().padStart(2,"0"),_y=i=>{let[e,t,n,r=1]=i,s=Math.round(.3*e+.59*t+.11*n);return[s,s,s,r]},et=class i{constructor(e){if(m(this,"isUnrecognised",!1),e)if(e instanceof i)this.setSource([...e._source]);else if(Array.isArray(e)){let[t,n,r,s=1]=e;this.setSource([t,n,r,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return e in my&&(e=my[e]),e==="transparent"?[255,255,255,0]:i.sourceFromHex(e)||i.sourceFromRgb(e)||i.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[e,t,n]=vy(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){let[e,t,n,r]=vy(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[e,t,n,r]=this.getSource();return"".concat(Pc(e)).concat(Pc(t)).concat(Pc(n)).concat(Pc(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(_y(this.getSource())),this}toBlackWhite(e){let[t,,,n]=_y(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,n]),this}overlayWith(e){e instanceof i||(e=new i(e));let t=this.getSource(),n=e.getSource(),[r,s,o]=t.map((a,c)=>Math.round(.5*a+.5*n[c]));return this.setSource([r,s,o,t[3]]),this}static fromRgb(e){return i.fromRgba(e)}static fromRgba(e){return new i(i.sourceFromRgb(e))}static sourceFromRgb(e){let t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){let[n,r,s]=t.slice(1,4).map(o=>{let a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[n,r,s,yy(t[4])]}}static fromHsl(e){return i.fromHsla(e)}static fromHsla(e){return new i(i.sourceFromHsl(e))}static sourceFromHsl(e){let t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;let n=(i.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,s=parseFloat(t[3])/100,o,a,c;if(r===0)o=a=c=s;else{let l=s<=.5?s*(r+1):s+r-s*r,u=2*s-l;o=Fh(u,l,n+1/3),a=Fh(u,l,n),c=Fh(u,l,n-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*c),yy(t[4])]}static fromHex(e){return new i(i.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let t=e.slice(e.indexOf("#")+1),n;n=t.length<=4?t.split("").map(c=>c+c):t.match(/.{2}/g);let[r,s,o,a=255]=n.map(c=>parseInt(c,16));return[r,s,o,a/255]}}static parseAngletoDegrees(e){let t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?ri(n):t.includes("turn")?360*n:n}},Z=(i,e)=>parseFloat(Number(i).toFixed(e)),tr=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:If,t=/\D{0,2}$/.exec(i),n=parseFloat(i),r=q.DPI;switch(t?.[0]){case"mm":return n*r/25.4;case"cm":return n*r/2.54;case"in":return n*r;case"pt":return n*r/72;case"pc":return n*r/72*12;case"em":return n*e;default:return n}},e_=i=>{let[e,t]=i.trim().split(" "),[n,r]=(s=e)&&s!==at?[s.slice(1,4),s.slice(5,8)]:s===at?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:n,alignY:r}},Oo=i=>"matrix("+i.map(e=>Z(e,q.NUM_FRACTION_DIGITS)).join(" ")+")",ko=function(i,e){let t,n,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{let s=new et(e),o=s.getAlpha();t=s.toRgb(),o!==1&&(n=o.toString())}else t="none";return r?"".concat(i,": ").concat(t,"; ").concat(n?"".concat(i,"-opacity: ").concat(n,"; "):""):"".concat(i,'="').concat(t,'" ').concat(n?"".concat(i,'-opacity="').concat(n,'" '):"")},It=i=>!!i&&i.toLive!==void 0,Cy=i=>!!i&&typeof i.toObject=="function",wy=i=>!!i&&i.offsetX!==void 0&&"source"in i,t_=i=>!!i&&typeof i._renderText=="function",as=i=>!!i&&"multiSelectionStacking"in i;function n_(i){let e=i&&Vt(i),t=0,n=0;if(!i||!e)return{left:t,top:n};let r=e.documentElement,s=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&((i=i.parentNode||i.host)===e?(t=s.scrollLeft||r.scrollLeft||0,n=s.scrollTop||r.scrollTop||0):(t+=i.scrollLeft||0,n+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:t,top:n}}var Vt=i=>i.ownerDocument||null,i_=i=>{var e;return((e=i.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null};function Io(i,e){let t=i.style;t&&(typeof e=="string"?i.style.cssText+=";"+e:Object.entries(e).forEach(n=>{let[r,s]=n;return t.setProperty(r,s)}))}var r_=function(i,e,t){let{width:n,height:r}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;i.width=n,i.height=r,s>1&&(i.setAttribute("width",(n*s).toString()),i.setAttribute("height",(r*s).toString()),e.scale(s,s))},Qh=(i,e)=>{let{width:t,height:n}=e;t&&(i.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(i.style.height=typeof n=="number"?"".concat(n,"px"):n)};function by(i){return i.onselectstart!==void 0&&(i.onselectstart=()=>!1),i.style.userSelect=at,i}var zc=class{constructor(e){m(this,"_originalCanvasStyle",void 0),m(this,"lower",void 0);let t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){let t=(n=e)&&n.getContext!==void 0?e:e&&bs().getElementById(e)||Ee();var n;if(t.hasAttribute("data-fabric"))throw new Tt("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e,{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(n)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){let{el:n,ctx:r}=this.lower;r_(n,r,e,t)}setCSSDimensions(e){Qh(this.lower.el,e)}calcOffset(){return function(e){var t;let n={left:0,top:0},r=e&&Vt(e),s={left:0,top:0},o={borderLeftWidth:Q,borderTopWidth:Xe,paddingLeft:Q,paddingTop:Xe};if(!r)return s;let a=((t=i_(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};for(let u in o)s[o[u]]+=parseInt(a[u],10)||0;let c=r.documentElement;e.getBoundingClientRect!==void 0&&(n=e.getBoundingClientRect());let l=n_(e);return{left:n.left+l.left-(c.clientLeft||0)+s.left,top:n.top+l.top-(c.clientTop||0)+s.top}}(this.lower.el)}dispose(){cn().dispose(this.lower.el),delete this.lower}},DI={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Je]},Po=class i extends Yy(Gc){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return i.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new zc(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let s=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(ti("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Wy():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){let r=v({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){let n=e,r=[...this.viewportTransform],s=qe(e,gt(r));r[0]=t,r[3]=t;let o=qe(s,r);r[4]+=n.x-o.x,r[5]+=n.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new C(0,0),e)}absolutePan(e){let t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new C(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=xo(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,t=this.height,n=gt(this.viewportTransform),r=qe({x:0,y:0},n),s=qe({x:e,y:t},n),o=r.min(s),a=r.max(s);return this.vptCoords={tl:o,tr:new C(a.x,o.y),bl:new C(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(qy(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;let n=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){let n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,r=t.length;n<r;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){let n=this["".concat(t,"Color")],r=this["".concat(t,"Image")],s=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!n&&!r)return;let a=It(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?n.toLive(e):n,o&&e.transform(...s),a){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);let c=n.gradientTransform||n.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(r){e.save();let{skipOffscreen:c}=this;this.skipOffscreen=o,o&&e.transform(...s),r.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new C(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new C(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new C(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new C(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new C(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return qe(this.getCenterPoint(),gt(this.viewportTransform))}_centerObject(e,t){e.setXY(t,U,U),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){let n=this.clipPath,r=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return v(v(v({version:Xh},sr(this,t)),{},{objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,e,t))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,n){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);let s=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!r),s}__serializeBgOverlay(e,t){let n={},r=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return It(o)?o.excludeFromExport||(n.background=o.toObject(t)):o&&(n.background=o),It(a)?a.excludeFromExport||(n.overlay=a.toObject(t)):a&&(n.overlay=a),r&&!r.excludeFromExport&&(n.backgroundImage=this._toObject(r,e,t)),s&&!s.excludeFromExport&&(n.overlayImage=this._toObject(s,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;let n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){let n=t.width||"".concat(this.width),r=t.height||"".concat(this.height),s=q.NUM_FRACTION_DIGITS,o=t.viewBox,a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){let c=this.viewportTransform;a='viewBox="'.concat(Z(-c[4]/c[0],s)," ").concat(Z(-c[5]/c[3],s)," ").concat(Z(this.width/c[0],s)," ").concat(Z(this.height/c[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',r,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Xh,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){let t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(ii()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let t=this["".concat(e,"Color")];if(It(t)){let n=this["".concat(e,"Vpt")],r=this.viewportTransform,s={isType:()=>!1,width:this.width/(n?r[0]:1),height:this.height/(n?r[3]:1)};return t.toSVG(s,{additionalTransform:n?Oo(r):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],t={},n=q.fontPaths;this._objects.forEach(function s(o){e.push(o),Vc(o)&&o._objects.forEach(s)}),e.forEach(s=>{if(!t_(s))return;let{styles:o,fontFamily:a}=s;!t[a]&&n[a]&&(t[a]=!0,o&&Object.values(o).forEach(c=>{Object.values(c).forEach(l=>{let{fontFamily:u=""}=l;!t[u]&&n[u]&&(t[u]=!0)})}))});let r=Object.keys(t).map(s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(n[s],`');
		}
`)).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){let r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(n))}_setSVGBgOverlayColor(e,t){let n=this["".concat(t,"Color")];if(n)if(It(n)){let r=n.repeat||"",s=this.width,o=this.height,a=this["".concat(t,"Vpt")]?Oo(gt(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(o/2,')" x="').concat(n.offsetX-s/2,'" y="').concat(n.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!wy(n)?s:n.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!wy(n)?o:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Tt("`json` is undefined"));let r=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:o,background:a,overlayImage:c,overlay:l,clipPath:u}=r,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([vs(s,{reviver:t,signal:n}),jo({backgroundImage:o,backgroundColor:a,overlayImage:c,overlayColor:l,clipPath:u},{signal:n})]).then(h=>{let[f,p]=h;return this.clear(),this.add(...f),this.set(r),this.set(p),this.renderOnAddRemove=d,this})}clone(e){let t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){let e=Ee();return e.width=this.width,e.height=this.height,new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:n=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return Af(this.toCanvasElement(o,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:r,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(t||this.width)*e,c=(n||this.height)*e,l=this.getZoom(),u=this.width,d=this.height,h=this.skipControlsDrawing,f=l*e,p=this.viewportTransform,g=[f,0,0,f,(p[4]-(r||0))*e,(p[5]-(s||0))*e],y=this.enableRetinaScaling,_=Ee(),b=o?this._objects.filter(S=>o(S)):this._objects;return _.width=a,_.height=c,this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=a,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(_.getContext("2d"),b),this.viewportTransform=p,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=h,_}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Uc.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{let n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};m(Po,"ownDefaults",DI);var SI=["touchstart","touchmove","touchend"],s_=i=>{let e=n_(i.target),t=function(n){let r=n.changedTouches;return r&&r[0]?r[0]:n}(i);return new C(t.clientX+e.left,t.clientY+e.top)},$c=i=>SI.includes(i.type)||i.pointerType==="touch",Jh=i=>{i.preventDefault(),i.stopPropagation()},on=i=>{if(i.length===0)return{left:0,top:0,width:0,height:0};let{min:e,max:t}=i.reduce((r,s)=>{let{min:o,max:a}=r;return{min:o.min(s),max:a.max(s)}},{min:new C(i[0]),max:new C(i[0])}),n=t.subtract(e);return{left:e.x,top:e.y,width:n.x,height:n.y}},xI=["translateX","translateY","scaleX","scaleY"],o_=(i,e)=>ys(i,xe(e,i.calcOwnMatrix())),ys=(i,e)=>{let t=ms(e),{translateX:n,translateY:r,scaleX:s,scaleY:o}=t,a=ge(t,xI),c=new C(n,r);i.flipX=!1,i.flipY=!1,Object.assign(i,a),i.set({scaleX:s,scaleY:o}),i.setPositionByOrigin(c,U,U)},a_=i=>{i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},Nf=i=>({scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}),fl=(i,e,t)=>{let n=i/2,r=e/2,s=[new C(-n,-r),new C(n,-r),new C(-n,r),new C(n,r)].map(a=>a.transform(t)),o=on(s);return new C(o.width,o.height)},Vo=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Je;return xe(gt(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je),i)},ei=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Je;return i.transform(Vo(e,t))},c_=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Je;return i.transform(Vo(e,t),!0)},ef=(i,e,t)=>{let n=Vo(e,t);return ys(i,xe(n,i.calcOwnMatrix())),n},l_=(i,e)=>{var t;let{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(i),v(v({},e),{},{target:n})),n.fire(i,e)},EI={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Ae=i=>typeof i=="string"?EI[i]:i-.5,Wc="not-allowed";function u_(i){return Ae(i.originX)===Ae(U)&&Ae(i.originY)===Ae(U)}function Dy(i){return .5-Ae(i)}var Bt=(i,e)=>i[e],d_=(i,e,t,n)=>({e:i,transform:e,pointer:new C(t,n)});function h_(i,e){let t=i.getTotalAngle()+ri(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function pl(i,e,t,n,r){var s;let{target:o,corner:a}=i,c=o.controls[a],l=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,u=o.padding/l,d=function(h,f,p,g){let y=h.getRelativeCenterPoint(),_=p!==void 0&&g!==void 0?h.translateToGivenOrigin(y,U,U,p,g):new C(h.left,h.top);return(h.angle?f.rotate(-be(h.angle),y):f).subtract(_)}(o,new C(n,r),e,t);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=c.offsetX,d.y-=c.offsetY,d}var f_=(i,e,t,n)=>{let{target:r,offsetX:s,offsetY:o}=e,a=t-s,c=n-o,l=!Bt(r,"lockMovementX")&&r.left!==a,u=!Bt(r,"lockMovementY")&&r.top!==c;return l&&r.set(Q,a),u&&r.set(Xe,c),(l||u)&&l_("moving",d_(i,e,t,n)),l||u},Yc=class{getSvgStyles(e){let t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):at,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),h=ko("fill",this.fill);return[ko("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",c,"; ",h,"fill-rule: ",t,"; ","opacity: ",l,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(Oo(n));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:r,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=r?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,h=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS"),y;c&&(c.clipPathId="CLIPPATH_".concat(ii()),y='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(n),`</clipPath>
`)),u&&p.push("<g ",a,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);let _=[o,l,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[g]=_,It(h)&&p.push(h.toSVG(this)),It(d)&&p.push(d.toSVG(this)),f&&p.push(f.toSVG(this)),c&&p.push(y),p.push(e.join("")),p.push(`</g>
`),u&&p.push(`</g>
`),n?n(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!=="fill"?' paint-order="'.concat(this.paintFirst,'" '):""}},Lh=(i,e,t,n)=>(i<Math.abs(e)?(i=e,n=t/4):n=e===0&&i===0?t/Mn*Math.asin(1):t/Mn*Math.asin(e/i),{a:i,c:e,p:t,s:n}),Sy=(i,e,t,n,r)=>i*Math.pow(2,10*(n-=1))*Math.sin((n*r-e)*Mn/t),p_=(i,e,t,n)=>-t*Math.cos(i/n*ni)+t+e,tf=(i,e,t,n)=>(i/=n)<1/2.75?t*(7.5625*i*i)+e:i<2/2.75?t*(7.5625*(i-=1.5/2.75)*i+.75)+e:i<2.5/2.75?t*(7.5625*(i-=2.25/2.75)*i+.9375)+e:t*(7.5625*(i-=2.625/2.75)*i+.984375)+e,xy=(i,e,t,n)=>t-tf(n-i,0,t,n)+e,II=Object.freeze({__proto__:null,defaultEasing:p_,easeInBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(i/=n)*i*((r+1)*i-r)+e},easeInBounce:xy,easeInCirc:(i,e,t,n)=>-t*(Math.sqrt(1-(i/=n)*i)-1)+e,easeInCubic:(i,e,t,n)=>t*(i/n)**3+e,easeInElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n)===1)return e+t;s||(s=.3*n);let{a:o,s:a,p:c}=Lh(r,t,s,1.70158);return-Sy(o,a,c,i,n)+e},easeInExpo:(i,e,t,n)=>i===0?e:t*2**(10*(i/n-1))+e,easeInOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(i/=n/2)<1?t/2*(i*i*((1+(r*=1.525))*i-r))+e:t/2*((i-=2)*i*((1+(r*=1.525))*i+r)+2)+e},easeInOutBounce:(i,e,t,n)=>i<n/2?.5*xy(2*i,0,t,n)+e:.5*tf(2*i-n,0,t,n)+.5*t+e,easeInOutCirc:(i,e,t,n)=>(i/=n/2)<1?-t/2*(Math.sqrt(1-i**2)-1)+e:t/2*(Math.sqrt(1-(i-=2)*i)+1)+e,easeInOutCubic:(i,e,t,n)=>(i/=n/2)<1?t/2*i**3+e:t/2*((i-2)**3+2)+e,easeInOutElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n/2)===2)return e+t;s||(s=n*(.3*1.5));let{a:o,s:a,p:c,c:l}=Lh(r,t,s,1.70158);return i<1?-.5*Sy(o,a,c,i,n)+e:o*Math.pow(2,-10*(i-=1))*Math.sin((i*n-a)*Mn/c)*.5+l+e},easeInOutExpo:(i,e,t,n)=>i===0?e:i===n?e+t:(i/=n/2)<1?t/2*2**(10*(i-1))+e:t/2*-(2**(-10*--i)+2)+e,easeInOutQuad:(i,e,t,n)=>(i/=n/2)<1?t/2*i**2+e:-t/2*(--i*(i-2)-1)+e,easeInOutQuart:(i,e,t,n)=>(i/=n/2)<1?t/2*i**4+e:-t/2*((i-=2)*i**3-2)+e,easeInOutQuint:(i,e,t,n)=>(i/=n/2)<1?t/2*i**5+e:t/2*((i-2)**5+2)+e,easeInOutSine:(i,e,t,n)=>-t/2*(Math.cos(Math.PI*i/n)-1)+e,easeInQuad:(i,e,t,n)=>t*(i/=n)*i+e,easeInQuart:(i,e,t,n)=>t*(i/=n)*i**3+e,easeInQuint:(i,e,t,n)=>t*(i/n)**5+e,easeInSine:(i,e,t,n)=>-t*Math.cos(i/n*ni)+t+e,easeOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((i=i/n-1)*i*((r+1)*i+r)+1)+e},easeOutBounce:tf,easeOutCirc:(i,e,t,n)=>t*Math.sqrt(1-(i=i/n-1)*i)+e,easeOutCubic:(i,e,t,n)=>t*((i/n-1)**3+1)+e,easeOutElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n)===1)return e+t;s||(s=.3*n);let{a:o,s:a,p:c,c:l}=Lh(r,t,s,1.70158);return o*2**(-10*i)*Math.sin((i*n-a)*Mn/c)+l+e},easeOutExpo:(i,e,t,n)=>i===n?e+t:t*-(2**(-10*i/n)+1)+e,easeOutQuad:(i,e,t,n)=>-t*(i/=n)*(i-2)+e,easeOutQuart:(i,e,t,n)=>-t*((i=i/n-1)*i**3-1)+e,easeOutQuint:(i,e,t,n)=>t*((i/n-1)**5+1)+e,easeOutSine:(i,e,t,n)=>t*Math.sin(i/n*ni)+e}),TI=()=>!1,No=class{constructor(e){let{startValue:t,byValue:n,duration:r=500,delay:s=0,easing:o=p_,onStart:a=er,onChange:c=er,onComplete:l=er,abort:u=TI,target:d}=e;m(this,"_state","pending"),m(this,"durationProgress",0),m(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=s,this.easing=o,this._onStart=a,this._onChange=c,this._onComplete=l,this._abort=u,this.target=d,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>xo(e),this.delay):xo(e)}tick(e){let t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;let{value:r,valueProgress:s}=this.calculate(n);this.value=Object.freeze(r),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),xo(this.tick)))}register(){Uc.push(this)}unregister(){Uc.remove(this)}abort(){this._state="aborted",this.unregister()}},MI=["startValue","endValue"],nf=class extends No{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(v(v({},ge(e,MI)),{},{startValue:t,byValue:n-t}))}calculate(e){let t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}},AI=["startValue","endValue"],rf=class extends No{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(v(v({},ge(e,AI)),{},{startValue:t,byValue:n.map((r,s)=>r-t[s])}))}calculate(e){let t=this.startValue.map((n,r)=>this.easing(e,n,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}},ir=(i,e,t)=>Math.max(i,Math.min(e,t)),OI=["startValue","endValue","easing","onChange","onComplete","abort"],kI=(i,e,t,n)=>e+t*(1-Math.cos(i/n*ni)),jh=i=>i&&((e,t,n)=>i(new et(e).toRgba(),t,n)),sf=class extends No{constructor(e){let{startValue:t,endValue:n,easing:r=kI,onChange:s,onComplete:o,abort:a}=e,c=ge(e,OI),l=new et(t).getSource(),u=new et(n).getSource();super(v(v({},c),{},{startValue:l,byValue:u.map((d,h)=>d-l[h]),easing:r,onChange:jh(s),onComplete:jh(o),abort:jh(a)}))}calculate(e){let[t,n,r,s]=this.startValue.map((a,c)=>this.easing(e,a,this.byValue[c],this.duration,c)),o=[...[t,n,r].map(Math.round),ir(0,s,1)];return{value:o,valueProgress:o.map((a,c)=>this.byValue[c]!==0?Math.abs((a-this.startValue[c])/this.byValue[c]):0).find(a=>a!==0)||0}}};function Rf(i){let e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(i)?new rf(i):new nf(i);return e.start(),e}function g_(i){let e=new sf(i);return e.start(),e}var PI=new C(1,0),m_=new C,Ff=(i,e)=>i.rotate(e),qc=(i,e)=>new C(e).subtract(i),Xc=i=>i.distanceFrom(m_),Zc=(i,e)=>Math.atan2(ps(i,e),y_(i,e)),v_=i=>Zc(PI,i),gl=i=>i.eq(m_)?i:i.scalarDivide(Xc(i)),Lf=function(i){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return gl(new C(-i.y,i.x).scalarMultiply(e?1:-1))},ps=(i,e)=>i.x*e.y-i.y*e.x,y_=(i,e)=>i.x*e.x+i.y*e.y,of=(i,e,t)=>{if(i.eq(e)||i.eq(t))return!0;let n=ps(e,t),r=ps(e,i),s=ps(t,i);return n>=0?r>=0&&s<=0:!(r<=0&&s>=0)},nr=class i{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(r=>!this.includes(r))),this}static isPointContained(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{let s=qc(t,n),o=qc(t,e).divide(s);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){let n=new C(e).setX(Math.min(e.x-1,...t.map(s=>s.x))),r=0;for(let s=0;s<t.length;s++){let o=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,n);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,n,r){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],a=t.x-e.x,c=t.y-e.y,l=r.x-n.x,u=r.y-n.y,d=e.x-n.x,h=e.y-n.y,f=l*h-u*d,p=a*h-c*d,g=u*a-l*c;if(g!==0){let y=f/g,_=p/g;return(s||0<=y&&y<=1)&&(o||0<=_&&_<=1)?new i("Intersection").append(new C(e.x+y*a,e.y+y*c)):new i}if(f===0||p===0){let y=s||o||i.isPointContained(e,n,r)||i.isPointContained(t,n,r)||i.isPointContained(n,e,t)||i.isPointContained(r,e,t);return new i(y?"Coincident":void 0)}return new i("Parallel")}static intersectSegmentLine(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!0)}static intersectSegmentSegment(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!1)}static intersectLinePolygon(e,t,n){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],s=new i,o=n.length;for(let a,c,l,u=0;u<o;u++){if(a=n[u],c=n[(u+1)%o],l=i.intersectLineLine(e,t,a,c,r,!1),l.status==="Coincident")return l;s.append(...l.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,n){return i.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){let n=new i,r=e.length,s=[];for(let o=0;o<r;o++){let a=e[o],c=e[(o+1)%r],l=i.intersectSegmentPolygon(a,c,t);l.status==="Coincident"?(s.push(l),n.append(a,c)):n.append(...l.points)}return s.length>0&&s.length===e.length?new i("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){let r=t.min(n),s=t.max(n),o=new C(s.x,r.y),a=new C(r.x,s.y);return i.intersectPolygonPolygon(e,[r,o,s,a])}},af=class extends Gc{_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=v({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth,r=n,s=0;this.strokeUniform&&(r=0,s=n);let o=t.width+r,a=t.height+r,c;return c=t.skewX===0&&t.skewY===0?new C(o*t.scaleX,a*t.scaleY):fl(o,a,Lo(t)),c.scalarAdd(s)}translateToGivenOrigin(e,t,n,r,s){let o=e.x,a=e.y,c=Ae(r)-Ae(t),l=Ae(s)-Ae(n);if(c||l){let u=this._getTransformedDimensions();o+=c*u.x,a+=l*u.y}return new C(o,a)}translateToCenterPoint(e,t,n){let r=this.translateToGivenOrigin(e,t,n,U,U);return this.angle?r.rotate(be(this.angle),e):r}translateToOriginPoint(e,t,n){let r=this.translateToGivenOrigin(e,U,U,t,n);return this.angle?r.rotate(be(this.angle),e):r}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?qe(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new C(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){let r=this.translateToCenterPoint(e,t,n),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Q,Xe)}},cf=class extends af{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?qe(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=qe(e,gt(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new C(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:e,tr:t,br:n,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,n,r];if(this.group){let o=this.group.calcTransformMatrix();return s.map(a=>qe(a,o))}return s}intersectsWithRect(e,t){return nr.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){let t=nr.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){let{left:n,top:r,width:s,height:o}=this.getBoundingRect();return n>=e.x&&n+s<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return nr.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return on(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set("scaleX",e),this._set("scaleY",e),this.setCoords()}scaleToWidth(e){let t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){let t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ri(Ky(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Je.concat()}calcACoords(){let e=Ss({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),r=Ds(t,n),s=xe(r,e),o=this._getTransformedDimensions(),a=o.x/2,c=o.y/2;return{tl:qe({x:-a,y:-c},s),tr:qe({x:a,y:-c},s),bl:qe({x:-a,y:c},s),br:qe({x:a,y:c},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Ae(this.originX),Ae(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;let n=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every((s,o)=>s===n[o])?r.value:(this.group&&(t=xe(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;let n=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=Jy(r);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new C(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}},lf=class i extends cf{isDescendantOf(e){let{parent:t,group:n}=this;return t===e||n===e||this.canvas===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){let e=[],t=this;do t=t instanceof i?t.parent:void 0,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let r,s=0;s<t.length;s++){if(r=t[s],r===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let o=0;o<n.length;o++){if(this===n[o])return{fork:[],otherFork:[e,...n.slice(0,o)],common:[this,...t]};if(r===n[o])return{fork:[this,...t.slice(0,s)],otherFork:[e,...n.slice(0,o)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){let t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;let t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;let n=t.common[0]||this.canvas;if(!n)return;let r=t.fork.pop(),s=t.otherFork.pop(),o=n._objects.indexOf(r),a=n._objects.indexOf(s);return o>-1&&o>a}},Kc=class extends lf{animate(e,t){return Object.entries(e).reduce((n,r)=>{let[s,o]=r;return n[s]=this._animate(s,o,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.split("."),s=this.constructor.colorProperties.includes(r[r.length-1]),{abort:o,startValue:a,onChange:c,onComplete:l}=n,u=v(v({},n),{},{target:this,startValue:a??r.reduce((d,h)=>d[h],this),endValue:t,abort:o?.bind(this),onChange:(d,h,f)=>{r.reduce((p,g,y)=>(y===r.length-1&&(p[g]=d),p[g]),this),c&&c(d,h,f)},onComplete:(d,h,f)=>{this.setCoords(),l&&l(d,h,f)}});return s?g_(u):Rf(u)}};function ml(i){return new RegExp("^("+i.join("|")+")\\b","i")}var Ey,Iy;m(Kc,"colorProperties",["fill","stroke","backgroundColor"]);var rn=String.raw(Ey||(Ey=ln(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"])));String.raw(Iy||(Iy=ln(["(?:s+,?s*|,s*|$)"],["(?:\\s+,?\\s*|,\\s*|$)"])));var NI=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+rn+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+rn+"))?\\s+(.*)"),RI={cx:Q,x:Q,r:"radius",cy:Xe,y:Xe,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Vh="font-size",Bh="clip-path",lL=ml(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),uL=ml(["symbol","image","marker","pattern","view","svg"]),Ty=ml(["symbol","g","a","svg","clipPath","defs"]),dL=new RegExp("^\\s*("+rn+"+)\\s*,?\\s*("+rn+"+)\\s*,?\\s*("+rn+"+)\\s*,?\\s*("+rn+"+)\\s*$"),My="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Ay=new RegExp("(?:\\s|^)"+My+My+"("+rn+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),Tn=class i{constructor(e){let t=typeof e=="string"?i.parseShadow(e):e;Object.assign(this,i.ownDefaults);for(let n in t)this[n]=t[n];this.id=ii()}static parseShadow(e){let t=e.trim(),[,n=0,r=0,s=0]=(Ay.exec(t)||[]).map(o=>parseFloat(o)||0);return{color:(t.replace(Ay,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:r,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let t=Ff(new C(this.offsetX,this.offsetY),be(-e.angle)),n=new et(this.color),r=40,s=40;return e.width&&e.height&&(r=100*Z((Math.abs(t.x)+this.blur)/e.width,q.NUM_FRACTION_DIGITS)+20,s=100*Z((Math.abs(t.y)+this.blur)/e.height,q.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Z(this.blur?this.blur/2:0,q.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Z(t.x,q.NUM_FRACTION_DIGITS),'" dy="').concat(Z(t.y,q.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=i.ownDefaults;return this.includeDefaultValues?e:Pf(e,(n,r)=>n!==t[r])}static async fromObject(e){return new this(e)}};m(Tn,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),m(Tn,"type","shadow"),I.setClass(Tn,"shadow");var Bo=i=>JSON.parse(JSON.stringify(i)),FI=[Xe,Q,"scaleX","scaleY","flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible","skewX","skewY"],An=["fill","stroke","strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],LI={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Q,originY:Xe,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:"fill",fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},jI=["type"],VI=["extraParam"],Ri=class uf extends Kc{static getDefaults(){return uf.ownDefaults}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){ti("warn","Setting type has no effect",e)}constructor(e){super(),m(this,"_cacheContext",null),Object.assign(this,uf.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Ee(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let t=e.width,n=e.height,r=q.maxCacheSideLimit,s=q.minCacheSideLimit;if(t<=r&&n<=r&&t*n<=q.perfLimitSizeTotal)return t<s&&(e.width=s),n<s&&(e.height=s),e;let o=t/n,[a,c]=So.limitDimsByArea(o),l=ir(s,a,r),u=ir(s,c,r);return t>l&&(e.zoomX/=t/l,e.width=l,e.capped=!0),n>u&&(e.zoomY/=n/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:n+2,height:r+2,zoomX:e.x,zoomY:e.y,x:n,y:r}}_updateCacheCanvas(){let e=this._cacheCanvas,t=this._cacheContext,n=this._limitCacheSize(this._getCacheCanvasDimensions()),r=q.minCacheSideLimit,s=n.width,o=n.height,a=n.zoomX,c=n.zoomY,l=s!==e.width||o!==e.height,u=this.zoomX!==a||this.zoomY!==c;if(!e||!t)return!1;let d,h,f=l||u,p=0,g=0,y=!1;if(l){let _=this._cacheCanvas.width,b=this._cacheCanvas.height,S=s>_||o>b;y=S||(s<.9*_||o<.9*b)&&_>r&&b>r,S&&!n.capped&&(s>r||o>r)&&(p=.1*s,g=.1*o)}return t_(this)&&this.path&&(f=!0,y=!0,p+=this.getHeightOfLine(0)*this.zoomX,g+=this.getHeightOfLine(0)*this.zoomY),!!f&&(y?(e.width=Math.ceil(s+p),e.height=Math.ceil(o+g)):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height)),d=n.x/2,h=n.y/2,this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-h)+h,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,c),this.zoomX=a,this.zoomY=c,!0)}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){let t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=q.NUM_FRACTION_DIGITS,n=this.clipPath&&!this.clipPath.excludeFromExport?v(v({},this.clipPath.toObject(e)),{},{inverted:this.clipPath.inverted,absolutePositioned:this.clipPath.absolutePositioned}):null,r=v(v({},sr(this,e)),{},{type:this.constructor.type,version:Xh,originX:this.originX,originY:this.originY,left:Z(this.left,t),top:Z(this.top,t),width:Z(this.width,t),height:Z(this.height,t),fill:Cy(this.fill)?this.fill.toObject():this.fill,stroke:Cy(this.stroke)?this.stroke.toObject():this.stroke,strokeWidth:Z(this.strokeWidth,t),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:Z(this.strokeMiterLimit,t),scaleX:Z(this.scaleX,t),scaleY:Z(this.scaleY,t),angle:Z(this.angle,t),flipX:this.flipX,flipY:this.flipY,opacity:Z(this.opacity,t),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:Z(this.skewX,t),skewY:Z(this.skewY,t)},n?{clipPath:n}:null);return this.includeDefaultValues?r:this._removeDefaultValues(r)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return Pf(e,(r,s)=>{if(s===Q||s===Xe||s==="type")return!0;let o=n[s];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}getObjectScaling(){if(!this.group)return new C(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=ms(this.calcTransformMatrix());return new C(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!=="scaleX"&&e!=="scaleY"||(t=this._constrainScale(t)),e==="scaleX"&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof Tn||(t=new Tn(t));let n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext&&(this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.parent||!this.parent.isOnACache()),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t){if(e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",t.absolutePositioned){let n=gt(this.calcTransformMatrix());e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}drawObject(e,t){let n=this.fill,r=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=n,this.stroke=r}_drawClipPath(e,t){t&&(t._set("canvas",this.canvas),t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;let t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){let n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,It(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(It(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&(1&t.length&&t.push(...t),e.setLineDash(t))}_setShadow(e){if(!this.shadow)return;let t=this.shadow,n=this.canvas,r=this.getCanvasRetinaScaling(),[s,,,o]=n?.viewportTransform||Je,a=s*r,c=o*r,l=t.nonScaling?new C(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*q.browserShadowBlurConstant*(a+c)*(l.x+l.y)/4,e.shadowOffsetX=t.offsetX*a*l.x,e.shadowOffsetY=t.offsetY*c*l.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!It(t))return{offsetX:0,offsetY:0};let n=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,s):e.transform(1,0,0,1,r,s),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:r,offsetY:s}}_renderPaintInOrder(e){this.paintFirst==="stroke"?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;let r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=Ee(),o=this.getCanvasRetinaScaling(),a=r.x/this.scaleX/o,c=r.y/this.scaleY/o;s.width=Math.ceil(a),s.height=Math.ceil(c);let l=s.getContext("2d");l&&(l.beginPath(),l.moveTo(0,0),l.lineTo(a,0),l.lineTo(a,c),l.lineTo(0,c),l.closePath(),l.translate(a/2,c/2),l.scale(r.zoomX/this.scaleX/o,r.zoomY/this.scaleY/o),this._applyPatternGradientTransform(l,t),l.fillStyle=t.toLive(e),l.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/r.zoomX,o*this.scaleY/r.zoomY),e.strokeStyle=(n=l.createPattern(s,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new C(this.left+this.width/2,this.top+this.height/2)}clone(e){let t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){let t=this.toCanvasElement(e);return new(I.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=Nf(this),n=this.group,r=this.shadow,s=Math.abs,o=e.enableRetinaScaling?Wy():1,a=(e.multiplier||1)*o,c=e.canvasProvider||(b=>new Po(b,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&a_(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&ef(this,this.getViewportTransform()),this.setCoords();let l=Ee(),u=this.getBoundingRect(),d=this.shadow,h=new C;if(d){let b=d.blur,S=d.nonScaling?new C(1,1):this.getObjectScaling();h.x=2*Math.round(s(d.offsetX)+b)*s(S.x),h.y=2*Math.round(s(d.offsetY)+b)*s(S.y)}let f=u.width+h.x,p=u.height+h.y;l.width=Math.ceil(f),l.height=Math.ceil(p);let g=c(l);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new C(g.width/2,g.height/2),U,U);let y=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();let _=g.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=r,n&&(this.group=n),this.set(t),this.setCoords(),g._objects=[],g.destroy(),_}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Af(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:t,originX:n,originY:r}=this;if(t){let{x:s,y:o}=this.getRelativeCenterPoint();this.originX=U,this.originY=U,this.left=s,this.top=o}if(this.set("angle",e),t){let{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,r);this.left=s,this.top=o,this.originX=n,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Uc.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&cn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}static _fromObject(e){let t=ge(e,jI),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=n,s=ge(n,VI);return jo(Bo(t),s).then(o=>{let a=v(v({},s),o);if(r){let{[r]:c}=a;return new this(c,ge(a,[r].map($y)))}return new this(a)})}static fromObject(e,t){return this._fromObject(e,t)}};m(Ri,"stateProperties",FI),m(Ri,"cacheProperties",An),m(Ri,"ownDefaults",LI),m(Ri,"type","FabricObject"),I.setClass(Ri),I.setClass(Ri,"object");var si=(i,e)=>(t,n,r,s)=>{let o=e(t,n,r,s);return o&&l_(i,d_(t,n,r,s)),o};function or(i){return(e,t,n,r)=>{let{target:s,originX:o,originY:a}=t,c=s.getRelativeCenterPoint(),l=s.translateToOriginPoint(c,o,a),u=i(e,t,n,r);return s.setPositionByOrigin(l,t.originX,t.originY),u}}var df=si("resizing",or((i,e,t,n)=>{let r=pl(e,e.originX,e.originY,t,n);if(Ae(e.originX)===Ae(U)||Ae(e.originX)===Ae(Se)&&r.x<0||Ae(e.originX)===Ae(Q)&&r.x>0){let{target:s}=e,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=u_(e)?2:1,c=s.width,l=Math.ceil(Math.abs(r.x*a/s.scaleX)-o);return s.set("width",Math.max(l,0)),c!==s.width}return!1}));function __(i,e,t,n,r){n=n||{};let s=this.sizeX||n.cornerSize||r.cornerSize,o=this.sizeY||n.cornerSize||r.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:r.transparentCorners,c=a?"stroke":"fill",l=!a&&(n.cornerStrokeColor||r.cornerStrokeColor),u,d=e,h=t;i.save(),i.fillStyle=n.cornerColor||r.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||r.cornerStrokeColor||"",s>o?(u=s,i.scale(1,o/s),h=t*s/o):o>s?(u=o,i.scale(s/o,1),d=e*o/s):u=s,i.lineWidth=1,i.beginPath(),i.arc(d,h,u/2,0,Mn,!1),i[c](),l&&i.stroke(),i.restore()}function C_(i,e,t,n,r){n=n||{};let s=this.sizeX||n.cornerSize||r.cornerSize,o=this.sizeY||n.cornerSize||r.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:r.transparentCorners,c=a?"stroke":"fill",l=!a&&(n.cornerStrokeColor||r.cornerStrokeColor),u=s/2,d=o/2;i.save(),i.fillStyle=n.cornerColor||r.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||r.cornerStrokeColor||"",i.lineWidth=1,i.translate(e,t);let h=r.getTotalAngle();i.rotate(be(h)),i["".concat(c,"Rect")](-u,-d,s,o),l&&i.strokeRect(-u,-d,s,o),i.restore()}var Ue=class{constructor(e){m(this,"visible",!0),m(this,"actionName","scale"),m(this,"angle",0),m(this,"x",0),m(this,"y",0),m(this,"offsetX",0),m(this,"offsetY",0),m(this,"sizeX",0),m(this,"sizeY",0),m(this,"touchSizeX",0),m(this,"touchSizeY",0),m(this,"cursorStyle","crosshair"),m(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,r){var s;let{tl:o,tr:a,br:c,bl:l}=r;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&nr.isPointInPolygon(n,[o,a,c,l])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,r;return(n=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,r){return new C(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,r,s,o){let a=dl([Ds(n,r),Ss({angle:e}),hl((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new C(-.5,-.5).transform(a),tr:new C(.5,-.5).transform(a),br:new C(.5,.5).transform(a),bl:new C(-.5,.5).transform(a)}}render(e,t,n,r,s){((r=r||{}).cornerStyle||s.cornerStyle)==="circle"?__.call(this,e,t,n,r,s):C_.call(this,e,t,n,r,s)}},w_=(i,e,t)=>t.lockRotation?Wc:e.cursorStyle,b_=si("rotating",or((i,e,t,n)=>{let{target:r,ex:s,ey:o,theta:a,originX:c,originY:l}=e,u=r.translateToOriginPoint(r.getRelativeCenterPoint(),c,l);if(Bt(r,"lockRotation"))return!1;let d=Math.atan2(o-u.y,s-u.x),h=Math.atan2(n-u.y,t-u.x),f=ri(h-d+a);if(r.snapAngle&&r.snapAngle>0){let g=r.snapAngle,y=r.snapThreshold||g,_=Math.ceil(f/g)*g,b=Math.floor(f/g)*g;Math.abs(f-b)<y?f=b:Math.abs(f-_)<y&&(f=_)}f<0&&(f=360+f),f%=360;let p=r.angle!==f;return r.angle=f,p}));function D_(i,e){let t=e.canvas,n=i[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function S_(i,e,t){let n=Bt(i,"lockScalingX"),r=Bt(i,"lockScalingY");if(n&&r||!e&&(n||r)&&t||n&&e==="x"||r&&e==="y")return!0;let{width:s,height:o,strokeWidth:a}=i;return s===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}var BI=["e","se","s","sw","w","nw","n","ne","e"],cs=(i,e,t)=>{let n=D_(i,t);if(S_(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Wc;let r=h_(t,e);return"".concat(BI[r],"-resize")};function jf(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=e.target,o=r.by,a=D_(i,s),c,l,u,d,h,f;if(S_(s,o,a))return!1;if(e.gestureScale)l=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=pl(e,e.originX,e.originY,t,n),h=o!=="y"?Math.sign(c.x||e.signX||1):1,f=o!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=f),Bt(s,"lockScalingFlip")&&(e.signX!==h||e.signY!==f))return!1;if(d=s._getTransformedDimensions(),a&&!o){let y=Math.abs(c.x)+Math.abs(c.y),{original:_}=e,b=y/(Math.abs(d.x*_.scaleX/s.scaleX)+Math.abs(d.y*_.scaleY/s.scaleY));l=_.scaleX*b,u=_.scaleY*b}else l=Math.abs(c.x*s.scaleX/d.x),u=Math.abs(c.y*s.scaleY/d.y);u_(e)&&(l*=2,u*=2),e.signX!==h&&o!=="y"&&(e.originX=Dy(e.originX),l*=-1,e.signX=h),e.signY!==f&&o!=="x"&&(e.originY=Dy(e.originY),u*=-1,e.signY=f)}let p=s.scaleX,g=s.scaleY;return o?(o==="x"&&s.set("scaleX",l),o==="y"&&s.set("scaleY",u)):(!Bt(s,"lockScalingX")&&s.set("scaleX",l),!Bt(s,"lockScalingY")&&s.set("scaleY",u)),p!==s.scaleX||g!==s.scaleY}var bo=si("scaling",or((i,e,t,n)=>jf(i,e,t,n))),x_=si("scaling",or((i,e,t,n)=>jf(i,e,t,n,{by:"x"}))),E_=si("scaling",or((i,e,t,n)=>jf(i,e,t,n,{by:"y"}))),HI=["target","ex","ey","skewingSide"],Hh={x:{counterAxis:"y",scale:"scaleX",skew:"skewX",lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:"scaleY",skew:"skewY",lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},UI=["ns","nesw","ew","nwse"],I_=(i,e,t)=>{if(e.x!==0&&Bt(t,"lockSkewingY")||e.y!==0&&Bt(t,"lockSkewingX"))return Wc;let n=h_(t,e)%4;return"".concat(UI[n],"-resize")};function T_(i,e,t,n,r){let{target:s}=t,{counterAxis:o,origin:a,lockSkewing:c,skew:l,flip:u}=Hh[i];if(Bt(s,c))return!1;let{origin:d,flip:h}=Hh[o],f=Ae(t[d])*(s[h]?-1:1),p=-Math.sign(f)*(s[u]?-1:1),g=.5*-((s[l]===0&&pl(t,U,U,n,r)[i]>0||s[l]>0?1:-1)*p)+.5;return si("skewing",or((_,b,S,E)=>function(A,O,R){let{target:M,ex:le,ey:me,skewingSide:Le}=O,Oe=ge(O,HI),{skew:ue}=Hh[A],Ie=R.subtract(new C(le,me)).divide(new C(M.scaleX,M.scaleY))[A],Mt=M[ue],mt=Oe[ue],dn=Math.tan(be(mt)),hn=A==="y"?M._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:M._getTransformedDimensions({scaleX:1,scaleY:1}).y,ai=2*Ie*Le/Math.max(hn,1)+dn,ci=ri(Math.atan(ai));M.set(ue,ci);let Ho=Mt!==M[ue];if(Ho&&A==="y"){let{skewX:Dl,scaleX:xs}=M,kn=M._getTransformedDimensions({skewY:Mt}),Es=M._getTransformedDimensions(),li=Dl!==0?kn.x/Es.x:1;li!==1&&M.set("scaleX",li*xs)}return Ho}(i,b,new C(S,E))))(e,v(v({},t),{},{[a]:g,skewingSide:p}),n,r)}var M_=(i,e,t,n)=>T_("x",i,e,t,n),A_=(i,e,t,n)=>T_("y",i,e,t,n);function vl(i,e){return i[e.canvas.altActionKey]}var Do=(i,e,t)=>{let n=vl(i,t);return e.x===0?n?"skewX":"scaleY":e.y===0?n?"skewY":"scaleX":""},ji=(i,e,t)=>vl(i,t)?I_(0,e,t):cs(i,e,t),hf=(i,e,t,n)=>vl(i,e.target)?A_(i,e,t,n):x_(i,e,t,n),ff=(i,e,t,n)=>vl(i,e.target)?M_(i,e,t,n):E_(i,e,t,n),Vf=()=>({ml:new Ue({x:-.5,y:0,cursorStyleHandler:ji,actionHandler:hf,getActionName:Do}),mr:new Ue({x:.5,y:0,cursorStyleHandler:ji,actionHandler:hf,getActionName:Do}),mb:new Ue({x:0,y:.5,cursorStyleHandler:ji,actionHandler:ff,getActionName:Do}),mt:new Ue({x:0,y:-.5,cursorStyleHandler:ji,actionHandler:ff,getActionName:Do}),tl:new Ue({x:-.5,y:-.5,cursorStyleHandler:cs,actionHandler:bo}),tr:new Ue({x:.5,y:-.5,cursorStyleHandler:cs,actionHandler:bo}),bl:new Ue({x:-.5,y:.5,cursorStyleHandler:cs,actionHandler:bo}),br:new Ue({x:.5,y:.5,cursorStyleHandler:cs,actionHandler:bo}),mtr:new Ue({x:0,y:-.5,actionHandler:b_,cursorStyleHandler:w_,offsetY:-40,withConnection:!0,actionName:"rotate"})}),O_=()=>({mr:new Ue({x:.5,y:0,actionHandler:df,cursorStyleHandler:ji,actionName:"resizing"}),ml:new Ue({x:-.5,y:0,actionHandler:df,cursorStyleHandler:ji,actionName:"resizing"})}),k_=()=>v(v({},Vf()),O_()),Qc=class i extends Ri{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),i.ownDefaults),this.setOptions(e)}static createControls(){return{controls:Vf()}}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let t=e._currentTransform,n=t.target,r=t.action;if(this===n&&r&&r.startsWith("scale"))return!1}return super._updateCacheCanvas()}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let n=Object.entries(this.oCoords);for(let r=n.length-1;r>=0;r--){let[s,o]=n[r],a=this.controls[s];if(a.shouldActivate(s,this,e,t?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){let e=this.getViewportTransform(),t=this.getCenterPoint(),n=Ds(t.x,t.y),r=Ss({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=xe(n,r),o=xe(e,s),a=xe(o,[1/e[0],0,0,1/e[3],0,0]),c=this.group?ms(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));let l=this._calculateCurrentDimensions(c),u={};return this.forEachControl((d,h)=>{let f=d.positionHandler(l,a,this,d);u[h]=Object.assign(f,this._calcCornerCoords(d,f))}),u}_calcCornerCoords(e,t){let n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(be(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=v({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:n,hasControls:r}=this,s=v({hasBorders:n,hasControls:r},t),o=this.getViewportTransform(),a=s.hasBorders,c=s.hasControls,l=xe(o,this.calcTransformMatrix()),u=ms(l);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=1*this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(be(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),c&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let r;if(n&&n.forActiveSelection||this.group){let s=fl(this.width,this.height,Lo(t)),o=this.isStrokeAccountedForInDimensions()?Mf:(this.strokeUniform?new C().scalarAdd(this.canvas?this.canvas.getZoom():1):new C(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((r,s)=>{r.withConnection&&r.getVisibility(this,s)&&(n=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let n=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:s,cornerColor:o}=this,a=v({cornerStrokeColor:r,cornerDashArray:s,cornerColor:o},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((c,l)=>{if(c.getVisibility(this,l)){let u=this.oCoords[l];c.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,r]=t;return this.setControlVisible(n,r)})}clearContextTop(e){if(!this.canvas)return;let t=this.canvas.contextTop;if(!t)return;let n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);let r=this.width+4,s=this.height+4;return t.clearRect(-r/2,-s/2,r,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function P_(i,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(i.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),i}m(Qc,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var Fe=class extends Qc{};P_(Fe,[Yc]),I.setClass(Fe),I.setClass(Fe,"object");var N_=(i,e,t,n)=>{let r=2*(n=Math.round(n))+1,{data:s}=i.getImageData(e-n,t-n,r,r);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0},Jc=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new C(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new C(1/this.options.scaleX,1/this.options.scaleY):new C(1,1)}createSideVector(e,t){let n=qc(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){let t=new C(e);return t.y+=t.x*Math.tan(be(this.options.skewY)),t.x+=t.y*Math.tan(be(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}},GI=new C,el=class i extends Jc{static getOrthogonalRotationFactor(e,t){let n=t?Zc(e,t):v_(e);return Math.abs(n)<ni?-1:1}constructor(e,t,n,r){super(r),m(this,"AB",void 0),m(this,"AC",void 0),m(this,"alpha",void 0),m(this,"bisector",void 0),this.A=new C(e),this.B=new C(t),this.C=new C(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Zc(this.AB,this.AC),this.bisector=gl(Ff(this.AB.eq(GI)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t),s=Lf(r),o=i.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,n*o)}projectBevel(){let e=[];return(this.alpha%Mn==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),s=this.options.strokeUniform?Xc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Xc(r)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){let n=[],r=new C(i.getOrthogonalRotationFactor(this.bisector),i.getOrthogonalRotationFactor(new C(this.bisector.y,this.bisector.x)));return[new C(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new C(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach(s=>{of(s,e,t)&&n.push(this.A.add(s))}),n}projectRoundWithSkew(e,t){let n=[],{skewX:r,skewY:s,scaleX:o,scaleY:a,strokeUniform:c}=this.options,l=new C(Math.tan(be(r)),Math.tan(be(s))),u=this.strokeProjectionMagnitude,d=c?u/a/Math.sqrt(1/a**2+1/o**2*l.y**2):u/Math.sqrt(1+l.y**2),h=new C(Math.sqrt(Math.max(u**2-d**2,0)),d),f=c?u/Math.sqrt(1+l.x**2*(1/a)**2/(1/o+1/o*l.x*l.y)**2):u/Math.sqrt(1+l.x**2/(1+l.x*l.y)**2),p=new C(f,Math.sqrt(Math.max(u**2-f**2,0)));return[p,p.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(g=>this.applySkew(c?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{of(g,e,t)&&n.push(this.applySkew(this.A).add(g))}),n}projectRound(){let e=[];e.push(...this.projectBevel());let t=this.alpha%Mn==0,n=this.applySkew(this.A),r=e[t?0:2].subtract(n),s=e[t?1:0].subtract(n),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=ps(r,o)>0,c=a?r:s,l=a?s:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,l)):e.push(...this.projectRoundNoSkew(c,l)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}},tl=class extends Jc{constructor(e,t,n){super(n),this.A=new C(e),this.T=new C(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t);return this.scaleUnitVector(Lf(r),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let t=new C(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new el(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let t=new C(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{let t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(gl(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(n);e.push(r.add(t),r.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}},R_=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],n=[];if(i.length===0)return n;let r=i.reduce((s,o)=>(s[s.length-1].eq(o)||s.push(new C(o)),s),[new C(i[0])]);if(r.length===1)t=!0;else if(!t){let s=r[0],o=((a,c)=>{for(let l=a.length-1;l>=0;l--)if(c(a[l],l,a))return l;return-1})(r,a=>!a.eq(s));r.splice(o+1)}return r.forEach((s,o,a)=>{let c,l;o===0?(l=a[1],c=t?s:a[a.length-1]):o===a.length-1?(c=a[o-1],l=t?s:a[0]):(c=a[o-1],l=a[o+1]),t&&a.length===1?n.push(...new tl(s,s,e).project()):!t||o!==0&&o!==a.length-1?n.push(...new el(s,c,l,e).project()):n.push(...new tl(s,o===0?l:c,e).project())}),n},F_=i=>i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),yl=i=>{let e=[];for(let t,n=0;n<i.length;n++)(t=zI(i,n))!==!1&&e.push(t);return e},zI=(i,e)=>{let t=i.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return i.charAt(e);if(55296<=t&&t<=56319){if(i.length<=e+1)throw"High surrogate without following low surrogate";let r=i.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return i.charAt(e)+i.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";let n=i.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},$I=Object.freeze({__proto__:null,capitalize:function(i){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(i.charAt(0).toUpperCase()).concat(e?i.slice(1):i.slice(1).toLowerCase())},escapeXml:F_,graphemeSplit:yl}),_l=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return i.fill!==e.fill||i.stroke!==e.stroke||i.strokeWidth!==e.strokeWidth||i.fontSize!==e.fontSize||i.fontFamily!==e.fontFamily||i.fontWeight!==e.fontWeight||i.fontStyle!==e.fontStyle||i.textBackgroundColor!==e.textBackgroundColor||i.deltaY!==e.deltaY||t&&(i.overline!==e.overline||i.underline!==e.underline||i.linethrough!==e.linethrough)},L_=(i,e)=>{let t=e.split(`
`),n=[],r=-1,s={};i=Bo(i);for(let o=0;o<t.length;o++){let a=yl(t[o]);if(i[o])for(let c=0;c<a.length;c++){r++;let l=i[o][c];l&&Object.keys(l).length>0&&(_l(s,l,!0)?n.push({start:r,end:r+1,style:l}):n[n.length-1].end++),s=l||{}}else r+=a.length,s={}}return n},j_=(i,e)=>{if(!Array.isArray(i))return Bo(i);let t=e.split(Tf),n={},r=-1,s=0;for(let o=0;o<t.length;o++){let a=yl(t[o]);for(let c=0;c<a.length;c++)r++,i[s]&&i[s].start<=r&&r<i[s].end&&(n[o]=n[o]||{},n[o][c]=v({},i[s].style),r===i[s].end-1&&s++)}return n},oi=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Oy(i,e){let t=i.nodeName,n=i.getAttribute("class"),r=i.getAttribute("id"),s="(?![a-zA-Z\\-]+)",o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+s,"i"),e=e.replace(o,"")),n&&e.length){let a=n.split(" ");for(let c=a.length;c--;)o=new RegExp("\\."+a[c]+s,"i"),e=e.replace(o,"")}return e.length===0}function WI(i,e){let t=!0,n=Oy(i,e.pop());return n&&e.length&&(t=function(r,s){let o,a=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&s.length;)a&&(o=s.pop()),a=Oy(r=r.parentElement,o);return s.length===0}(i,e)),n&&t&&e.length===0}var YI=i=>{var e;return(e=RI[i])!==null&&e!==void 0?e:i},qI=new RegExp("(".concat(rn,")"),"gi"),V_=i=>i.replace(qI," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),ky,Py,Ny,Ry,Fy,Ly,jy,Qe="(".concat(rn,")"),XI=String.raw(ky||(ky=ln(["(skewX)(",")"],["(skewX)\\(","\\)"])),Qe),ZI=String.raw(Py||(Py=ln(["(skewY)(",")"],["(skewY)\\(","\\)"])),Qe),KI=String.raw(Ny||(Ny=ln(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Qe,Qe,Qe),QI=String.raw(Ry||(Ry=ln(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Qe,Qe),JI=String.raw(Fy||(Fy=ln(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Qe,Qe),eT=String.raw(Ly||(Ly=ln(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Qe,Qe,Qe,Qe,Qe,Qe),Bf="(?:".concat(eT,"|").concat(JI,"|").concat(KI,"|").concat(QI,"|").concat(XI,"|").concat(ZI,")"),tT="(?:".concat(Bf,"*)"),nT=String.raw(jy||(jy=ln(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),tT),iT=new RegExp(nT),rT=new RegExp(Bf),sT=new RegExp(Bf,"g");function pf(i){let e=[];if(!(i=V_(i).replace(/\s*([()])\s*/gi,"$1"))||i&&!iT.test(i))return[...Je];for(let t of i.matchAll(sT)){let n=rT.exec(t[0]);if(!n)continue;let r=Je,s=n.filter(p=>!!p),[,o,...a]=s,[c,l,u,d,h,f]=a.map(p=>parseFloat(p));switch(o){case"translate":r=Ds(c,l);break;case"rotate":r=Ss({angle:c},{x:l,y:u});break;case"scale":r=hl(c,l);break;case"skewX":r=Of(c);break;case"skewY":r=kf(c);break;case"matrix":r=[c,l,u,d,h,f]}e.push(r)}return dl(e)}function oT(i,e,t,n){let r=Array.isArray(e),s,o=e;if(i!=="fill"&&i!=="stroke"||e!==at){if(i==="strokeUniform")return e==="non-scaling-stroke";if(i==="strokeDashArray")o=e===at?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(i==="transformMatrix")o=t&&t.transformMatrix?xe(t.transformMatrix,pf(e)):pf(e);else if(i==="visible")o=e!==at&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(i==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(i==="textAnchor")o=e==="start"?Q:e==="end"?Se:U;else if(i==="charSpacing")s=tr(e,n)/n*1e3;else if(i==="paintFirst"){let a=e.indexOf("fill"),c=e.indexOf("stroke");o="fill",(a>-1&&c>-1&&c<a||a===-1&&c>-1)&&(o="stroke")}else{if(i==="href"||i==="xlink:href"||i==="font")return e;if(i==="imageSmoothing")return e==="optimizeQuality";s=r?e.map(tr):tr(e,n)}}else o="";return!r&&isNaN(s)?o:s}function aT(i,e){let t=i.match(NI);if(!t)return;let n=t[1],r=t[3],s=t[4],o=t[5],a=t[6];n&&(e.fontStyle=n),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=tr(s)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function cT(i){let e={},t=i.getAttribute("style");return t&&(typeof t=="string"?function(n,r){n.replace(/;\s*$/,"").split(";").forEach(s=>{let[o,a]=s.split(":");r[o.trim().toLowerCase()]=a.trim()})}(t,e):function(n,r){Object.entries(n).forEach(s=>{let[o,a]=s;a!==void 0&&(r[o.toLowerCase()]=a)})}(t,e)),e}var lT={stroke:"strokeOpacity",fill:"fillOpacity"};function On(i,e,t){if(!i)return{};let n,r={},s=If;i.parentNode&&Ty.test(i.parentNode.nodeName)&&(r=On(i.parentElement,e,t),r.fontSize&&(n=s=tr(r.fontSize)));let o=v(v(v({},e.reduce((l,u)=>{let d=i.getAttribute(u);return d&&(l[u]=d),l},{})),function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(let h in u)WI(l,h.split(" "))&&(d=v(v({},d),u[h]));return d}(i,t)),cT(i));o[Bh]&&i.setAttribute(Bh,o[Bh]),o[Vh]&&(n=tr(o[Vh],s),o[Vh]="".concat(n));let a={};for(let l in o){let u=YI(l),d=oT(u,o[l],r,n);a[u]=d}a&&a.font&&aT(a.font,a);let c=v(v({},r),a);return Ty.test(i.nodeName)?c:function(l){let u=Fe.getDefaults();return Object.entries(lT).forEach(d=>{let[h,f]=d;if(l[f]===void 0||l[h]==="")return;if(l[h]===void 0){if(!u[h])return;l[h]=u[h]}if(l[h].indexOf("url(")===0)return;let p=new et(l[h]);l[h]=p.setAlpha(Z(p.getAlpha()*l[f],2)).toRgba()}),l}(c)}var uT=["left","top","width","height","visible"],B_=["rx","ry"],Sn=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){let{width:t,height:n}=this,r=-t/2,s=-n/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,n/2):0,c=o!==0||a!==0;e.beginPath(),e.moveTo(r+o,s),e.lineTo(r+t-o,s),c&&e.bezierCurveTo(r+t-Zn*o,s,r+t,s+Zn*a,r+t,s+a),e.lineTo(r+t,s+n-a),c&&e.bezierCurveTo(r+t,s+n-Zn*a,r+t-Zn*o,s+n,r+t-o,s+n),e.lineTo(r+o,s+n),c&&e.bezierCurveTo(r+Zn*o,s+n,r,s+n-Zn*a,r,s+n-a),e.lineTo(r,s+a),c&&e.bezierCurveTo(r,s+Zn*a,r+Zn*o,s,r+o,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...B_,...e])}_toSVG(){let{width:e,height:t,rx:n,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){let r=On(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,width:a=0,height:c=0,visible:l=!0}=r,u=ge(r,uT);return new this(v(v(v({},t),u),{},{left:s,top:o,width:a,height:c,visible:!!(l&&a&&c)}))}};m(Sn,"type","Rect"),m(Sn,"cacheProperties",[...An,...B_]),m(Sn,"ownDefaults",{rx:0,ry:0}),m(Sn,"ATTRIBUTE_NAMES",[...oi,"x","y","rx","ry","width","height"]),I.setClass(Sn),I.setSVGClass(Sn);var En="initialization",nl="added",Hf="removed",il="imperative",H_=(i,e)=>{let{strokeUniform:t,strokeWidth:n,width:r,height:s,group:o}=e,a=o&&o!==i?Vo(o.calcTransformMatrix(),i.calcTransformMatrix()):null,c=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),l=!e.isStrokeAccountedForInDimensions(),u=t&&l?c_(new C(n,n),void 0,i.calcTransformMatrix()):Mf,d=!t&&l?n:0,h=fl(r+d,s+d,dl([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(h),c.add(h)]},_s=class{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){return e.type===En||e.type===il||!!e.prevStrategy&&e.strategy!==e.prevStrategy}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==En&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){if(t.type===il&&t.overrides)return t.overrides;if(e.length===0)return;let{target:n}=t,{left:r,top:s,width:o,height:a}=on(e.map(u=>H_(n,u)).reduce((u,d)=>u.concat(d),[])),c=new C(o,a),l=new C(r,s).add(c.scalarDivide(2));if(t.type===En){let u=this.getInitialSize(t,{size:c,center:l});return{center:l,relativeCorrection:new C(0,0),size:u}}return{center:l.transform(n.calcOwnMatrix()),size:c}}};m(_s,"type","strategy");var Ro=class extends _s{shouldPerformLayout(e){return!0}};m(Ro,"type","fit-content"),I.setClass(Ro);var dT=["strategy"],hT=["target","strategy","bubbles","prevStrategy"],U_="layoutManager",rr=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Ro;m(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let t=v(v({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);let n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){let{target:n}=t;return["modified","moving","resizing","rotating","scaling","skewing","changed","modifyPoly"].map(r=>e.on(r,s=>this.performLayout(r==="modified"?{type:"object_modified",trigger:r,e:s,target:n}:{type:"object_modifying",trigger:r,e:s,target:n})))}subscribe(e,t){this.unsubscribe(e,t);let n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){let{target:t,type:n}=e,{canvas:r}=t;if(n===En||n===nl?this.subscribeTargets(e):n===Hf&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),n===il&&e.deep){let s=ge(e,dT);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(v(v({},s),{},{bubbles:!1,target:o})))}}getLayoutResult(e){let{target:t}=e,n=e.strategy.calcLayoutResult(e,t.getObjects());if(!n)return;let r=e.type===En?new C:t.getRelativeCenterPoint(),{center:s,correction:o=new C,relativeCorrection:a=new C}=n,c=r.subtract(s).add(o).transform(e.type===En?Je:gt(t.calcOwnMatrix()),!0).add(a);return{result:n,prevCenter:r,nextCenter:s,offset:c}}commitLayout(e,t){let{target:n}=e,{result:{size:r},nextCenter:s}=t;var o,a;n.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===En?n.set({left:(o=e.x)!==null&&o!==void 0?o:s.x+r.x*Ae(n.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+r.y*Ae(n.originY)}):(n.setPositionByOrigin(s,U,U),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){let{target:n}=e;n.forEachObject(r=>{r.group===n&&this.layoutObject(e,t,r)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:r}=t;n.set({left:n.left+r.x,top:n.top+r.y})}onAfterLayout(e,t){let{target:n,strategy:r,bubbles:s,prevStrategy:o}=e,a=ge(e,hT),{canvas:c}=n;n.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:n});let l=n.parent;s&&l!=null&&l.layoutManager&&((a.path||(a.path=[])).push(n),l.layoutManager.performLayout(v(v({},a),{},{target:l}))),n.set("dirty",!0)}dispose(){this._subscriptions.forEach(e=>e.forEach(t=>t())),this._subscriptions.clear()}toObject(){return{type:U_,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};I.setClass(rr,U_);var fT=["type","objects","layoutManager"],gf=class extends rr{performLayout(){}},an=class i extends Yy(Fe){static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),m(this,"_activeObjects",[]),m(this,"__objectSelectionTracker",void 0),m(this,"__objectSelectionDisposer",void 0),Object.assign(this,i.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(r=>{this.enterGroup(r,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new rr,this.layoutManager.performLayout({type:En,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(ti("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(ti("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,r)=>this.canEnterGroup(t)&&r.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...r);return this._onAfterObjectsChange(nl,r),s}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let s=this._filterObjectsBeforeEnteringGroup(n),o=super.insertAt(e,...s);return this._onAfterObjectsChange(nl,s),o}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(Hf,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){let n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t,r=this._activeObjects;if(e)r.push(n),this._set("dirty",!0);else if(r.length>0){let s=r.indexOf(n);s>-1&&(r.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&ys(e,xe(gt(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(ys(e,xe(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){let e=Fe.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e){this._renderBackground(e);for(let n=0;n<this._objects.length;n++){var t;(t=this.canvas)!==null&&t!==void 0&&t.preserveObjectStacking&&this._objects[n].group!==this?(e.save(),e.transform(...gt(this.calcTransformMatrix())),this._objects[n].render(e),e.restore()):this._objects[n].group===this&&this._objects[n].render(e)}this._drawClipPath(e,this.clipPath)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(v({target:this,type:il},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){let n=this.includeDefaultValues;return this._objects.filter(function(r){return!r.excludeFromExport}).map(function(r){let s=r.includeDefaultValues;r.includeDefaultValues=n;let o=r[e||"toObject"](t);return r.includeDefaultValues=s,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.layoutManager.toObject();return v(v(v({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let t=Sn.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';let r=t.join("");return e?e(r):r}_toSVG(e){let t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){let t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:r=[],layoutManager:s}=e,o=ge(e,fT);return Promise.all([vs(r,t),jo(o,t)]).then(a=>{let[c,l]=a,u=new this(c,v(v(v({},o),l),{},{layoutManager:new gf}));if(s){let d=I.getClass(s.type),h=I.getClass(s.strategy);u.layoutManager=new d(new h)}else u.layoutManager=new rr;return u.layoutManager.subscribeTargets({type:En,target:u,targets:u.getObjects()}),u.setCoords(),u})}};m(an,"type","Group"),m(an,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),I.setClass(an);var G_=(i,e)=>Math.min(e.width/i.width,e.height/i.height),z_=(i,e)=>Math.max(e.width/i.width,e.height/i.height),Vy,he="(".concat(rn,")"),pT="(M) (?:".concat(he," ").concat(he," ?)+"),gT="(L) (?:".concat(he," ").concat(he," ?)+"),mT="(H) (?:".concat(he," ?)+"),vT="(V) (?:".concat(he," ?)+"),yT=String.raw(Vy||(Vy=ln(["(Z)s*"],["(Z)\\s*"]))),_T="(C) (?:".concat(he," ").concat(he," ").concat(he," ").concat(he," ").concat(he," ").concat(he," ?)+"),CT="(S) (?:".concat(he," ").concat(he," ").concat(he," ").concat(he," ?)+"),wT="(Q) (?:".concat(he," ").concat(he," ").concat(he," ").concat(he," ?)+"),bT="(T) (?:".concat(he," ").concat(he," ?)+"),DT="(A) (?:".concat(he," ").concat(he," ").concat(he," ([01]) ?([01]) ").concat(he," ").concat(he," ?)+"),$_="(?:(?:".concat(pT,")")+"|(?:".concat(gT,")")+"|(?:".concat(mT,")")+"|(?:".concat(vT,")")+"|(?:".concat(yT,")")+"|(?:".concat(_T,")")+"|(?:".concat(CT,")")+"|(?:".concat(wT,")")+"|(?:".concat(bT,")")+"|(?:".concat(DT,"))"),ST={m:"l",M:"L"},xT=(i,e,t,n,r,s,o,a,c,l,u)=>{let d=Ht(i),h=Ut(i),f=Ht(e),p=Ut(e),g=t*r*f-n*s*p+o,y=n*r*f+t*s*p+a;return["C",l+c*(-t*r*h-n*s*d),u+c*(-n*r*h+t*s*d),g+c*(t*r*p+n*s*f),y+c*(n*r*p-t*s*f),g,y]},By=(i,e,t,n)=>{let r=Math.atan2(e,i),s=Math.atan2(n,t);return s>=r?s-r:2*Math.PI-(r-s)};function mf(i,e,t,n,r,s,o,a){let c;if(q.cachesBoundsOfCurve&&(c=[...arguments].join(),So.boundsOfCurveCache[c]))return So.boundsOfCurveCache[c];let l=Math.sqrt,u=Math.abs,d=[],h=[[0,0],[0,0]],f=6*i-12*t+6*r,p=-3*i+9*t-9*r+3*o,g=3*t-3*i;for(let E=0;E<2;++E){if(E>0&&(f=6*e-12*n+6*s,p=-3*e+9*n-9*s+3*a,g=3*n-3*e),u(p)<1e-12){if(u(f)<1e-12)continue;let le=-g/f;0<le&&le<1&&d.push(le);continue}let A=f*f-4*g*p;if(A<0)continue;let O=l(A),R=(-f+O)/(2*p);0<R&&R<1&&d.push(R);let M=(-f-O)/(2*p);0<M&&M<1&&d.push(M)}let y=d.length,_=y,b=Y_(i,e,t,n,r,s,o,a);for(;y--;){let{x:E,y:A}=b(d[y]);h[0][y]=E,h[1][y]=A}h[0][_]=i,h[1][_]=e,h[0][_+1]=o,h[1][_+1]=a;let S=[new C(Math.min(...h[0]),Math.min(...h[1])),new C(Math.max(...h[0]),Math.max(...h[1]))];return q.cachesBoundsOfCurve&&(So.boundsOfCurveCache[c]=S),S}var ET=(i,e,t)=>{let[n,r,s,o,a,c,l,u]=t,d=((h,f,p,g,y,_,b)=>{if(p===0||g===0)return[];let S=0,E=0,A=0,O=Math.PI,R=b*Ef,M=Ut(R),le=Ht(R),me=.5*(-le*h-M*f),Le=.5*(-le*f+M*h),Oe=p**2,ue=g**2,Ie=Le**2,Mt=me**2,mt=Oe*ue-Oe*Ie-ue*Mt,dn=Math.abs(p),hn=Math.abs(g);if(mt<0){let Pn=Math.sqrt(1-mt/(Oe*ue));dn*=Pn,hn*=Pn}else A=(y===_?-1:1)*Math.sqrt(mt/(Oe*Ie+ue*Mt));let ai=A*dn*Le/hn,ci=-A*hn*me/dn,Ho=le*ai-M*ci+.5*h,Dl=M*ai+le*ci+.5*f,xs=By(1,0,(me-ai)/dn,(Le-ci)/hn),kn=By((me-ai)/dn,(Le-ci)/hn,(-me-ai)/dn,(-Le-ci)/hn);_===0&&kn>0?kn-=2*O:_===1&&kn<0&&(kn+=2*O);let Es=Math.ceil(Math.abs(kn/O*2)),li=new Array(Es),Is=kn/Es,EC=8/3*Math.sin(Is/4)*Math.sin(Is/4)/Math.sin(Is/2),Sl=xs+Is;for(let Pn=0;Pn<Es;Pn++)li[Pn]=xT(xs,Sl,le,M,dn,hn,Ho,Dl,EC,S,E),S=li[Pn][5],E=li[Pn][6],xs=Sl,Sl+=Is;return li})(l-i,u-e,r,s,a,c,o);for(let h=0,f=d.length;h<f;h++)d[h][1]+=i,d[h][2]+=e,d[h][3]+=i,d[h][4]+=e,d[h][5]+=i,d[h][6]+=e;return d},W_=i=>{let e=0,t=0,n=0,r=0,s=[],o,a=0,c=0;for(let l of i){let u=[...l],d;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],d=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],d=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],n=u[1],r=u[2],d=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],c=u[4],e=u[5],t=u[6],d=["C",u[1],u[2],a,c,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[3],t=u[4],d=["C",a,c,u[1],u[2],e,t],a=d[3],c=d[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],c=u[2],e=u[3],t=u[4],d=["Q",a,c,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[1],t=u[2],d=["Q",a,c,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":ET(e,t,u).forEach(h=>s.push(h)),e=u[6],t=u[7];break;case"z":case"Z":e=n,t=r,d=["Z"]}d?(s.push(d),o=d[0]):o=""}return s},rl=(i,e,t,n)=>Math.sqrt((t-i)**2+(n-e)**2),Y_=(i,e,t,n,r,s,o,a)=>c=>{let l=c**3,u=(f=>3*f**2*(1-f))(c),d=(f=>3*f*(1-f)**2)(c),h=(f=>(1-f)**3)(c);return new C(o*l+r*u+t*d+i*h,a*l+s*u+n*d+e*h)},q_=i=>i**2,X_=i=>2*i*(1-i),Z_=i=>(1-i)**2,IT=(i,e,t,n,r,s,o,a)=>c=>{let l=q_(c),u=X_(c),d=Z_(c),h=3*(d*(t-i)+u*(r-t)+l*(o-r)),f=3*(d*(n-e)+u*(s-n)+l*(a-s));return Math.atan2(f,h)},TT=(i,e,t,n,r,s)=>o=>{let a=q_(o),c=X_(o),l=Z_(o);return new C(r*a+t*c+i*l,s*a+n*c+e*l)},MT=(i,e,t,n,r,s)=>o=>{let a=1-o,c=2*(a*(t-i)+o*(r-t)),l=2*(a*(n-e)+o*(s-n));return Math.atan2(l,c)},Hy=(i,e,t)=>{let n=new C(e,t),r=0;for(let s=1;s<=100;s+=1){let o=i(s/100);r+=rl(n.x,n.y,o.x,o.y),n=o}return r},AT=(i,e)=>{let t,n=0,r=0,s={x:i.x,y:i.y},o=v({},s),a=.01,c=0,l=i.iterator,u=i.angleFinder;for(;r<e&&a>1e-4;)o=l(n),c=n,t=rl(s.x,s.y,o.x,o.y),t+r>e?(n-=a,a/=2):(s=o,n+=a,r+=t);return v(v({},o),{},{angle:u(c)})},Uf=i=>{let e,t,n=0,r=0,s=0,o=0,a=0,c=[];for(let l of i){let u={x:r,y:s,command:l[0],length:0};switch(l[0]){case"M":t=u,t.x=o=r=l[1],t.y=a=s=l[2];break;case"L":t=u,t.length=rl(r,s,l[1],l[2]),r=l[1],s=l[2];break;case"C":e=Y_(r,s,l[1],l[2],l[3],l[4],l[5],l[6]),t=u,t.iterator=e,t.angleFinder=IT(r,s,l[1],l[2],l[3],l[4],l[5],l[6]),t.length=Hy(e,r,s),r=l[5],s=l[6];break;case"Q":e=TT(r,s,l[1],l[2],l[3],l[4]),t=u,t.iterator=e,t.angleFinder=MT(r,s,l[1],l[2],l[3],l[4]),t.length=Hy(e,r,s),r=l[3],s=l[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=rl(r,s,o,a),r=o,s=a}n+=t.length,c.push(t)}return c.push({length:n,x:r,y:s}),c},K_=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Uf(i),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;let r=t[n],s=e/r.length,o=i[n];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return v(v({},new C(r.x,r.y).lerp(new C(r.destX,r.destY),s)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return v(v({},new C(r.x,r.y).lerp(new C(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return AT(r,e)}},OT=new RegExp($_,"gi"),kT=new RegExp($_,"i"),Q_=i=>{i=V_(i);let e=[];for(let[t]of i.matchAll(OT)){let n=[],r;do{if(r=kT.exec(t),!r)break;let s=r.filter(a=>a);s.shift();let o=s.map(a=>{let c=Number.parseFloat(a);return Number.isNaN(c)?a:c});if(n.push(o),s.length<=1)break;s.shift(),t=t.replace(new RegExp("".concat(s.join(" ?")," ?$")),"")}while(r);n.reverse().forEach((s,o)=>{let a=ST[s[0]];o>0&&(a=="l"||a=="L")&&(s[0]=a),e.push(s)})}return e},PT=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new C(i[0]),n=new C(i[1]),r=1,s=0,o=[],a=i.length,c=a>2,l;for(c&&(r=i[2].x<n.x?-1:i[2].x===n.x?0:1,s=i[2].y<n.y?-1:i[2].y===n.y?0:1),o.push(["M",t.x-r*e,t.y-s*e]),l=1;l<a;l++){if(!t.eq(n)){let u=t.midPointFrom(n);o.push(["Q",t.x,t.y,u.x,u.y])}t=i[l],l+1<i.length&&(n=i[l+1])}return c&&(r=t.x>i[l-2].x?1:t.x===i[l-2].x?0:-1,s=t.y>i[l-2].y?1:t.y===i[l-2].y?0:-1),o.push(["L",t.x+r*e,t.y+s*e]),o},J_=(i,e)=>i.map(t=>t.map((n,r)=>r===0||e===void 0?n:Z(n,e)).join(" ")).join(" ");function NT(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.onComplete||er,n=new(ul()).XMLHttpRequest,r=e.signal,s=function(){n.abort()},o=function(){r&&r.removeEventListener("abort",s),n.onerror=n.ontimeout=er};if(r&&r.aborted)throw new Hc("request");return r&&r.addEventListener("abort",s,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(o(),t(n),n.onreadystatechange=er)},n.onerror=n.ontimeout=o,n.open("get",i,!0),n.send(),n}var RT=(i,e)=>{let t=i._findCenterFromElement();i.transformMatrix&&((n=>{if(n.transformMatrix){let{scaleX:r,scaleY:s,angle:o,skewX:a}=ms(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set("scaleX",r),n.set("scaleY",s),n.angle=o,n.skewX=a,n.skewY=0}})(i),t=t.transform(i.transformMatrix)),delete i.transformMatrix,e&&(i.scaleX*=e.scaleX,i.scaleY*=e.scaleY,i.cropX=e.cropX,i.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,i.width=e.width,i.height=e.height),i.setPositionByOrigin(t,U,U)},eC=Object.freeze({__proto__:null,addTransformToObject:o_,animate:Rf,animateColor:g_,applyTransformToObject:ys,calcAngleBetweenVectors:Zc,calcDimensionsMatrix:Lo,calcPlaneChangeMatrix:Vo,calcVectorRotation:v_,cancelAnimFrame:qy,capValue:ir,composeMatrix:Jy,copyCanvasElement:i=>{var e;let t=Ee();return t.width=i.width,t.height=i.height,(e=t.getContext("2d"))===null||e===void 0||e.drawImage(i,0,0),t},cos:Ht,createCanvasElement:Ee,createImage:Xy,createRotateMatrix:Ss,createScaleMatrix:hl,createSkewXMatrix:Of,createSkewYMatrix:kf,createTranslateMatrix:Ds,createVector:qc,crossProduct:ps,degreesToRadians:be,dotProduct:y_,ease:II,enlivenObjectEnlivables:jo,enlivenObjects:vs,findScaleToCover:z_,findScaleToFit:G_,getBoundsOfCurve:mf,getOrthonormalVector:Lf,getPathSegmentsInfo:Uf,getPointOnPath:K_,getPointer:s_,getRandomInt:wI,getRegularPolygonPath:(i,e)=>{let t=2*Math.PI/i,n=-ni;i%2==0&&(n+=t/2);let r=new Array(i+1);for(let s=0;s<i;s++){let o=s*t+n,{x:a,y:c}=new C(Ht(o),Ut(o)).scalarMultiply(e);r[s]=[s===0?"M":"L",a,c]}return r[i]=["Z"],r},getSmoothPathFromPoints:PT,getSvgAttributes:i=>{let e=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:gl,groupSVGElements:(i,e)=>i&&i.length===1?i[0]:new an(i,e),hasStyleChanged:_l,invertTransform:gt,isBetweenVectors:of,isIdentityMatrix:Zy,isTouchEvent:$c,isTransparent:N_,joinPath:J_,loadImage:Eo,magnitude:Xc,makeBoundingBoxFromPoints:on,makePathSimpler:W_,matrixToSVG:Oo,mergeClipPaths:(i,e)=>{var t;let n=i,r=e;n.inverted&&!r.inverted&&(n=e,r=i),ef(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());let s=n.inverted&&r.inverted;return s&&(n.inverted=r.inverted=!1),new an([n],{clipPath:r,inverted:s})},multiplyTransformMatrices:xe,multiplyTransformMatrixArray:dl,parsePath:Q_,parsePreserveAspectRatioAttribute:e_,parseUnit:tr,pick:sr,projectStrokeOnPoints:R_,qrDecompose:ms,radiansToDegrees:ri,removeFromArray:Fi,removeTransformFromObject:(i,e)=>{let t=gt(e),n=xe(t,i.calcOwnMatrix());ys(i,n)},removeTransformMatrixForSvgParsing:RT,request:NT,requestAnimFrame:xo,resetObjectTransform:a_,rotatePoint:(i,e,t)=>i.rotate(t,e),rotateVector:Ff,saveObjectTransform:Nf,sendObjectToPlane:ef,sendPointToPlane:ei,sendVectorToPlane:c_,setStyle:Io,sin:Ut,sizeAfterTransform:fl,string:$I,stylesFromArray:j_,stylesToArray:L_,toDataURL:Af,toFixed:Z,transformPath:(i,e,t)=>(t&&(e=xe(e,[1,0,0,1,-t.x,-t.y])),i.map(n=>{let r=[...n];for(let s=1;s<n.length-1;s+=2){let{x:o,y:a}=qe({x:n[s],y:n[s+1]},e);r[s]=o,r[s+1]=a}return r})),transformPoint:qe}),vf=class extends zc{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),m(this,"upper",void 0),m(this,"container",void 0);let{el:r}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t});let o=this.createContainerElement();o.classList.add(n),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,s),this.container=o}createUpperCanvas(){let{el:e}=this.lower,t=Ee();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){let e=bs().createElement("div");return e.setAttribute("data-fabric","wrapper"),Io(e,{position:"relative"}),by(e),e}applyCanvasStyle(e,t){let{allowTouchScrolling:n}=t;Io(e,{position:"absolute",left:"0",top:"0"}),function(r,s){let o=s?"manipulation":at;Io(r,{"touch-action":o,"-ms-touch-action":o})}(e,n),by(e)}setDimensions(e,t){super.setDimensions(e,t);let{el:n,ctx:r}=this.upper;r_(n,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),Qh(this.upper.el,e),Qh(this.container,e)}cleanupDOM(e){let t=this.container,{el:n}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),cn().dispose(this.upper.el),delete this.upper,delete this.container}},sl=class i extends Po{constructor(){super(...arguments),m(this,"targets",[]),m(this,"_hoveredTargets",[]),m(this,"_objectsToRender",void 0),m(this,"_currentTransform",null),m(this,"_groupSelector",null),m(this,"contextTopDirty",!1)}static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new vf(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){let r=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+r,-n+r),s.transform(...this.viewportTransform);let o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=o,s.restore();let a=Math.round(r*this.getRetinaScaling());return N_(s,a,a,a)}_isSelectionKeyPressed(e){let t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){let n=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&n.length>1&&n.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let r;return t==="scale"||t==="scaleX"||t==="scaleY"||t==="resizing"?r=this.centeredScaling||e.centeredScaling:t==="rotate"&&(r=this.centeredRotation||e.centeredRotation),r?!n:n}_getOriginFromCorner(e,t){let n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=Se:["mr","tr","br"].includes(t)&&(n.x=Q),["tl","mt","tr"].includes(t)?n.y=Zh:["bl","mb","br"].includes(t)&&(n.y=Xe)),n}_setupCurrentTransform(e,t,n){var r;let s=t.group?ei(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},c=n&&a?(r=a.getActionHandler(e,t,a))===null||r===void 0?void 0:r.bind(a):f_,l=((f,p,g,y)=>{if(!p||!f)return"drag";let _=y.controls[p];return _.getActionName(g,_,y)})(n,o,e,t),u=e[this.centeredKey],d=this._shouldCenterTransform(t,l,u)?{x:U,y:U}:this._getOriginFromCorner(t,o),h={target:t,action:l,actionHandler:c,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:d.x,originY:d.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:be(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:v(v({},Nf(t)),{},{originX:d.x,originY:d.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:t,y:n,deltaX:r,deltaY:s}=this._groupSelector,o=new C(t,n).transform(this.viewportTransform),a=new C(t+r,n+s).transform(this.viewportTransform),c=this.selectionLineWidth/2,l=Math.min(o.x,a.x),u=Math.min(o.y,a.y),d=Math.max(o.x,a.x),h=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(l,u,d-l,h-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,l+=c,u+=c,d-=c,h-=c,Fe.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(l,u,d-l,h-u))}findTarget(e){if(this.skipTargetFind)return;let t=this.getViewportPoint(e),n=this._activeObject,r=this.getActiveObjects();if(this.targets=[],n&&r.length>=1){if(n.findControl(t,$c(e))||r.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){let s=this.targets;this.targets=[];let o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==n?(this.targets=s,n):o}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords(),r=this.getZoom(),s=e.padding/r;if(s){let[o,a,c,l]=n,u=Math.atan2(a.y-o.y,a.x-o.x),d=Ht(u)*s,h=Ut(u)*s,f=d+h,p=d-h;n=[new C(o.x-p,o.y-f),new C(a.x+f,a.y-p),new C(c.x+p,c.y+f),new C(l.x-f,l.y+p)]}return nr.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ei(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){let r=e[n];if(this._checkTarget(r,t)){if(Vc(r)&&r.subTargetCheck){let s=this._searchPossibleTargets(r._objects,t);s&&this.targets.push(s)}return r}}}searchPossibleTargets(e,t){let n=this._searchPossibleTargets(e,t);if(n&&Vc(n)&&n.interactive&&this.targets[0]){let r=this.targets;for(let s=r.length-1;s>0;s--){let o=r[s];if(!Vc(o)||!o.interactive)return o}return r[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=this.upperCanvasEl,r=n.getBoundingClientRect(),s=s_(e),o=r.width||0,a=r.height||0;o&&a||(Xe in r&&Zh in r&&(a=Math.abs(r.top-r.bottom)),Se in r&&Q in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=ei(s,void 0,this.viewportTransform));let c=this.getRetinaScaling();c!==1&&(s.x/=c,s.y/=c);let l=o===0||a===0?new C(1,1):new C(n.width/o,n.height/a);return s.multiply(l)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Ee(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let e=this._activeObject;return as(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,r=!1,s=this.getActiveObjects(),o=[],a=[];e.forEach(c=>{s.includes(c)||(n=!0,c.fire("deselected",{e:t,target:c}),a.push(c))}),s.forEach(c=>{e.includes(c)||(n=!0,c.fire("selected",{e:t,target:c}),o.push(c))}),e.length>0&&s.length>0?(r=!0,n&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):s.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:a})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){let n=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),r}_setActiveObject(e,t){let n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,as(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){let n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),this._activeObject=void 0,!0)}discardActiveObject(e){let t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});let r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){let t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let t=this._currentTransform,n=t.target,r={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),n.fire("modified",r))}setViewportTransform(e){super.setViewportTransform(e);let t=this._activeObject;t&&t.setCoords()}destroy(){let e=this._activeObject;as(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){let r=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,n);return e.set(r),s}_realizeGroupTransformOnObject(e){let{group:t}=e;if(t&&as(t)&&this._activeObject===t){let n=sr(e,["angle","flipX","flipY",Q,"scaleX","scaleY","skewX","skewY",Xe]);return o_(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){let r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(r)}};m(sl,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});var yf=class{constructor(e){m(this,"targets",[]),m(this,"__disposer",void 0);let t=()=>{let{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Fi(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},FT=["target","oldTarget","fireCanvas","e"],pt={passive:!1},ss=(i,e)=>{let t=i.getViewportPoint(e),n=i.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},Kn=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.addEventListener(...t)},xt=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.removeEventListener(...t)},LT={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},Cs=class extends sl{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),m(this,"_isClick",void 0),m(this,"textEditingManager",new yf(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Kn,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){let n=this.upperCanvasEl,r=this._getEventPrefix();e(i_(n),"resize",this._onResize),e(n,r+"down",this._onMouseDown),e(n,"".concat(r,"move"),this._onMouseMove,pt),e(n,"".concat(r,"out"),this._onMouseOut),e(n,"".concat(r,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,pt)}removeListeners(){this.addOrRemove(xt,"remove");let e=this._getEventPrefix(),t=Vt(this.upperCanvasEl);xt(t,"".concat(e,"up"),this._onMouseUp),xt(t,"touchend",this._onTouchEnd,pt),xt(t,"".concat(e,"move"),this._onMouseMove,pt),xt(t,"touchmove",this._onMouseMove,pt)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){let t=this._hoveredTarget,n=v({e},ss(this,e));this.fire("mouse:out",v(v({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",v({},n)),this._hoveredTargets.forEach(r=>{this.fire("mouse:out",v(v({},n),{},{target:r})),r&&r.fire("mouseout",v({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",v({e},ss(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;let n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void Kn(this.upperCanvasEl,"drag",this._onDragProgress)}Jh(e)}_renderDragEffects(e,t,n){let r=!1,s=this._dropTarget;s&&s!==t&&s!==n&&(s.clearContextTop(),r=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();let o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),n&&(o.save(),n.transform(o),n.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){let t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==at,n=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};xt(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){let t="dragover",{target:n,targets:r}=this.findDragTargets(e),s=this._dragSource,o={e,target:n,subTargets:r,dragSource:s,canDrop:!1,dropTarget:void 0},a;this.fire(t,o),this._fireEnterLeaveEvents(n,o),n&&(n.canDrop(e)&&(a=n),n.fire(t,o));for(let c=0;c<r.length;c++){let l=r[c];l.canDrop(e)&&(a=l),l.fire(t,o)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){let{target:t,targets:n}=this.findDragTargets(e),r={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){let t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){let{target:t,targets:n}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",v({e,target:t,subTargets:n,dragSource:this._dragSource},ss(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){let t=this.findTarget(e),n=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&Jh(e),this._basicEventHandler("contextmenu",r),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){let t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){e.preventDefault(),this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix(),r=Vt(t);Kn(r,"touchend",this._onTouchEnd,pt),Kn(r,"touchmove",this._onMouseMove,pt),xt(t,"".concat(n,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix();xt(t,"".concat(n,"move"),this._onMouseMove,pt);let r=Vt(t);Kn(r,"".concat(n,"up"),this._onMouseUp),Kn(r,"".concat(n,"move"),this._onMouseMove,pt)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let t=this._getEventPrefix(),n=Vt(this.upperCanvasEl);xt(n,"touchend",this._onTouchEnd,pt),xt(n,"touchmove",this._onMouseMove,pt),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Kn(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){let r=Vt(this.upperCanvasEl);xt(r,"".concat(n,"up"),this._onMouseUp),xt(r,"".concat(n,"move"),this._onMouseMove,pt),Kn(t,"".concat(n,"move"),this._onMouseMove,pt)}}_onMouseMove(e){let t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");let n=this._currentTransform,r=this._isClick,s=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,c,l=!1;if(n&&(this._finalizeCurrentTransform(e),l=n.actionPerformed),!r){let u=s===this._activeObject;this.handleSelection(e),l||(l=this._shouldRender(s)||!u&&s===this._activeObject)}if(s){let u=s.findControl(this.getViewportPoint(e),$c(e)),{key:d,control:h}=u||{};if(c=d,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),l=!0;else if(h){let f=h.getMouseUpHandler(e,s,h);f&&(a=this.getScenePoint(e),f.call(h,e,n,a.x,a.y))}s.isMoving=!1}if(n&&(n.target!==s||n.corner!==c)){let u=n.target&&n.target.controls[n.corner],d=u&&u.getMouseUpHandler(e,n.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,n,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),l?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){let{target:n,subTargets:r=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let s=0;s<r.length;s++)r[s]!==n&&r[s].fire(e,t);return t}_handleEvent(e,t){let n=this._target,r=this.targets||[],s=v(v({e,target:n,subTargets:r},ss(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),s),n&&n.fire("mouse".concat(t),s);for(let o=0;o<r.length;o++)r[o]!==n&&r[o].fire("mouse".concat(t),s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let r=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,r=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){let o=this.getScenePoint(e);this._groupSelector={x:o.x,y:o.y,deltaY:0,deltaX:0}}if(t){let o=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);let a=t.findControl(this.getViewportPoint(e),$c(e));if(t===this._activeObject&&(a||!s)){this._setupCurrentTransform(e,t,o);let c=a?a.control:void 0,l=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,t,c);u&&u.call(c,e,this._currentTransform,l.x,l.y)}}r&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),r&&this.requestRenderAll()}_resetTransformEventData(){this._target=void 0,this._pointer=void 0,this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ei(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let t=this._groupSelector;if(t){let n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){let n=this._hoveredTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:r[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){let n=this._draggedoverTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("drag",v(v({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",v(v({},t),{},{target:s[a],oldTarget:r[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:r,fireCanvas:s,e:o}=t,a=ge(t,FT),{targetIn:c,targetOut:l,canvasIn:u,canvasOut:d}=LT[e],h=r!==n;if(r&&h){let f=v(v({},a),{},{e:o,target:r,nextTarget:n},ss(this,o));s&&this.fire(d,f),r.fire(l,f)}if(n&&h){let f=v(v({},a),{},{e:o,target:n,previousTarget:r},ss(this,o));s&&this.fire(u,f),n.fire(c,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){let t=this.getScenePoint(e),n=this._currentTransform,r=n.target,s=r.group?ei(t,void 0,r.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,s),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){let{action:r,actionHandler:s,target:o}=t,a=!!s&&s(e,t,n.x,n.y);a&&o.setCoords(),r==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor,r=as(this._activeObject)?this._activeObject:null,s=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(s){let o=s.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{n=o.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){let n=this._activeObject,r=as(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||r)&&(r||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(r){let s=n.getObjects();if(t===n){let o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{n.exitEditing&&n.exitEditing();let s=new(I.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(n,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:t,y:n,deltaX:r,deltaY:s}=this._groupSelector,o=new C(t,n),a=o.add(new C(r,s)),c=o.min(a),l=o.max(a).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:l.x,height:l.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(h=>!h.onSelect({e})).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){let h=I.getClass("ActiveSelection");this.setActiveObject(new h(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},tC={x1:0,y1:0,x2:0,y2:0},jT=v(v({},tC),{},{r1:0,r2:0}),VT=/^(\d+\.\d+)%|(\d+)%$/;function nC(i){return i&&VT.test(i)}function iC(i,e){let t=typeof i=="number"?i:typeof i=="string"?parseFloat(i)/(nC(i)?100:1):NaN;return ir(0,os(t,e),1)}var BT=/\s*;\s*/,HT=/\s*:\s*/;function UT(i,e){let t,n,r=i.getAttribute("style");if(r){let o=r.split(BT);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){let[c,l]=o[a].split(HT).map(u=>u.trim());c==="stop-color"?t=l:c==="stop-opacity"&&(n=l)}}let s=new et(t||i.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:iC(i.getAttribute("offset"),0),color:s.toRgb(),opacity:os(parseFloat(n||i.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function GT(i,e){let t=[],n=i.getElementsByTagName("stop"),r=iC(e,1);for(let s=n.length;s--;)t.push(UT(n[s],r));return t}function rC(i){return i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?"linear":"radial"}function sC(i){return i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function jt(i,e){return i.getAttribute(e)}function zT(i,e){return function(t,n){let r,{width:s,height:o,gradientUnits:a}=n;return Object.keys(t).reduce((c,l)=>{let u=t[l];return u==="Infinity"?r=1:u==="-Infinity"?r=0:(r=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&nC(u)&&(r*=.01,a==="pixels"&&(l!=="x1"&&l!=="x2"&&l!=="r2"||(r*=s),l!=="y1"&&l!=="y2"||(r*=o)))),c[l]=r,c},{})}(rC(i)==="linear"?function(t){return{x1:jt(t,"x1")||0,y1:jt(t,"y1")||0,x2:jt(t,"x2")||"100%",y2:jt(t,"y2")||0}}(i):function(t){return{x1:jt(t,"fx")||jt(t,"cx")||"50%",y1:jt(t,"fy")||jt(t,"cy")||"50%",r1:0,x2:jt(t,"cx")||"50%",y2:jt(t,"cy")||"50%",r2:jt(t,"r")||"50%"}}(i),v(v({},e),{},{gradientUnits:sC(i)}))}var ls=class{constructor(e){let{type:t="linear",gradientUnits:n="pixels",coords:r={},colorStops:s=[],offsetX:o=0,offsetY:a=0,gradientTransform:c,id:l}=e;this.id=l?"".concat(l,"_").concat(ii()):ii(),this.type=t,this.gradientUnits=n,this.gradientTransform=c,this.offsetX=o,this.offsetY=a,this.coords=v(v({},this.type==="radial"?jT:tC),r),this.colorStops=s.slice()}addColorStop(e){for(let t in e){let n=new et(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return v(v({},sr(this,e)),{},{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],r=this.gradientTransform?this.gradientTransform.concat():Je.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(d=>v({},d)).sort((d,h)=>d.offset-h.offset),a=-this.offsetX,c=-this.offsetY;var l;s==="objectBoundingBox"?(a/=e.width,c/=e.height):(a+=e.width/2,c+=e.height/2),(l=e)&&typeof l._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=a,r[5]-=c;let u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Oo(r),'"'),""].join(" ");if(this.type==="linear"){let{x1:d,y1:h,x2:f,y2:p}=this.coords;n.push("<linearGradient ",u,' x1="',d,'" y1="',h,'" x2="',f,'" y2="',p,`">
`)}else if(this.type==="radial"){let{x1:d,y1:h,x2:f,y2:p,r1:g,r2:y}=this.coords,_=g>y;n.push("<radialGradient ",u,' cx="',_?d:f,'" cy="',_?h:p,'" r="',_?g:y,'" fx="',_?f:d,'" fy="',_?p:h,`">
`),_&&(o.reverse(),o.forEach(S=>{S.offset=1-S.offset}));let b=Math.min(g,y);if(b>0){let S=b/Math.max(g,y);o.forEach(E=>{E.offset+=S*(1-E.offset)})}}return o.forEach(d=>{let{color:h,offset:f,opacity:p}=d;n.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',h,p!==void 0?";stop-opacity: "+p:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){let t=this.coords,n=this.type==="linear"?e.createLinearGradient(t.x1,t.y1,t.x2,t.y2):e.createRadialGradient(t.x1,t.y1,t.r1,t.x2,t.y2,t.r2);return this.colorStops.forEach(r=>{let{color:s,opacity:o,offset:a}=r;n.addColorStop(a,o!==void 0?new et(s).setAlpha(o).toRgba():s)}),n}static async fromObject(e){return new this(e)}static fromElement(e,t,n){let r=sC(e),s=t._findCenterFromElement();return new this(v({id:e.getAttribute("id")||void 0,type:rC(e),coords:zT(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:GT(e,n.opacity),gradientUnits:r,gradientTransform:pf(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}};m(ls,"type","Gradient"),I.setClass(ls,"gradient"),I.setClass(ls,"linear"),I.setClass(ls,"radial");var $T=["type","source"],To=class{get type(){return"pattern"}set type(e){ti("warn","Setting type has no effect",e)}constructor(e){m(this,"repeat","repeat"),m(this,"offsetX",0),m(this,"offsetY",0),m(this,"crossOrigin",""),m(this,"patternTransform",null),this.id=ii(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:t,crossOrigin:n}=this;return v(v({},sr(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:Z(this.offsetX,q.NUM_FRACTION_DIGITS),offsetY:Z(this.offsetY,q.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e,{source:r,repeat:s,id:o}=this,a=os(this.offsetX/t,0),c=os(this.offsetY/n,0),l=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):os(r.width/t,0),u=s==="repeat-x"||s==="no-repeat"?1+Math.abs(c||0):os(r.height/n,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(c,'" width="').concat(l,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:r}=e,s=ge(e,$T),o=await Eo(r,v(v({},t),{},{crossOrigin:s.crossOrigin}));return new this(v(v({},s),{},{source:o}))}};m(To,"type","Pattern"),I.setClass(To),I.setClass(To,"pattern");var WT=["path","left","top"],YT=["d"],xn=class i extends Fe{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:r,top:s}=t,o=ge(t,WT);super(),Object.assign(this,i.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof r=="number"&&this.set(Q,r),typeof s=="number"&&this.set(Xe,s)}_setPath(e,t){this.path=W_(Array.isArray(e)?e:Q_(e)),this.setBoundingBox(t)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new C(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(let r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+n);break;case"M":e.moveTo(r[1]+t,r[2]+n);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n,r[5]+t,r[6]+n);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){let e=J_(this.path,q.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){let e=q.NUM_FRACTION_DIGITS;return" translate(".concat(Z(-this.pathOffset.x,e),", ").concat(Z(-this.pathOffset.y,e),")")}toClipPathSVG(e){let t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){let t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:t,height:n,pathOffset:r}=this._calcDimensions();this.set({width:t,height:n,pathOffset:r}),e&&this.setPositionByOrigin(r,U,U)}_calcBoundsFromPath(){let e=[],t=0,n=0,r=0,s=0;for(let o of this.path)switch(o[0]){case"L":r=o[1],s=o[2],e.push(new C(t,n),new C(r,s));break;case"M":r=o[1],s=o[2],t=r,n=s;break;case"C":e.push(...mf(r,s,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],s=o[6];break;case"Q":e.push(...mf(r,s,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],s=o[4];break;case"Z":r=t,s=n}return on(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return v(v({},e),{},{pathOffset:new C(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){let r=On(e,this.ATTRIBUTE_NAMES,n),{d:s}=r;return new this(s,v(v(v({},ge(r,YT)),t),{},{left:void 0,top:void 0}))}};m(xn,"type","Path"),m(xn,"cacheProperties",[...An,"path","fillRule"]),m(xn,"ATTRIBUTE_NAMES",[...oi,"d"]),I.setClass(xn),I.setSVGClass(xn);var qT=["left","top","radius"],oC=["radius","startAngle","endAngle","counterClockwise"],Qn=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,be(this.startAngle),be(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get("scaleX")}getRadiusY(){return this.get("radius")*this.get("scaleY")}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...oC,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{let{radius:t}=this,n=be(this.startAngle),r=be(this.endAngle),s=Ht(n)*t,o=Ut(n)*t,a=Ht(r)*t,c=Ut(r)*t,l=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(l," ").concat(u," ").concat(a," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){let r=On(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,radius:a=0}=r;return new this(v(v({},ge(r,qT)),{},{radius:a,left:s-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}};m(Qn,"type","Circle"),m(Qn,"cacheProperties",[...An,...oC]),m(Qn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),m(Qn,"ATTRIBUTE_NAMES",["cx","cy","r",...oi]),I.setClass(Qn),I.setSVGClass(Qn);var XT=["x1","y1","x2","y2"],ZT=["x1","y1","x2","y2"],_f=["x1","x2","y1","y2"],Li=class i extends Fe{constructor(){let[e,t,n,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,i.ownDefaults),this.setOptions(s),this.x1=e,this.x2=n,this.y1=t,this.y2=r,this._setWidthHeight();let{left:o,top:a}=s;typeof o=="number"&&this.set(Q,o),typeof a=="number"&&this.set(Xe,a)}_setWidthHeight(){let{x1:e,y1:t,x2:n,y2:r}=this;this.width=Math.abs(n-e),this.height=Math.abs(r-t);let{left:s,top:o,width:a,height:c}=on([{x:e,y:t},{x:n,y:r}]),l=new C(s+a/2,o+c/2);this.setPositionByOrigin(l,U,U)}_set(e,t){return super._set(e,t),_f.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;let n=e.strokeStyle;var r;It(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new C((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:t,y1:n,y2:r,width:s,height:o}=this,a=e<=t?-1:1,c=n<=r?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:c*o/2,y2:c*-o/2}}_toSVG(){let{x1:e,x2:t,y1:n,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static async fromElement(e,t,n){let r=On(e,this.ATTRIBUTE_NAMES,n),{x1:s=0,y1:o=0,x2:a=0,y2:c=0}=r;return new this([s,o,a,c],ge(r,XT))}static fromObject(e){let{x1:t,y1:n,x2:r,y2:s}=e,o=ge(e,ZT);return this._fromObject(v(v({},o),{},{points:[t,n,r,s]}),{extraParam:"points"})}};m(Li,"type","Line"),m(Li,"cacheProperties",[...An,..._f]),m(Li,"ATTRIBUTE_NAMES",oi.concat(_f)),I.setClass(Li),I.setSVGClass(Li);var us=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_render(e){let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}};m(us,"type","Triangle"),m(us,"ownDefaults",{width:100,height:100}),I.setClass(us),I.setSVGClass(us);var aC=["rx","ry"],Jn=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e){super(),Object.assign(this,i.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get("scaleX")}getRy(){return this.get("ry")*this.get("scaleY")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...aC,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Mn,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){let r=On(e,this.ATTRIBUTE_NAMES,n);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}};function KT(i){if(!i)return[];let e=i.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}m(Jn,"type","Ellipse"),m(Jn,"cacheProperties",[...An,...aC]),m(Jn,"ownDefaults",{rx:0,ry:0}),m(Jn,"ATTRIBUTE_NAMES",[...oi,"cx","cy","rx","ry"]),I.setClass(Jn),I.setSVGClass(Jn);var QT=["left","top"],cC={exactBoundingBox:!1},tn=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),m(this,"strokeDiff",void 0),Object.assign(this,i.ownDefaults),this.setOptions(t),this.points=e;let{left:n,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Q,n),typeof r=="number"&&this.set(Xe,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return R_(this.points,e,this.isOpen())}_calcDimensions(e){e=v({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(l=>l.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new C,strokeOffset:new C,strokeDiff:new C};let n=on(t),r=Lo(v(v({},e),{},{scaleX:1,scaleY:1})),s=on(this.points.map(l=>qe(l,r,!0))),o=new C(this.scaleX,this.scaleY),a=n.left+n.width/2,c=n.top+n.height/2;return this.exactBoundingBox&&(a-=c*Math.tan(be(this.skewX)),c-=a*Math.tan(be(this.skewY))),v(v({},n),{},{pathOffset:new C(a,c),strokeOffset:new C(s.left,s.top).subtract(new C(n.left,n.top)).multiply(o),strokeDiff:new C(n.width,n.height).subtract(new C(s.width,s.height)).multiply(o)})}_findCenterFromElement(){let e=on(this.points);return new C(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:t,top:n,width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}),e&&this.setPositionByOrigin(new C(t+r/2,n+s/2),U,U)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new C(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,n;let{width:a,height:c}=this._calcDimensions(e);o=new C((t=e.width)!==null&&t!==void 0?t:a,(n=e.height)!==null&&n!==void 0?n:c)}else{var r,s;o=new C((r=e.width)!==null&&r!==void 0?r:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new C(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){let n=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&n&&((e==="scaleX"||e==="scaleY")&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject(e)),{},{points:Bo(this.points)})}_toSVG(){let e=[],t=this.pathOffset.x,n=this.pathOffset.y,r=q.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)e.push(Z(this.points[s].x-t,r),",",Z(this.points[s].y-n,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){let t=this.points.length,n=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-r);for(let s=0;s<t;s++){let o=this.points[s];e.lineTo(o.x-n,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(KT(e.getAttribute("points")),v(v({},ge(On(e,this.ATTRIBUTE_NAMES,n),QT)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};m(tn,"ownDefaults",cC),m(tn,"type","Polyline"),m(tn,"layoutProperties",["skewX","skewY","strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),m(tn,"cacheProperties",[...An,"points"]),m(tn,"ATTRIBUTE_NAMES",[...oi]),I.setClass(tn),I.setSVGClass(tn);var ds=class extends tn{isOpen(){return!1}};m(ds,"ownDefaults",cC),m(ds,"type","Polygon"),I.setClass(ds),I.setSVGClass(ds);var lC=["fontSize","fontWeight","fontFamily","fontStyle"],uC=["underline","overline","linethrough"],dC=[...lC,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],hC=[...dC,...uC,"textBackgroundColor","direction"],JT=[...lC,...uC,"stroke","strokeWidth","fill","deltaY","textBackgroundColor"],eM={_reNewline:Tf,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Q,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Q,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},nn="justify",ol="justify-left",Mo="justify-right",Ao="justify-center",al=class extends Fe{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let t=e===void 0?this.styles:{line:this.styles[e]};for(let n in t)for(let r in t[n])for(let s in t[n][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;let n=t===void 0?this.styles:{0:this.styles[t]};for(let r in n)for(let s in n[r])if(n[r][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let t=this.styles,n,r,s=0,o=!0,a=0;for(let c in t){n=0;for(let l in t[c]){let u=t[c][l]||{};s++,u[e]!==void 0?(r?u[e]!==r&&(o=!1):r=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?n++:delete t[c][l]}n===0&&delete t[c]}for(let c=0;c<this._textLines.length;c++)a+=this._textLines[c].length;o&&s===a&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;let t=this.styles,n,r,s;for(r in t){for(s in n=t[r],n)delete n[s][e],Object.keys(n[s]).length===0&&delete n[s];Object.keys(n).length===0&&delete t[r]}}_extendStyles(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);let s=Pf(v(v({},this._getStyleDeclaration(n,r)),t),o=>o!==void 0);this._setStyleDeclaration(n,r,s)}getSelectionStyles(e,t,n){let r=[];for(let s=e;s<(t||e);s++)r.push(this.getStyleAtPosition(s,n));return r}getStyleAtPosition(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,r):this._getStyleDeclaration(n,r)}setSelectionStyles(e,t,n){for(let r=t;r<(n||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;let r=this.styles&&this.styles[e];return r&&(n=r[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return v(v({},sr(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}};m(al,"_styleProperties",JT);var tM=/  +/g,nM=/"/g;function Uh(i,e,t,n,r){return"		".concat(function(s,o){let{left:a,top:c,width:l,height:u}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:q.NUM_FRACTION_DIGITS,h=ko("fill",s,!1),[f,p,g,y]=[a,c,l,u].map(_=>Z(_,d));return"<rect ".concat(h,' x="').concat(f,'" y="').concat(p,'" width="').concat(g,'" height="').concat(y,'"></rect>')}(i,{left:e,top:t,width:n,height:r}),`
`)}var iM=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"],Gh,Et=class i extends al{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(),m(this,"__charBounds",[]),Object.assign(this,i.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=Uf(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(nn)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,r,s,o,a;for(let c=0,l=this._textLines.length;c<l;c++)if((this.textAlign===nn||c!==l-1&&!this.isEndOfWrapping(c))&&(r=0,s=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(a=this.textLines[c].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(let u=0;u<=s.length;u++)o=this.__charBounds[c][u],this._reSpaceAndTab.test(s[u])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){let n=t?this._unwrappedTextLines:this._textLines,r;for(r=0;r<n.length;r++){if(e<=n[r].length)return{lineIndex:r,charIndex:e};e-=n[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:n[r-1].length<e?n[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){let t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst==="stroke"?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case U:e.textBaseline="middle";break;case"ascender":e.textBaseline=Xe;break;case"descender":e.textBaseline=Zh}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){let r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,n,r,s,o){this._renderChars(e,t,n,r,s,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let t=e.fillStyle,n=this._getLeftOffset(),r=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){let a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){r+=a;continue}let c=this._textLines[s].length,l=this._getLineLeftOffset(s),u,d,h=0,f=0,p=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let g=0;g<c;g++){let y=this.__charBounds[s][g];d=this.getValueOfPropertyAt(s,g,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=d,d&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):d!==p?(u=n+l+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=p,p&&e.fillRect(u,r,h,a/this.lineHeight),f=y.left,h=y.width,p=d):h+=y.kernedWidth}d&&!this.path&&(u=n+l+f,this.direction==="rtl"&&(u=this.width-u-h),e.fillStyle=d,e.fillRect(u,r,h,a/this.lineHeight)),r+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,r){let s=So.getFontCache(t),o=this._getFontDeclaration(t),a=n+e,c=n&&o===this._getFontDeclaration(r),l=t.fontSize/this.CACHE_FONT_SIZE,u,d,h,f;if(n&&s[n]!==void 0&&(h=s[n]),s[e]!==void 0&&(f=u=s[e]),c&&s[a]!==void 0&&(d=s[a],f=d-h),u===void 0||h===void 0||d===void 0){let p=function(){if(!Gh){let g=Ee();g.width=g.height=0,Gh=g.getContext("2d")}return Gh}();this._setTextStyles(p,t,!0),u===void 0&&(f=u=p.measureText(e).width,s[e]=u),h===void 0&&c&&n&&(h=p.measureText(n).width,s[n]=h),c&&d===void 0&&(d=p.measureText(a).width,s[a]=d,f=d-h)}return{width:u*l,kernedWidth:f*l}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){let t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,r=0,s=this.pathSide===Se,o=this.path,a=this._textLines[e],c=a.length,l=new Array(c);this.__charBounds[e]=l;for(let u=0;u<c;u++){let d=a[u];n=this._getGraphemeBox(d,e,u,t),l[u]=n,r+=n.kernedWidth,t=d}if(l[c]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0,d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Q:u=s?d-r:0;break;case U:u=(d-r)/2;break;case Se:u=s?0:d-r}u+=this.pathStartOffset*(s?-1:1);for(let h=s?c-1:0;s?h>=0:h<c;s?h--:h++)n=l[h],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,n),u+=n.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){let n=e+t.kernedWidth/2,r=this.path,s=K_(r.path,n,r.segmentsInfo);t.renderLeft=s.x-r.pathOffset.x,t.renderTop=s.y-r.pathOffset.y,t.angle=s.angle+(this.pathSide===Se?Math.PI:0)}_getGraphemeBox(e,t,n,r,s){let o=this.getCompleteStyleDeclaration(t,n),a=r?this.getCompleteStyleDeclaration(t,n-1):{},c=this._measureChar(e,o,r,a),l,u=c.kernedWidth,d=c.width;this.charSpacing!==0&&(l=this._getWidthOfCharSpacing(),d+=l,u+=l);let h={width:d,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(n>0&&!s){let f=this.__charBounds[t][n-1];h.left=f.left+f.width+c.kernedWidth-c.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,r=this._textLines[e].length;n<r;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,r=this._textLines.length;n<r;n++)e=this.getHeightOfLine(n),t+=n===r-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0,r=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){let c=this.getHeightOfLine(o),l=c/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],r+u,s+n+l,o),n+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,r,s,o){let a=this.getHeightOfLine(o),c=this.textAlign.includes(nn),l=this.path,u=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!l,d=this.direction==="ltr",h=this.direction==="ltr"?1:-1,f=t.direction,p,g,y,_,b,S="",E=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",d?"ltr":"rtl"),t.direction=d?"ltr":"rtl",t.textAlign=d?Q:Se),s-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,n.join(""),r,s),void t.restore();for(let A=0,O=n.length-1;A<=O;A++)_=A===O||this.charSpacing||l,S+=n[A],y=this.__charBounds[o][A],E===0?(r+=h*(y.kernedWidth-y.width),E+=y.width):E+=y.kernedWidth,c&&!_&&this._reSpaceAndTab.test(n[A])&&(_=!0),_||(p=p||this.getCompleteStyleDeclaration(o,A),g=this.getCompleteStyleDeclaration(o,A+1),_=_l(p,g,!1)),_&&(l?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,o,A,S,-E/2,0),t.restore()):(b=r,this._renderChar(e,t,o,A,S,b,s)),S="",p=g,r+=h*E,E=0);t.restore()}_applyPatternGradientTransformText(e){let t=Ee(),n=this.width+this.strokeWidth,r=this.height+this.strokeWidth,s=t.getContext("2d");return t.width=n,t.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(n,0),s.lineTo(n,r),s.lineTo(0,r),s.closePath(),s.translate(n/2,r/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(t,"no-repeat")}handleFiller(e,t,n){let r,s;return It(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(r=-this.width/2,s=-this.height/2,e.translate(r,s),e[t]=this._applyPatternGradientTransformText(n),{offsetX:r,offsetY:s}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,r,s,o,a){let c=this._getStyleDeclaration(n,r),l=this.getCompleteStyleDeclaration(n,r),u=e==="fillText"&&l.fill,d=e==="strokeText"&&l.stroke&&l.strokeWidth;if(d||u){if(t.save(),t.font=this._getFontDeclaration(l),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(a+=c.deltaY),u){let h=this._setFillStyles(t,l);t.fillText(s,o-h.offsetX,a-h.offsetY)}if(d){let h=this._setStrokeStyles(t,l);t.strokeText(s,o-h.offsetX,a-h.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){let r=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:s*n.size,deltaY:o+s*n.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){let t=this.getLineWidth(e),n=this.width-t,r=this.textAlign,s=this.direction,o=this.isEndOfWrapping(e),a=0;return r===nn||r===Ao&&!o||r===Mo&&!o||r===ol&&!o?0:(r===U&&(a=n/2),r===Se&&(a=n),r===Ao&&(a=n/2),r===Mo&&(a=n),s==="rtl"&&(r===Se||r===nn||r===Mo?a=0:r===Q||r===ol?a=-n:r!==U&&r!==Ao||(a=-n/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var r;return(r=this._getStyleDeclaration(e,t)[n])!==null&&r!==void 0?r:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset(),r=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),a=this.offsets[t];for(let c=0,l=this._textLines.length;c<l;c++){let u=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){n+=u;continue}let d=this._textLines[c],h=u/this.lineHeight,f=this._getLineLeftOffset(c),p,g,y=0,_=0,b=this.getValueOfPropertyAt(c,0,t),S=this.getValueOfPropertyAt(c,0,"fill"),E=n+h*(1-this._fontSizeFraction),A=this.getHeightOfChar(c,0),O=this.getValueOfPropertyAt(c,0,"deltaY");for(let M=0,le=d.length;M<le;M++){let me=this.__charBounds[c][M];p=this.getValueOfPropertyAt(c,M,t),g=this.getValueOfPropertyAt(c,M,"fill");let Le=this.getHeightOfChar(c,M),Oe=this.getValueOfPropertyAt(c,M,"deltaY");if(s&&p&&g)e.save(),e.fillStyle=S,e.translate(me.renderLeft,me.renderTop),e.rotate(me.angle),e.fillRect(-me.kernedWidth/2,a*Le+Oe,me.kernedWidth,this.fontSize/15),e.restore();else if((p!==b||g!==S||Le!==A||Oe!==O)&&_>0){let ue=r+f+y;this.direction==="rtl"&&(ue=this.width-ue-_),b&&S&&(e.fillStyle=S,e.fillRect(ue,E+a*A+O,_,this.fontSize/15)),y=me.left,_=me.width,b=p,S=g,A=Le,O=Oe}else _+=me.kernedWidth}let R=r+f+y;this.direction==="rtl"&&(R=this.width-R-_),e.fillStyle=g,p&&g&&e.fillRect(R,E+a*A+O,_-o,this.fontSize/15),n+=u}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,o=e.includes("'")||e.includes('"')||e.includes(",")||i.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(s?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return yl(e)}_splitTextIntoLines(e){let t=e.split(this._reNewline),n=new Array(t.length),r=[`
`],s=[];for(let o=0;o<t.length;o++)n[o]=this.graphemeSplit(t[o]),s=s.concat(n[o],r);return s.pop(),{_unwrappedLines:n,lines:t,graphemeText:s,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return v(v({},super.toObject([...hC,...e])),{},{styles:L_(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){let{textLayoutProperties:n}=this.constructor;super.set(e,t);let r=!1,s=!1;if(typeof e=="object")for(let o in e)o==="path"&&this.setPathInfo(),r=r||n.includes(o),s=s||o==="path";else r=n.includes(e),s=e==="path";return s&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){let r=On(e,i.ATTRIBUTE_NAMES,n),s=v(v({},t),r),{textAnchor:o=Q,textDecoration:a="",dx:c=0,dy:l=0,top:u=0,left:d=0,fontSize:h=If,strokeWidth:f=1}=s,p=ge(s,iM),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),v({left:d+c,top:u+l,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:h},p)),y=g.getScaledHeight()/g.height,_=((g.height+g.strokeWidth)*g.lineHeight-g.height)*y,b=g.getScaledHeight()+_,S=0;return o===U&&(S=g.getScaledWidth()/2),o===Se&&(S=g.getScaledWidth()),g.set({left:g.left-S,top:g.top-(b-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:f}),g}static fromObject(e){return this._fromObject(v(v({},e),{},{styles:j_(e.styles||{},e.text)}),{extraParam:"text"})}};m(Et,"textLayoutProperties",dC),m(Et,"cacheProperties",[...An,...hC]),m(Et,"ownDefaults",eM),m(Et,"type","Text"),m(Et,"genericFonts",["sans-serif","serif","cursive","fantasy","monospace"]),m(Et,"ATTRIBUTE_NAMES",oi.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),P_(Et,[class extends Yc{_toSVG(){let i=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(i){let{textBgRects:e,textSpans:t}=i,n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(nM,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(i,e){let t=[],n=[],r,s=i;this.backgroundColor&&n.push(...Uh(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+r,s),this._setSVGTextLineText(t,o,e+r,s),s+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:n}}_createTextCharSpan(i,e,t,n){let r=this.getSvgSpanStyles(e,i!==i.trim()||!!i.match(tM)),s=r?'style="'.concat(r,'"'):"",o=e.deltaY,a=o?' dy="'.concat(Z(o,q.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(Z(t,q.NUM_FRACTION_DIGITS),'" y="').concat(Z(n,q.NUM_FRACTION_DIGITS),'" ').concat(a).concat(s,">").concat(F_(i),"</tspan>")}_setSVGTextLineText(i,e,t,n){let r=this.getHeightOfLine(e),s=this.textAlign.includes(nn),o=this._textLines[e],a,c,l,u,d,h="",f=0;n+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=o.length-1;p<=g;p++)d=p===g||this.charSpacing,h+=o[p],l=this.__charBounds[e][p],f===0?(t+=l.kernedWidth-l.width,f+=l.width):f+=l.kernedWidth,s&&!d&&this._reSpaceAndTab.test(o[p])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,p),c=this.getCompleteStyleDeclaration(e,p+1),d=_l(a,c,!0)),d&&(u=this._getStyleDeclaration(e,p),i.push(this._createTextCharSpan(h,u,t,n)),h="",a=c,this.direction==="rtl"?t-=f:t+=f,f=0)}_setSVGTextLineBg(i,e,t,n){let r=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight,o,a=0,c=0,l=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){let{left:d,width:h,kernedWidth:f}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==l?(l&&i.push(...Uh(l,t+c,n,a,s)),c=d,a=h,l=o):a+=f}o&&i.push(...Uh(l,t+c,n,a,s))}_getSVGLineTopOffset(i){let e,t=0;for(e=0;e<i;e++)t+=this.getHeightOfLine(e);let n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(i){return"".concat(super.getSvgStyles(i)," white-space: pre;")}getSvgSpanStyles(i,e){let{fontFamily:t,strokeWidth:n,stroke:r,fill:s,fontSize:o,fontStyle:a,fontWeight:c,deltaY:l}=i,u=this.getSvgTextDecoration(i);return[r?ko("stroke",r):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",c?"font-weight: ".concat(c,"; "):"",u&&"text-decoration: ".concat(u,"; "),s?ko("fill",s):"",l?"baseline-shift: ".concat(-l,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(i){return["overline","underline","line-through"].filter(e=>i[e.replace("-","")]).join(" ")}}]),I.setClass(Et),I.setSVGClass(Et);var Cf=class{constructor(e){m(this,"target",void 0),m(this,"__mouseDownInPlace",!1),m(this,"__dragStartFired",!1),m(this,"__isDraggingOver",!1),m(this,"__dragStartSelection",void 0),m(this,"__dragImageDisposer",void 0),m(this,"_dispose",void 0),this.target=e;let t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){let t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:r,selectionEnd:s}=t,o=this.target,a=o.canvas,c=new C(o.flipX?-1:1,o.flipY?-1:1),l=o._getCursorBoundaries(r),u=new C(l.left+l.leftOffset,l.top+l.topOffset).multiply(c).transform(o.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),h=o.getCanvasRetinaScaling(),f=o.getBoundingRect(),p=u.subtract(new C(f.left,f.top)),g=a.viewportTransform,y=p.add(d).transform(g,!0),_=o.backgroundColor,b=Bo(o.styles);o.backgroundColor="";let S={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(S,0,r),o.setSelectionStyles(S,s,o.text.length),o.dirty=!0;let E=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=_,o.styles=b,o.dirty=!0,Io(E,{position:"fixed",left:"".concat(-E.width,"px"),border:at,width:"".concat(E.width/h,"px"),height:"".concat(E.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{E.remove()},Vt(e.target||this.target.hiddenTextarea).body.appendChild(E),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(E,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;let t=this.target,n=this.isActive();if(n&&e.dataTransfer){let r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=v({text:t.text,value:s},r);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;let{e:n}=e,r=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let s=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!r){let o=this.target,a=o.canvas,c=o.getSelectionStartFromPointer(n),{styles:l}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},u=s[Math.max(0,s.length-1)],d=0;if(this.__dragStartSelection){let h=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;c>h&&c<=f?c=h:c>f&&(c-=f-h),o.removeChars(h,f),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[c])||c===o._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(s,l,c),a.setActiveObject(o),o.enterEditing(n),o.selectionStart=Math.min(c+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire("changed",{index:c+d,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;let r=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,c=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||at;c===at?(r.selectionStart=o,r.selectionEnd=a,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(o,a),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire("changed",{index:o,action:"dragend"}),s.fire("text:changed",{target:r}),s.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},Uy=/[ \n\.,;!\?\-]/,wf=class extends Et{constructor(){super(...arguments),m(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:r,onComplete:s}=e;return Rf({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:r,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){let n=this._text,r=e>0&&this._reSpace.test(n[e])&&(t===-1||!Tf.test(n[e-1]))?e-1:e,s=n[r];for(;r>0&&r<n.length&&!Uy.test(s);)r+=t,s=n[r];return t===-1&&Uy.test(s)&&r++,r}selectWord(e){e=e||this.selectionStart;let t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;let t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let t=this.hiddenTextarea;Vt(t).activeElement!==t&&t.focus();let n=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&r!==s||r!==n&&s!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){let r=n.slice(0,e),s=this.graphemeSplit(r).length;if(e===t)return{selectionStart:s,selectionEnd:s};let o=n.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,n){let r=n.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),r=n.lineIndex,s=n.charIndex,o=this.getValueOfPropertyAt(r,s,"fontSize")*this.lineHeight,a=t.leftOffset,c=this.getCanvasRetinaScaling(),l=this.canvas.upperCanvasEl,u=l.width/c,d=l.height/c,h=u-o,f=d-o,p=new C(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new C(l.clientWidth/u,l.clientHeight/d));return p.x<0&&(p.x=0),p.x>h&&(p.x=h),p.y<0&&(p.y=0),p.y>f&&(p.y=f),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditing(){let e=this._textBeforeEdit!==this.text;return this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(t,!0);if(n!==s){if(this.styles[n])for(let a=r;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[s])for(let a=o;a<this._unwrappedTextLines[s].length;a++){let c=this.styles[s][a];c&&(this.styles[n]||(this.styles[n]={}),this.styles[n][r+a-o]=c)}for(let a=n+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,n-s)}else if(this.styles[n]){let a=this.styles[n],c=o-r;for(let l=r;l<o;l++)delete a[l];for(let l in this.styles[n]){let u=parseInt(l,10);u>=o&&(a[u-c]=a[l],delete a[l])}}}shiftLineStyles(e,t){let n=Object.assign({},this.styles);for(let r in this.styles){let s=parseInt(r,10);s>e&&(this.styles[s+t]=n[s],n[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,n,r){let s={},o=this._unwrappedTextLines[e].length,a=o===t,c=!1;n||(n=1),this.shiftLineStyles(e,n);let l=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(let d in this.styles[e]){let h=parseInt(d,10);h>=t&&(c=!0,s[h-t]=this.styles[e][d],a&&t===0||delete this.styles[e][d])}let u=!1;for(c&&!a&&(this.styles[e+n]=s,u=!0),(u||o>t)&&n--;n>0;)r&&r[n-1]?this.styles[e+n]={0:v({},r[n-1])}:l?this.styles[e+n]={0:v({},l)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,r){this.styles||(this.styles={});let s=this.styles[e],o=s?v({},s):{};n||(n=1);for(let c in o){let l=parseInt(c,10);l>=t&&(s[l+n]=o[l],o[l-n]||delete s[l])}if(this._forceClearCache=!0,r){for(;n--;)Object.keys(r[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=v({},r[n]));return}if(!s)return;let a=s[t?t-1:1];for(;a&&n--;)this.styles[e][t+n]=v({},a)}insertNewStyleBlock(e,t,n){let r=this.get2DCursorLocation(t,!0),s=[0],o,a=0;for(let c=0;c<e.length;c++)e[c]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,s[0],n),n=n&&n.slice(s[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+s[0],a),o=1;o<a;o++)s[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,s[o],n):n&&this.styles[r.lineIndex+o]&&n[0]&&(this.styles[r.lineIndex+o][0]=n[0]),n=n&&n.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,s[o],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;r>n&&this.removeStyleFromTo(n,r);let s=this.graphemeSplit(e);this.insertNewStyleBlock(s,n,t),this._text=[...this._text.slice(0,n),...s,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Q:this._selectionDirection===Se&&(this._selectionDirection=Q,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===Se?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=Se:this._selectionDirection===Q&&(this._selectionDirection=Se,this.selectionStart=t),this.selectionEnd=n)}},bf=class extends wf{initHiddenTextarea(){let e=this.canvas&&Vt(this.canvas.getElement())||bs(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,c]=o;return t.setAttribute(a,c)});let{top:n,left:r,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,c]=o;return t.addEventListener(a,this[c].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let n=()=>{this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();let r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,o=r.length,a=this.selectionStart,c=this.selectionEnd,l=a!==c,u,d,h,f,p=o-s,g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=a>g.selectionStart;l?(d=this._text.slice(a,c),p+=c-a):o<s&&(d=y?this._text.slice(c+p,c):this._text.slice(a,a-p));let _=r.slice(g.selectionEnd-p,g.selectionEnd);if(d&&d.length&&(_.length&&(u=this.getSelectionStyles(a,a+1,!1),u=_.map(()=>u[0])),l?(h=a,f=c):y?(h=c-d.length,f=c):(h=c,f=c+d.length),this.removeStyleFromTo(h,f)),_.length){let{copyPasteData:b}=cn();t&&_.join("")===b.copiedText&&!q.disableStyleCopyPaste&&(u=b.copiedTextStyle),this.insertNewStyleBlock(_,a,u)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e,{selectionStart:n,selectionEnd:r}=t;this.compositionStart=n,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=cn();e.copiedText=this.getSelectedText(),q.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,r=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],r+=n.left+n.width),r}getDownCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),s=r.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;let o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(o).length+c+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),s=r.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-n;let o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s-1,a),l=this._textLines[s].slice(0,o),u=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+c-l.length+(1-u)}_getIndexOnLine(e,t){let n=this._textLines[e],r,s,o=this._getLineLeftOffset(e),a=0;for(let c=0,l=n.length;c<l;c++)if(r=this.__charBounds[e][c].width,o+=r,o>t){s=!0;let u=o-r,d=o,h=Math.abs(u-t);a=Math.abs(d-t)<h?c:c-1;break}return s||(a=n.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){let n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Se);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){let r=this.text.length;this.selectionStart=ir(0,this.selectionStart,r),this.selectionEnd=ir(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let t=this._selectionDirection===Q?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let r;if(e.altKey)r=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;r=this["findLineBoundary".concat(n)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Q,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Se&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Q,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){let n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Q&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Se,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Se,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}},zh=i=>!!i.button,Df=class extends bf{constructor(){super(...arguments),m(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new Cf(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;let t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),Jh(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!zh(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!zh(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e,r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);let s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||zh(t)||r||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){let t=this.getSelectionStartFromPointer(e),n=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let t=this.canvas.getScenePoint(e).transform(gt(this.calcTransformMatrix())).add(new C(-this._getLeftOffset(),-this._getTopOffset())),n=0,r=0,s=0;for(let l=0;l<this._textLines.length&&n<=t.y;l++)n+=this.getHeightOfLine(l),s=l,l>0&&(r+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));let o=Math.abs(this._getLineLeftOffset(s)),a=this._textLines[s].length,c=this.__charBounds[s];for(let l=0;l<a;l++){let u=o+c[l].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&r++;break}o=u,r++}return Math.min(this.flipX?a-r:r,this._text.length)}},Nc="moveCursorUp",Rc="moveCursorDown",Fc="moveCursorLeft",Lc="moveCursorRight",jc="exitEditing",rM=v({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:jc,27:jc,33:Nc,34:Rc,35:Lc,36:Fc,37:Fc,38:Nc,39:Lc,40:Rc},keysMapRtl:{9:jc,27:jc,33:Nc,34:Rc,35:Fc,36:Lc,37:Lc,38:Nc,39:Fc,40:Rc},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1}),sn=class i extends Df{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}get type(){let e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,v(v({},i.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof Cs&&this.canvas.textEditingManager.remove(this),t instanceof Cs&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let t=this.isEditing;this.isEditing=!1;let n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;let e=this.clearContextTop(!0);if(!e)return;let t=this._getCursorBoundaries();this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0,n=this._getLeftOffset(),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:n,top:r,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0,{charIndex:r,lineIndex:s}=this.get2DCursorLocation(e);for(let l=0;l<s;l++)t+=this.getHeightOfLine(l);let o=this._getLineLeftOffset(s),a=this.__charBounds[s][r];a&&(n=a.left),this.charSpacing!==0&&r===this._textLines[s].length&&(n-=this._getWidthOfCharSpacing());let c={top:t,left:o+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Se||this.textAlign===nn||this.textAlign===Mo?c.left*=-1:this.textAlign===Q||this.textAlign===ol?c.left=o-(n>0?n:0):this.textAlign!==U&&this.textAlign!==Ao||(c.left=o-(n>0?n:0))),c}renderCursorAt(e){let t=this._getCursorBoundaries(e,!0);this._renderCursor(this.canvas.contextTop,t,e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}_renderCursor(e,t,n){let r=this.get2DCursorLocation(n),s=r.lineIndex,o=r.charIndex>0?r.charIndex-1:0,a=this.getValueOfPropertyAt(s,o,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/c,u=this.getValueOfPropertyAt(s,o,"deltaY"),d=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);this.inCompositionMode&&this.renderSelection(e,t),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(s,o,"fill"),e.globalAlpha=this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-l/2,d+t.top+u,l,a)}renderSelection(e,t){let n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){let r=t.selectionStart,s=t.selectionEnd,o=this.textAlign.includes(nn),a=this.get2DCursorLocation(r),c=this.get2DCursorLocation(s),l=a.lineIndex,u=c.lineIndex,d=a.charIndex<0?0:a.charIndex,h=c.charIndex<0?0:c.charIndex;for(let f=l;f<=u;f++){let p=this._getLineLeftOffset(f)||0,g=this.getHeightOfLine(f),y=0,_=0,b=0;if(f===l&&(_=this.__charBounds[l][d].left),f>=l&&f<u)b=o&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===u)if(h===0)b=this.__charBounds[u][h].left;else{let R=this._getWidthOfCharSpacing();b=this.__charBounds[u][h-1].left+this.__charBounds[u][h-1].width-R}y=g,(this.lineHeight<1||f===u&&this.lineHeight>1)&&(g/=this.lineHeight);let S=n.left+p+_,E=g,A=0,O=b-_;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",E=1,A=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Se||this.textAlign===nn||this.textAlign===Mo?S=this.width-S-O:this.textAlign===Q||this.textAlign===ol?S=n.left+p-b:this.textAlign!==U&&this.textAlign!==Ao||(S=n.left+p-b)),e.fillRect(S,n.top+n.topOffset+A,O,E),n.topOffset+=y}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this._exitEditing(),this.draggableTextDelegate.dispose(),super.dispose()}};m(sn,"ownDefaults",rM),m(sn,"type","IText"),I.setClass(sn),I.setClass(sn,"i-text");var hs=class i extends sn{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(e,v(v({},i.ownDefaults),t))}static createControls(){return{controls:k_()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(nn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,r=0,s={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(n=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(n++,r++),s[o]={line:t,offset:n},r+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,r=e+1,s=!1,o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,n=o.offset),a&&(r=a.line,s=r===e,t=a.offset);let c=e===void 0?this.styles:{line:this.styles[e]};for(let l in c)for(let u in c[l]){let d=parseInt(u,10);if(d>=n&&(!s||d<t))for(let h in c[l][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){let r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,n)}_deleteStyleDeclaration(e,t){let n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){let t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){let t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;let n=this.getGraphemeDataForRender(e),r=[];for(let s=0;s<n.wordsData.length;s++)r.push(...this._wrapLine(s,t,n));return this.isWrapping=!1,r}getGraphemeDataForRender(e){let t=this.splitByGrapheme,n=t?"":" ",r=0;return{wordsData:e.map((s,o)=>{let a=0,c=t?this.graphemeSplit(s):this.wordSplit(s);return c.length===0?[{word:[],width:0}]:c.map(l=>{let u=t?[l]:this.graphemeSplit(l),d=this._measureWord(u,o,a);return r=Math.max(d,r),a+=u.length+n.length,{word:u,width:d}})}),largestWordWidth:r}}_measureWord(e,t){let n,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,a=e.length;o<a;o++)s+=this._getGraphemeBox(e[o],t,o+r,n,!0).kernedWidth,n=e[o];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:r,wordsData:s}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,l=[],u=c?"":" ",d=0,h=[],f=0,p=0,g=!0;t-=o;let y=Math.max(t,r,this.dynamicMinWidth),_=s[e],b;for(f=0,b=0;b<_.length;b++){let{word:S,width:E}=_[b];f+=S.length,d+=p+E-a,d>y&&!g?(l.push(h),h=[],d=E,g=!0):d+=a,g||c||h.push(u),h=h.concat(S),p=c?0:this._measureWord([u],e,f),f++,g=!1}return b&&l.push(h),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-a+o),l}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n[s].join("");return t.lines=r,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let t in this._styleMap){let n=parseInt(t,10);if(this._textLines[n]){let r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(let t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}};m(hs,"type","Textbox"),m(hs,"textLayoutProperties",[...sn.textLayoutProperties,"width"]),m(hs,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),I.setClass(hs);var ws=class extends _s{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){let{target:n}=e,{clipPath:r}=n;if(!r||!this.shouldPerformLayout(e))return;let{width:s,height:o}=on(H_(n,r)),a=new C(s,o);if(r.absolutePositioned){var c;return{center:ei(r.getRelativeCenterPoint(),void 0,(c=n.group)===null||c===void 0?void 0:c.calcTransformMatrix()),size:a}}{let l=r.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new C,correction:d=new C}=this.calcBoundingBox(t,e)||{};return{center:u.add(l),correction:d.subtract(l),size:a}}return{center:n.getRelativeCenterPoint().add(l),size:a}}}};m(ws,"type","clip-path"),I.setClass(ws);var cl=class extends _s{getInitialSize(e,t){let{target:n}=e,{size:r}=t;return new C(n.width||r.x,n.height||r.y)}};m(cl,"type","fixed"),I.setClass(cl);var Sf=class extends rr{subscribeTargets(e){let t=e.target;e.targets.reduce((n,r)=>(r.parent&&n.add(r.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){let t=e.target,n=t.getObjects();e.targets.reduce((r,s)=>(s.parent&&r.add(s.parent),r),new Set).forEach(r=>{!n.some(s=>s.parent===r)&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})})}},fs=class i extends an{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,i.ownDefaults),this.setOptions(t);let{left:n,top:r,layoutManager:s}=t;this.groupInit(e,{left:n,top:r,layoutManager:s??new Sf})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(r=>{let s=this._objects.findIndex(a=>a.isInFrontOf(r)),o=s===-1?this.size():s;this.insertAt(o,r)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(ti("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);let n=new Set;t.forEach(r=>{let{parent:s}=r;s&&n.add(s)}),e===Hf?n.forEach(r=>{r._onAfterObjectsChange(nl,t)}):n.forEach(r=>{r._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let r=v(v({hasControls:!1},n),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,r);super._renderControls(e,t),e.restore()}};m(fs,"type","ActiveSelection"),m(fs,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),I.setClass(fs),I.setClass(fs,"activeSelection");var xf=class{constructor(){m(this,"resources",{})}applyFilters(e,t,n,r,s){let o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0,n,r);let a={sourceWidth:n,sourceHeight:r,imageData:o.getImageData(0,0,n,r),originalEl:t,originalImageData:o.getImageData(0,0,n,r),canvasEl:s,ctx:o,filterBackend:this};e.forEach(l=>{l.applyTo(a)});let{imageData:c}=a;return c.width===n&&c.height===r||(s.width=c.width,s.height=c.height),o.putImageData(c,0,0),a}},ll=class{constructor(){let{tileSize:e=q.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),m(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){let n=Ee();n.width=e,n.height=t;let r=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)}applyFilters(e,t,n,r,s,o){let a=this.gl,c=s.getContext("2d");if(!a||!c)return;let l;o&&(l=this.getCachedTexture(o,t));let u={originalWidth:t.width||t.originalWidth||0,originalHeight:t.height||t.originalHeight||0,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,n,r,l?void 0:t),targetTexture:this.createTexture(a,n,r),originalTexture:l||this.createTexture(a,n,r,l?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach(h=>{h&&h.applyTo(u)}),function(h){let f=h.targetCanvas,p=f.width,g=f.height,y=h.destinationWidth,_=h.destinationHeight;p===y&&g===_||(f.width=y,f.height=_)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),c.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,r,s){let{NEAREST:o,TEXTURE_2D:a,RGBA:c,UNSIGNED_BYTE:l,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:p}=e,g=e.createTexture();return e.bindTexture(a,g),e.texParameteri(a,d,s||o),e.texParameteri(a,h,s||o),e.texParameteri(a,f,u),e.texParameteri(a,p,u),r?e.texImage2D(a,0,c,c,l,r):e.texImage2D(a,0,c,t,n,0,c,l,null),g}getCachedTexture(e,t,n){let{textureCache:r}=this;if(r[e])return r[e];{let s=this.createTexture(this.gl,t.width,t.height,t,n);return s&&(r[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){let n=e.canvas,r=t.targetCanvas,s=r.getContext("2d");if(!s)return;s.translate(0,r.height),s.scale(1,-1);let o=n.height-r.height;s.drawImage(n,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){let n=t.targetCanvas.getContext("2d"),r=t.destinationWidth,s=t.destinationHeight,o=r*s*4;if(!n)return;let a=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,s,e.RGBA,e.UNSIGNED_BYTE,a);let l=new ImageData(c,r,s);n.putImageData(l,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,t={renderer:"",vendor:""};if(!e)return t;let n=e.getExtension("WEBGL_debug_renderer_info");if(n){let r=e.getParameter(n.UNMASKED_RENDERER_WEBGL),s=e.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}},$h;function sM(){let{WebGLProbe:i}=cn();return i.queryWebGL(Ee()),q.enableGLFiltering&&i.isSupported(q.textureSize)?new ll({tileSize:q.textureSize}):new xf}function Wh(){return!$h&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&($h=sM()),$h}var oM=["filters","resizeFilter","src","crossOrigin","type"],fC=["cropX","cropY"],ot=class i extends Fe{static getDefaults(){return v(v({},super.getDefaults()),i.ownDefaults)}constructor(e,t){super(),m(this,"_lastScaleX",1),m(this,"_lastScaleY",1),m(this,"_filterScalingX",1),m(this,"_filterScalingY",1),this.filters=[],Object.assign(this,i.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(ii()),this.setElement(typeof e=="string"?(this.canvas&&Vt(this.canvas.getElement())||bs()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(i.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let t=Wh(!1);t instanceof ll&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let t=this[e];t&&cn().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),v(v({},super.toObject([...fC,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],t=this._element,n=-this.width/2,r=-this.height/2,s=[],o=[],a="",c="";if(!t)return[];if(this.hasCrop()){let l=ii();s.push('<clipPath id="imageCrop_'+l+`">
`,'	<rect x="'+n+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(c).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){let l=this.fill;this.fill=null,o=['	<rect x="'.concat(n,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=l}return s=this.paintFirst!=="fill"?s.concat(o,e):s.concat(e,o),s}getSrc(e){let t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eo(e,{crossOrigin:t,signal:n}).then(r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),r=n.x,s=n.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&s>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=s);let a=Ee(),c=o.width,l=o.height;a.width=c,a.height=l,this._element=a,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=s,Wh().applyFilters([e],o,c,l,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let t=this._originalElement,n=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){let s=Ee();s.width=n,s.height=r,this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,r),this._lastScaleX=1,this._lastScaleY=1);Wh().applyFilters(e,this._originalElement,n,r,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let t=this._element;if(!t)return;let n=this._filterScalingX,r=this._filterScalingY,s=this.width,o=this.height,a=Math.max(this.cropX,0),c=Math.max(this.cropY,0),l=t.naturalWidth||t.width,u=t.naturalHeight||t.height,d=a*n,h=c*r,f=Math.min(s*n,l-d),p=Math.min(o*r,u-h),g=-s/2,y=-o/2,_=Math.min(s,l/n-a),b=Math.min(o,u/r-c);t&&e.drawImage(t,d,h,f,p,g,y,_,b)}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){let e=e_(this.preserveAspectRatio||""),t=this.width,n=this.height,r={width:t,height:n},s,o=this._element.width,a=this._element.height,c=1,l=1,u=0,d=0,h=0,f=0;return!e||e.alignX===at&&e.alignY===at?(c=t/o,l=n/a):(e.meetOrSlice==="meet"&&(c=l=G_(this._element,r),s=(t-o*c)/2,e.alignX==="Min"&&(u=-s),e.alignX==="Max"&&(u=s),s=(n-a*l)/2,e.alignY==="Min"&&(d=-s),e.alignY==="Max"&&(d=s)),e.meetOrSlice==="slice"&&(c=l=z_(this._element,r),s=o-t/c,e.alignX==="Mid"&&(h=s/2),e.alignX==="Max"&&(h=s),s=a-n/l,e.alignY==="Mid"&&(f=s/2),e.alignY==="Max"&&(f=s),o=t/c,a=n/l)),{width:o,height:a,scaleX:c,scaleY:l,offsetLeft:u,offsetTop:d,cropX:h,cropY:f}}static fromObject(e,t){let{filters:n,resizeFilter:r,src:s,crossOrigin:o,type:a}=e,c=ge(e,oM);return Promise.all([Eo(s,v(v({},t),{},{crossOrigin:o})),n&&vs(n,t),r&&vs([r],t),jo(c,t)]).then(l=>{let[u,d=[],[h]=[],f={}]=l;return new this(u,v(v({},c),{},{src:s,filters:d,resizeFilter:h},f))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return Eo(e,{crossOrigin:t,signal:n}).then(s=>new this(s,r))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=On(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(r["xlink:href"],t,r).catch(s=>(ti("log","Unable to parse Image",s),null))}};m(ot,"type","Image"),m(ot,"cacheProperties",[...An,...fC]),m(ot,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),m(ot,"CSS_CANVAS","canvas-img"),m(ot,"ATTRIBUTE_NAMES",[...oi,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),I.setClass(ot),I.setSVGClass(ot);var hL=ml(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var pC="modifyPoly",Gy=i=>function(e,t,n){let{points:r,pathOffset:s}=n;return new C(r[i]).subtract(s).transform(xe(n.getViewportTransform(),n.calcTransformMatrix()))},gC=(i,e,t,n)=>{let{target:r,pointIndex:s}=e,o=r,a=ei(new C(t,n),void 0,o.calcOwnMatrix());return o.points[s]=a.add(o.pathOffset),o.setDimensions(),!0},mC=(i,e)=>function(t,n,r,s){let o=n.target,a=new C(o.points[(i>0?i:o.points.length)-1]),c=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()),l=e(t,v(v({},n),{},{pointIndex:i}),r,s),u=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()).subtract(c);return o.left-=u.x,o.top-=u.y,l},zy=i=>si(pC,mC(i,gC)),fL=Object.freeze({__proto__:null,changeWidth:df,createObjectDefaultControls:Vf,createPolyActionHandler:zy,createPolyControls:function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let n=0;n<(typeof i=="number"?i:i.points.length);n++)t["p".concat(n)]=new Ue(v({actionName:pC,positionHandler:Gy(n),actionHandler:zy(n)},e));return t},createPolyPositionHandler:Gy,createResizeControls:O_,createTextboxDefaultControls:k_,dragHandler:f_,factoryPolyActionHandler:mC,getLocalPoint:pl,polyActionHandler:gC,renderCircleControl:__,renderSquareControl:C_,rotationStyleHandler:w_,rotationWithSnapping:b_,scaleCursorStyleHandler:cs,scaleOrSkewActionName:Do,scaleSkewCursorStyleHandler:ji,scalingEqually:bo,scalingX:x_,scalingXOrSkewingY:hf,scalingY:E_,scalingYOrSkewingX:ff,skewCursorStyleHandler:I_,skewHandlerX:M_,skewHandlerY:A_,wrapWithFireEvent:si,wrapWithFixedAnchor:or}),Cl=i=>i.webgl!==void 0;var Gf="precision highp float",aM=`
    `.concat(Gf,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),cM=["type"],lM=["type"],uM=new RegExp(Gf,"g"),De=class{get type(){return this.constructor.type}constructor(){let e=ge(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},cM);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return aM}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:r="highp"}}=cn();r!=="highp"&&(t=t.replace(uM,Gf.replace("highp",r)));let s=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!o||!a)throw new Tt("Vertex, fragment shader or program creation error");if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Tt("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Tt("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,s),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Tt('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));let c=this.getUniformLocations(e,a)||{};return c.uStepW=e.getUniformLocation(a,"uStepW"),c.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:c}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){let n=this.constructor.uniformLocations,r={};for(let s=0;s<n.length;s++)r[n[s]]=e.getUniformLocation(t,n[s]);return r}sendAttributeData(e,t,n){let r=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){let t=e.context;if(e.passes>1){let n=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;let t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Cl(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){let t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){let t=Ee();t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}}toObject(){let e=Object.keys(this.constructor.defaults);return v({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(ge(e,lM))}};m(De,"type","BaseFilter"),m(De,"uniformLocations",[]);var dM={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},Vi=class extends De{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(dM[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e,n=new et(this.color).getSource(),r=n[0]*this.alpha,s=n[1]*this.alpha,o=n[2]*this.alpha,a=1-this.alpha;for(let c=0;c<t.length;c+=4){let l=t[c],u=t[c+1],d=t[c+2];switch(this.mode){case"multiply":t[c]=l*r/255,t[c+1]=u*s/255,t[c+2]=d*o/255;break;case"screen":t[c]=255-(255-l)*(255-r)/255,t[c+1]=255-(255-u)*(255-s)/255,t[c+2]=255-(255-d)*(255-o)/255;break;case"add":t[c]=l+r,t[c+1]=u+s,t[c+2]=d+o;break;case"difference":t[c]=Math.abs(l-r),t[c+1]=Math.abs(u-s),t[c+2]=Math.abs(d-o);break;case"subtract":t[c]=l-r,t[c+1]=u-s,t[c+2]=d-o;break;case"darken":t[c]=Math.min(l,r),t[c+1]=Math.min(u,s),t[c+2]=Math.min(d,o);break;case"lighten":t[c]=Math.max(l,r),t[c+1]=Math.max(u,s),t[c+2]=Math.max(d,o);break;case"overlay":t[c]=r<128?2*l*r/255:255-2*(255-l)*(255-r)/255,t[c+1]=s<128?2*u*s/255:255-2*(255-u)*(255-s)/255,t[c+2]=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255;break;case"exclusion":t[c]=r+l-2*r*l/255,t[c+1]=s+u-2*s*u/255,t[c+2]=o+d-2*o*d/255;break;case"tint":t[c]=r+l*a,t[c+1]=s+u*a,t[c+2]=o+d*a}}}sendUniformData(e,t){let n=new et(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}};m(Vi,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),m(Vi,"type","BlendColor"),m(Vi,"uniformLocations",["uColor"]),I.setClass(Vi);var hM={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},fM=["type","image"],Bi=class extends De{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return hM[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){let t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){let e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:r},filterBackend:{resources:s}}=e,o=this.image;s.blendImage||(s.blendImage=Ee());let a=s.blendImage,c=a.getContext("2d");a.width!==n||a.height!==r?(a.width=n,a.height=r):c.clearRect(0,0,n,r),c.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),c.drawImage(o.getElement(),0,0,n,r);let l=c.getImageData(0,0,n,r).data;for(let u=0;u<t.length;u+=4){let d=t[u],h=t[u+1],f=t[u+2],p=t[u+3],g=l[u],y=l[u+1],_=l[u+2],b=l[u+3];switch(this.mode){case"multiply":t[u]=d*g/255,t[u+1]=h*y/255,t[u+2]=f*_/255,t[u+3]=p*b/255;break;case"mask":t[u+3]=b}}}sendUniformData(e,t){let n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return v(v({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:r}=e,s=ge(e,fM);return ot.fromObject(r,t).then(o=>new this(v(v({},s),{},{image:o})))}};m(Bi,"type","BlendImage"),m(Bi,"defaults",{mode:"multiply",alpha:1}),m(Bi,"uniformLocations",["uTransformMatrix","uImage"]),I.setClass(Bi);var Hi=class extends De{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){Cl(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:r}}=e,{width:s,height:o}=n;r.blurLayer1||(r.blurLayer1=Ee(),r.blurLayer2=Ee());let a=r.blurLayer1,c=r.blurLayer2;a.width===s&&a.height===o||(c.width=a.width=s,c.height=a.height=o);let l=a.getContext("2d"),u=c.getContext("2d"),d=15,h=.06*this.blur*.5,f,p,g,y;for(l.putImageData(n,0,0),u.clearRect(0,0,s,o),y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*s+f,u.globalAlpha=1-Math.abs(p),u.drawImage(a,g,f),l.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);for(y=-15;y<=d;y++)f=(Math.random()-.5)/4,p=y/d,g=h*p*o+f,u.globalAlpha=1-Math.abs(p),u.drawImage(a,f,g),l.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);t.drawImage(a,0,0);let _=t.getImageData(0,0,a.width,a.height);return l.globalAlpha=1,l.clearRect(0,0,a.width,a.height),_}sendUniformData(e,t){let n=this.chooseRightDelta();e.uniform2fv(t.delta,n)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1,t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);let n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}};m(Hi,"type","Blur"),m(Hi,"defaults",{blur:0}),m(Hi,"uniformLocations",["uDelta"]),I.setClass(Hi);var Ui=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]=t[r]+n,t[r+1]=t[r+1]+n,t[r+2]=t[r+2]+n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}};m(Ui,"type","Brightness"),m(Ui,"defaults",{brightness:0}),m(Ui,"uniformLocations",["uBrightness"]),I.setClass(Ui);var In=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){let t=e.imageData.data,n=this.matrix,r=this.colorsOnly;for(let s=0;s<t.length;s+=4){let o=t[s],a=t[s+1],c=t[s+2];if(r)t[s]=o*n[0]+a*n[1]+c*n[2]+255*n[4],t[s+1]=o*n[5]+a*n[6]+c*n[7]+255*n[9],t[s+2]=o*n[10]+a*n[11]+c*n[12]+255*n[14];else{let l=t[s+3];t[s]=o*n[0]+a*n[1]+c*n[2]+l*n[3]+255*n[4],t[s+1]=o*n[5]+a*n[6]+c*n[7]+l*n[8]+255*n[9],t[s+2]=o*n[10]+a*n[11]+c*n[12]+l*n[13]+255*n[14],t[s+3]=o*n[15]+a*n[16]+c*n[17]+l*n[18]+255*n[19]}}}sendUniformData(e,t){let n=this.matrix,r=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],s=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,s)}toObject(){return v(v({},super.toObject()),{},{matrix:[...this.matrix]})}};function ar(i,e){var t;let n=(m(t=class extends In{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",i),m(t,"defaults",{colorsOnly:!1,matrix:e}),t);return I.setClass(n,i),n}m(In,"type","ColorMatrix"),m(In,"defaults",{matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0}),m(In,"uniformLocations",["uColorMatrix","uConstants"]),I.setClass(In);var pM=ar("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),gM=ar("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),mM=ar("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),vM=ar("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),yM=ar("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),_M=ar("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),CM=ar("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),Fo=class extends De{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Cl(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>I.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}};m(Fo,"type","Composed"),I.setClass(Fo);var Gi=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e,n=Math.floor(255*this.contrast),r=259*(n+255)/(255*(259-n));for(let s=0;s<t.length;s+=4)t[s]=r*(t[s]-128)+128,t[s+1]=r*(t[s+1]-128)+128,t[s+2]=r*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}};m(Gi,"type","Contrast"),m(Gi,"defaults",{contrast:0}),m(Gi,"uniformLocations",["uContrast"]),I.setClass(Gi);var wM={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},zi=class extends De{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return wM[this.getCacheKey()]}applyTo2d(e){let t=e.imageData,n=t.data,r=this.matrix,s=Math.round(Math.sqrt(r.length)),o=Math.floor(s/2),a=t.width,c=t.height,l=e.ctx.createImageData(a,c),u=l.data,d=this.opaque?1:0,h,f,p,g,y,_,b,S,E,A,O,R,M;for(O=0;O<c;O++)for(A=0;A<a;A++){for(y=4*(O*a+A),h=0,f=0,p=0,g=0,M=0;M<s;M++)for(R=0;R<s;R++)b=O+M-o,_=A+R-o,b<0||b>=c||_<0||_>=a||(S=4*(b*a+_),E=r[M*s+R],h+=n[S]*E,f+=n[S+1]*E,p+=n[S+2]*E,d||(g+=n[S+3]*E));u[y]=h,u[y+1]=f,u[y+2]=p,u[y+3]=d?n[y+3]:g}e.imageData=l}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return v(v({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};m(zi,"type","Convolute"),m(zi,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),m(zi,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),I.setClass(zi);var vC="Gamma",$i=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e,n=this.gamma,r=1/n[0],s=1/n[1],o=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let a=this.rgbValues;for(let c=0;c<256;c++)a.r[c]=255*Math.pow(c/255,r),a.g[c]=255*Math.pow(c/255,s),a.b[c]=255*Math.pow(c/255,o);for(let c=0;c<t.length;c+=4)t[c]=a.r[t[c]],t[c+1]=a.g[t[c+1]],t[c+2]=a.b[t[c+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){let{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:vC,gamma:this.gamma.concat()}}};m($i,"type",vC),m($i,"defaults",{gamma:[1,1,1]}),m($i,"uniformLocations",["uGamma"]),I.setClass($i);var bM={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},Wi=class extends De{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,r=0;r<t.length;r+=4){switch(this.mode){case"average":n=(t[r]+t[r+1]+t[r+2])/3;break;case"lightness":n=(Math.min(t[r],t[r+1],t[r+2])+Math.max(t[r],t[r+1],t[r+2]))/2;break;case"luminosity":n=.21*t[r]+.72*t[r+1]+.07*t[r+2]}t[r]=n,t[r+1]=n,t[r+2]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return bM[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}};m(Wi,"type","Grayscale"),m(Wi,"defaults",{mode:"average"}),m(Wi,"uniformLocations",["uMode"]),I.setClass(Wi);var gs=class extends In{calculateMatrix(){let e=this.rotation*Math.PI,t=Ht(e),n=Ut(e),r=1/3,s=Math.sqrt(r)*n,o=1-t;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=t+o/3,this.matrix[1]=r*o-s,this.matrix[2]=r*o+s,this.matrix[5]=r*o+s,this.matrix[6]=t+r*o,this.matrix[7]=r*o-s,this.matrix[10]=r*o-s,this.matrix[11]=r*o+s,this.matrix[12]=t+r*o}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}};m(gs,"type","HueRotation"),m(gs,"defaults",{rotation:0}),I.setClass(gs);var Yi=class extends De{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}};m(Yi,"type","Invert"),m(Yi,"defaults",{alpha:!1,invert:!0}),m(Yi,"uniformLocations",["uInvert","uAlpha"]),I.setClass(Yi);var qi=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=this.noise;for(let r=0;r<t.length;r+=4){let s=(.5-Math.random())*n;t[r]+=s,t[r+1]+=s,t[r+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}};m(qi,"type","Noise"),m(qi,"defaults",{noise:0}),m(qi,"uniformLocations",["uNoise","uSeed"]),I.setClass(qi);var Xi=class extends De{applyTo2d(e){let{imageData:{data:t,width:n,height:r}}=e;for(let s=0;s<r;s+=this.blocksize)for(let o=0;o<n;o+=this.blocksize){let a=4*s*n+4*o,c=t[a],l=t[a+1],u=t[a+2],d=t[a+3];for(let h=s;h<Math.min(s+this.blocksize,r);h++)for(let f=o;f<Math.min(o+this.blocksize,n);f++){let p=4*h*n+4*f;t[p]=c,t[p+1]=l,t[p+2]=u,t[p+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepW;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};m(Xi,"type","Pixelate"),m(Xi,"defaults",{blocksize:4}),m(Xi,"uniformLocations",["uBlockSize"]),I.setClass(Xi);var Zi=class extends De{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e,n=255*this.distance,r=new et(this.color).getSource(),s=[r[0]-n,r[1]-n,r[2]-n],o=[r[0]+n,r[1]+n,r[2]+n];for(let a=0;a<t.length;a+=4){let c=t[a],l=t[a+1],u=t[a+2];c>s[0]&&l>s[1]&&u>s[2]&&c<o[0]&&l<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){let n=new et(this.color).getSource(),r=this.distance,s=[0+n[0]/255-r,0+n[1]/255-r,0+n[2]/255-r,1],o=[n[0]/255+r,n[1]/255+r,n[2]/255+r,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,o)}};m(Zi,"type","RemoveColor"),m(Zi,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),m(Zi,"uniformLocations",["uLow","uHigh"]),I.setClass(Zi);var Ki=class extends De{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),r=new Array(n);for(let s=1;s<=n;s++)r[s-1]=e(s*t);return r}generateShader(e){let t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Cl(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;let n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){let t=e.imageData,n=this.scaleX,r=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/r;let s=t.width,o=t.height,a=Math.round(s*n),c=Math.round(o*r),l;l=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,o,a,c):this.resizeType==="hermite"?this.hermiteFastResize(e,s,o,a,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,o,a,c):this.resizeType==="lanczos"?this.lanczosResize(e,s,o,a,c):new ImageData(a,c),e.imageData=l}sliceByTwo(e,t,n,r,s){let o=e.imageData,a=.5,c=!1,l=!1,u=t*a,d=n*a,h=e.filterBackend.resources,f=0,p=0,g=t,y=0;h.sliceByTwo||(h.sliceByTwo=Ee());let _=h.sliceByTwo;(_.width<1.5*t||_.height<n)&&(_.width=1.5*t,_.height=n);let b=_.getContext("2d");for(b.clearRect(0,0,1.5*t,n),b.putImageData(o,0,0),r=Math.floor(r),s=Math.floor(s);!c||!l;)t=u,n=d,r<Math.floor(u*a)?u=Math.floor(u*a):(u=r,c=!0),s<Math.floor(d*a)?d=Math.floor(d*a):(d=s,l=!0),b.drawImage(_,f,p,t,n,g,y,u,d),f=g,p=y,y+=d;return b.getImageData(f,p,r,s)}lanczosResize(e,t,n,r,s){let o=e.imageData.data,a=e.ctx.createImageData(r,s),c=a.data,l=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,h=2/this.rcpScaleX,f=2/this.rcpScaleY,p=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(d*this.lanczosLobes/2),y={},_={x:0,y:0},b={x:0,y:0};return function S(E){let A,O,R,M,le,me,Le,Oe,ue,Ie,Mt;for(_.x=(E+.5)*u,b.x=Math.floor(_.x),A=0;A<s;A++){for(_.y=(A+.5)*d,b.y=Math.floor(_.y),le=0,me=0,Le=0,Oe=0,ue=0,O=b.x-p;O<=b.x+p;O++)if(!(O<0||O>=t)){Ie=Math.floor(1e3*Math.abs(O-_.x)),y[Ie]||(y[Ie]={});for(let mt=b.y-g;mt<=b.y+g;mt++)mt<0||mt>=n||(Mt=Math.floor(1e3*Math.abs(mt-_.y)),y[Ie][Mt]||(y[Ie][Mt]=l(Math.sqrt(Math.pow(Ie*h,2)+Math.pow(Mt*f,2))/1e3)),R=y[Ie][Mt],R>0&&(M=4*(mt*t+O),le+=R,me+=R*o[M],Le+=R*o[M+1],Oe+=R*o[M+2],ue+=R*o[M+3]))}M=4*(A*r+E),c[M]=me/le,c[M+1]=Le/le,c[M+2]=Oe/le,c[M+3]=ue/le}return++E<r?S(E):a}(0)}bilinearFiltering(e,t,n,r,s){let o,a,c,l,u,d,h,f,p,g,y,_,b,S=0,E=this.rcpScaleX,A=this.rcpScaleY,O=4*(t-1),R=e.imageData.data,M=e.ctx.createImageData(r,s),le=M.data;for(h=0;h<s;h++)for(f=0;f<r;f++)for(u=Math.floor(E*f),d=Math.floor(A*h),p=E*f-u,g=A*h-d,b=4*(d*t+u),y=0;y<4;y++)o=R[b+y],a=R[b+4+y],c=R[b+O+y],l=R[b+O+4+y],_=o*(1-p)*(1-g)+a*p*(1-g)+c*g*(1-p)+l*p*g,le[S++]=_;return M}hermiteFastResize(e,t,n,r,s){let o=this.rcpScaleX,a=this.rcpScaleY,c=Math.ceil(o/2),l=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(r,s),h=d.data;for(let f=0;f<s;f++)for(let p=0;p<r;p++){let g=4*(p+f*r),y=0,_=0,b=0,S=0,E=0,A=0,O=0,R=(f+.5)*a;for(let M=Math.floor(f*a);M<(f+1)*a;M++){let le=Math.abs(R-(M+.5))/l,me=(p+.5)*o,Le=le*le;for(let Oe=Math.floor(p*o);Oe<(p+1)*o;Oe++){let ue=Math.abs(me-(Oe+.5))/c,Ie=Math.sqrt(Le+ue*ue);Ie>1&&Ie<-1||(y=2*Ie*Ie*Ie-3*Ie*Ie+1,y>0&&(ue=4*(Oe+M*t),O+=y*u[ue+3],b+=y,u[ue+3]<255&&(y=y*u[ue+3]/250),S+=y*u[ue],E+=y*u[ue+1],A+=y*u[ue+2],_+=y))}}h[g]=S/_,h[g+1]=E/_,h[g+2]=A/_,h[g+3]=O/b}return d}};m(Ki,"type","Resize"),m(Ki,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),m(Ki,"uniformLocations",["uDelta","uTaps"]),I.setClass(Ki);var Qi=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=-this.saturation;for(let r=0;r<t.length;r+=4){let s=Math.max(t[r],t[r+1],t[r+2]);t[r]+=s!==t[r]?(s-t[r])*n:0,t[r+1]+=s!==t[r+1]?(s-t[r+1])*n:0,t[r+2]+=s!==t[r+2]?(s-t[r+2])*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};m(Qi,"type","Saturation"),m(Qi,"defaults",{saturation:0}),m(Qi,"uniformLocations",["uSaturation"]),I.setClass(Qi);var Ji=class extends De{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e,n=-this.vibrance;for(let r=0;r<t.length;r+=4){let s=Math.max(t[r],t[r+1],t[r+2]),o=(t[r]+t[r+1]+t[r+2])/3,a=2*Math.abs(s-o)/255*n;t[r]+=s!==t[r]?(s-t[r])*a:0,t[r+1]+=s!==t[r+1]?(s-t[r+1])*a:0,t[r+2]+=s!==t[r+2]?(s-t[r+2])*a:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};m(Ji,"type","Vibrance"),m(Ji,"defaults",{vibrance:0}),m(Ji,"uniformLocations",["uVibrance"]),I.setClass(Ji);var Ce=Object.freeze({__proto__:null,BaseFilter:De,BlackWhite:CM,BlendColor:Vi,BlendImage:Bi,Blur:Hi,Brightness:Ui,Brownie:pM,ColorMatrix:In,Composed:Fo,Contrast:Gi,Convolute:zi,Gamma:$i,Grayscale:Wi,HueRotation:gs,Invert:Yi,Kodachrome:mM,Noise:qi,Pixelate:Xi,Polaroid:yM,RemoveColor:Zi,Resize:Ki,Saturation:Qi,Sepia:_M,Technicolor:vM,Vibrance:Ji,Vintage:gM});function yC(i){let e;switch(i){case re.Polaroid:e=new Ce.Polaroid;break;case re.Sepia:e=new Ce.Sepia;break;case re.Kodachrome:e=new Ce.Kodachrome;break;case re.Contrast:e=new Ce.Contrast({contrast:.3});break;case re.Brightness:e=new Ce.Brightness({brightness:.8});break;case re.Greyscale:e=new Ce.Grayscale;break;case re.Brownie:e=new Ce.Brownie;break;case re.Vintage:e=new Ce.Vintage;break;case re.Technicolor:e=new Ce.Technicolor;break;case re.Pixelate:e=new Ce.Pixelate;break;case re.Invert:e=new Ce.Invert;break;case re.Blur:e=new Ce.Blur({blur:.5});break;case re.Sharpen:e=new Ce.Convolute({matrix:[0,-1,0,-1,5,-1,0,-1,0]});break;case re.Emboss:e=new Ce.Convolute({matrix:[1,1,1,1,.7,-1,-1,-1,-1]});break;case re.RemoveColor:e=new Ce.RemoveColor({threshold:.2,distance:.5,value:"#ffffff"});break;case re.BlacknWhite:e=new Ce.BlackWhite;break;case re.Vibrance:e=new Ce.Vibrance({vibrance:1});break;case re.BlendColor:e=new Ce.BlendColor({color:"#00ff00",mode:"multiply"});break;case re.HueRotate:e=new Ce.HueRotation({rotation:.5});break;case re.Resize:e=new Ce.Resize;break;case re.Saturation:e=new Ce.Saturation({saturation:.7});break;case re.Gamma:e=new Ce.Gamma({gamma:[1,.5,2.1]});break;default:return}return e}var _C=10,wl=class extends an{constructor(e,t,n,r=!0){super(),this.fabricCanvas=e,this.selection=t,this.flipMask=(u,d)=>{this.set({interactive:u}),this.fabricCanvas.setActiveObject(d),this.fabricCanvas.requestRenderAll()},this.renderIcon=(u,d,h,f)=>{u.save(),u.translate(d,h),u.rotate(eC.degreesToRadians(this.angle)),u.drawImage(f,-24/2,-24/2,24,24),u.restore()},this.fabricCanvas.remove(this.selection),this.fabricCanvas.preserveObjectStacking=!0,this.add(this.selection);let s=this.createClipPath(n,this),o=j0(),a=V0();this.set(ne({subTargetCheck:!0,interactive:!1,objectCaching:r,backgroundColor:"#1c274c",clipPath:s},Zr)),this.setControlsVisibility({tr:!1});let c=new Ue({x:.5,y:-.5,cursorStyle:"pointer",actionName:"mask",mouseUpHandler:()=>{this.flipMask(!0,this.selection)},render:(u,d,h)=>{this.renderIcon(u,d,h,o)}});this.selection.setControlsVisibility({tr:!1}),this.selection.set({borderDashArray:[4,4]});let l=new Ue({x:.5,y:-.5,cursorStyle:"pointer",actionName:"mask",mouseUpHandler:()=>{this.flipMask(!1,this)},render:(u,d,h)=>{this.renderIcon(u,d,h,a)}});this.selection.controls.mask=l,this.controls.mask=c,this.layoutManager.strategy=new ws,this.triggerLayout()}createClipPath(e,t){let n={scaleX:_C,scaleY:_C,radius:110,originX:"center",originY:"center",group:t},r=new xn(bc[e]);return r.set(n),r}};var un=(()=>{let e=class e{constructor(n){this.eventService=n}get activeSelection(){return this.fabricCanvas.getActiveObject()}async init(n,r,s,o){this.eventService.wait();let a=new Cs(n,r);return q.configure({textureSize:2e4}),a.on("selection:created",this.selectEvent.bind(this)),a.on("selection:updated",this.selectEvent.bind(this)),a.on("selection:cleared",this.deselectEvent.bind(this)),this.fabricCanvas=a,await this.setData(s),await this.setBackGroundImage(r,o),this.fabricCanvas.requestRenderAll(),this.eventService.wait(!1),a}async setBackGroundImage(n,r){if(r)try{let s=await ot.fromURL(r,{crossOrigin:"anonymous"}),o=s.width,a=s.height,c=n.width/o,l=o/a,u=n.width/l;s.scale(c),this.fabricCanvas.setDimensions({height:u}),this.fabricCanvas.set({backgroundImage:s})}catch{console.error(`Unable to load ${r}`)}}async setData(n){if(!n)return;await this.fabricCanvas.loadFromJSON(n),this.fabricCanvas.getObjects().forEach(s=>{s.set(Zr)})}addText(){let n=new sn("Type Here.",st);this.fabricCanvas.add(n),this.fabricCanvas.requestRenderAll()}async addMedia(n){this.eventService.wait();let r=n.img,s=await ot.fromURL(r,{crossOrigin:"anonymous"});this.addImageToCanvas(s)}loadMedia(n){this.eventService.wait();let r=n.img,s=new ot(r);this.addImageToCanvas(s)}addImageToCanvas(n){this.setImageDimen(n),this.fabricCanvas.add(n),this.fabricCanvas.requestRenderAll(),this.eventService.wait(!1)}deleteSelected(){this.activeSelection&&(this.fabricCanvas.remove(this.activeSelection),this.fabricCanvas.requestRenderAll())}deselect(){this.fabricCanvas.discardActiveObject(),this.fabricCanvas.requestRenderAll()}flip(n){let r=this.activeSelection?.get(n);r!==void 0&&(this.activeSelection?.set(n,!r),this.fabricCanvas.requestRenderAll())}flipLock(){if(this.activeSelection){let n=!this.activeSelection.get("lock");this.activeSelection.lockMovementX=n,this.activeSelection.lockMovementY=n,this.activeSelection.lockScalingX=n,this.activeSelection.lockMovementY=n,this.activeSelection.hasControls=!n,this.activeSelection.set("editable",!n),this.activeSelection.set("lock",n),this.fabricCanvas.requestRenderAll(),this.eventService.activeObjectLocked.set(n)}}sendBackwards(){this.activeSelection&&(this.fabricCanvas.sendObjectBackwards(this.activeSelection),this.fabricCanvas.discardActiveObject(),this.fabricCanvas.requestRenderAll())}bringForward(){this.activeSelection&&(this.fabricCanvas.bringObjectForward(this.activeSelection),this.fabricCanvas.discardActiveObject(),this.fabricCanvas.requestRenderAll())}setProps(n){this.activeSelection&&(this.activeSelection.set(ne({},n)),this.fabricCanvas.requestRenderAll())}async editMask(n){if(this.activeSelection){let r=this.activeSelection;if(r){r.set({interactive:!0});let s=r.item(0);s&&this.fabricCanvas.setActiveObject(s),this.fabricCanvas.requestRenderAll()}}}createMask(n){let r=this.activeSelection;if(r&&r.type==="image"){let s=new wl(this.fabricCanvas,this.activeSelection,n.mask);this.fabricCanvas.add(s),this.fabricCanvas.requestRenderAll()}}getCanvasData(){return{dataUrl:this.fabricCanvas.toDataURL(),dataLessJson:this.fabricCanvas.toDatalessJSON()}}setShadow({color:n,blur:r}){if(this.activeSelection){let s=new Tn({color:n,blur:r,offsetX:Yn.offsetX,offsetY:Yn.offsetY,nonScaling:Yn.nonScaling,affectStroke:Yn.nonScaling});this.activeSelection.set("shadow",s),this.fabricCanvas.requestRenderAll()}}applyFilter(n){let r=this.activeSelection;if(r?.type==="image"){let o=yC(n.type);o&&(r.filters.push(o),r.applyFilters()),this.fabricCanvas.requestRenderAll()}}selectEvent(n){let r=n.selected?n.selected[0]:null,s={event:K.OBJ_SELECTED,props:{selected:r}};this.eventService.emit(s)}deselectEvent(n){let r=n.deselected?n.deselected[0]:null,s={event:K.OBJ_DESELECTED,props:{deselected:r}};this.eventService.emit(s)}setImageDimen(n){n.set(bh);let{height:r,width:s}=this.fabricCanvas,o=s*.6,a=r*.6;n.scaleToWidth(o),n.scaleToHeight(a),n.set(ne({left:(s-n.getScaledWidth())/2,top:(r-n.getScaledHeight())/2},bh))}};e.\u0275fac=function(r){return new(r||e)(N(Me))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let i=e;return i})();function DM(i,e){if(i&1&&(w(0,"label",45),Lt(1),T(2,"input",46),x()),i&2){let t=e.$implicit;Ai("font-family",t.name),H("htmlFor",t.name),F(),Gr(" ",t.name," "),F(),H("value",t.name)("id",t.name)}}function SM(i,e){if(i&1&&(w(0,"app-card")(1,"app-tabs")(2,"app-tab",1)(3,"app-panel")(4,"div",2)(5,"div",3)(6,"div",4),T(7,"input",5),w(8,"label",6),ae(),w(9,"svg",7),T(10,"g",8)(11,"g",9),w(12,"g")(13,"g")(14,"g",10),T(15,"rect",11),x(),w(16,"g"),T(17,"path",12),x()()()()()(),Ze(),w(18,"div",4),T(19,"input",13),w(20,"label",14),ae(),w(21,"svg",15),T(22,"g",8)(23,"g",9),w(24,"g",16)(25,"g"),T(26,"rect",17)(27,"path",18)(28,"line",19),x()()()()(),Ze(),w(29,"div",4),T(30,"input",20),w(31,"label",21),ae(),w(32,"svg",22),T(33,"g",8)(34,"g",9),w(35,"g"),T(36,"path",23),x()()()()(),Ze(),w(37,"div",3)(38,"div",4),T(39,"input",24),w(40,"label",25),ae(),w(41,"svg",26),T(42,"g",8)(43,"g",9),w(44,"g")(45,"g"),T(46,"path",27),x()()()()(),Ze(),w(47,"div",4),T(48,"input",28),w(49,"label",29),ae(),w(50,"svg",26),T(51,"g",8)(52,"g",9),w(53,"g")(54,"g"),T(55,"path",30),x()()()()(),Ze(),w(56,"div",4),T(57,"input",31),w(58,"label",32),ae(),w(59,"svg",26),T(60,"g",8)(61,"g",9),w(62,"g"),T(63,"path",33),x()()()()()()(),Ze(),w(64,"app-panel",34)(65,"div")(66,"h3"),Lt(67,"Text"),x()(),w(68,"div",35),T(69,"app-color",36)(70,"app-stepper",37),x()(),w(71,"app-panel",34)(72,"div")(73,"h3"),Lt(74,"Stroke"),x()(),w(75,"div",35),T(76,"app-color",38)(77,"app-stepper",39),x()(),w(78,"app-panel",34)(79,"div")(80,"h3"),Lt(81,"Shadow"),x()(),w(82,"div",35),T(83,"app-color",40)(84,"app-stepper",41),x()()(),w(85,"app-tab",42)(86,"app-panel",43),Jt(87,DM,3,6,"label",44,Ur),x()()()()),i&2){let t=ie();F(5),H("formGroup",t.group),F(32),H("formGroup",t.group),F(27),H("formGroup",t.group),F(5),H("group",t.group),F(),H("group",t.group),F(),H("formGroup",t.group),F(5),H("group",t.group),F(),H("group",t.group),F(),H("formGroup",t.shadowGroup),F(5),H("group",t.shadowGroup),F(),H("group",t.shadowGroup),F(2),H("formGroup",t.group),F(),en(t.dataService.fonts)}}var CC=(()=>{let e=class e{constructor(n,r){this.dataService=n,this.fabricService=r,this.group=new Co({fill:new ft(st.fill),stroke:new ft(st.stroke),fontWeight:new ft(!1),fontSize:new ft(st.fontSize),strokeWidth:new ft(st.strokeWidth),underline:new ft(st.underline),textAlign:new ft(st.textAlign),fontStyle:new ft(!1),fontFamily:new ft(st.fontFamily)}),this.shadowGroup=new Co({color:new ft(Yn.color),blur:new ft(Yn.blur)})}ngOnInit(){this.group.events.pipe(Ns(n=>n instanceof ki)).subscribe(async n=>{let r=n.value;this.updateValue(r,"fontWeight","bold","normal"),this.updateValue(r,"fontStyle","italic","normal");let s=this.getFontItem(r.fontFamily);s&&await dy(s),this.fabricService.setProps(n.value)}),this.shadowGroup.events.pipe(Ns(n=>n instanceof ki)).subscribe(n=>{this.fabricService.setShadow(n.value)})}getFontItem(n){return this.dataService.fonts.find(r=>r.name===n)}updateValue(n,r,s,o){n[r]=n[r]?s:o}};e.\u0275fac=function(r){return new(r||e)(D(rs),D(un))},e.\u0275cmp=J({type:e,selectors:[["app-text-settings"]],standalone:!0,features:[te],decls:1,vars:0,consts:[[4,"validatePlan"],["title","Text"],[1,"flex","gap-1"],[1,"radio-group",3,"formGroup"],[1,"lbl-radio"],["type","checkbox","id","fontweight","formControlName","fontWeight"],["for","fontweight"],["viewBox","0 0 48 48","xmlns","http://www.w3.org/2000/svg","fill","currentColor",1,"icon"],["stroke-width","0"],["stroke-linecap","round","stroke-linejoin","round"],["data-name","invisible box"],["width","48","height","48","fill","none"],["d","M34.4,23.1A11,11,0,0,0,26,5H9V43H28A11,11,0,0,0,39,32,10.8,10.8,0,0,0,34.4,23.1ZM15,11H26a5,5,0,0,1,0,10H15ZM28,37H15V27H28a5,5,0,0,1,0,10Z"],["type","checkbox","id","underline","formControlName","underline"],["for","underline"],["viewBox","0 0 24 24","version","1.1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","fill","currentColor",1,"icon"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["fill-rule","nonzero","x","0","y","0","width","24","height","24"],["d","M6,4 L6,11 C6,14.3137 8.68629,17 12,17 L12,17 C15.3137,17 18,14.3137 18,11 L18,4","id","Path","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["x1","4","y1","21","x2","20","y2","21","id","Path","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["type","checkbox","id","italic","formControlName","fontStyle"],["for","italic"],["fill","currentColor","viewBox","0 0 256 256","id","Flat","xmlns","http://www.w3.org/2000/svg",1,"icon"],["d","M199.99414,55.99512a8.00008,8.00008,0,0,1-8,8H157.76l-42.6665,128h28.90063a8,8,0,0,1,0,16H104.02307l-.028.002-.02735-.002H63.99414a8,8,0,0,1,0-16H98.22827l42.66651-128H111.99414a8,8,0,0,1,0-16h80A8.00008,8.00008,0,0,1,199.99414,55.99512Z"],["type","radio","id","left","value","left","formControlName","textAlign"],["for","left"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4 18H14M4 14H20M4 10H14M4 6H20","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","radio","id","center","value","center","formControlName","textAlign"],["for","center"],["d","M17 18H7M20 14H4M17 10H7M20 6H4","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","radio","id","right","value","right","formControlName","textAlign"],["for","right"],["d","M5 6H19M9 10H19M5 14H19M9 18H19","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[3,"formGroup"],[1,"grid","grid-2","gap-1"],["name","fill",3,"group"],["name","fontSize",3,"group"],["name","stroke",3,"group"],["name","strokeWidth",3,"group"],["name","color",3,"group"],["name","blur",3,"group"],["title","Fonts"],["panelHeight","300px",3,"formGroup"],[1,"lbl-fonts",3,"htmlFor","fontFamily"],[1,"lbl-fonts",3,"htmlFor"],["type","radio","formControlName","fontFamily",3,"value","id"]],template:function(r,s){r&1&&Re(0,SM,89,12,"app-card",0)},dependencies:[fy,hy,is,Xn,Mh,kh,ts,ns,Pi,Ni,Yr,Xr,Wn,$n,qr]});let i=e;return i})();var wC=(()=>{let e=class e{constructor(n,r,s,o){this.viewContainerRef=n,this.dataService=r,this.eventService=s,this.fabricService=o,this.actionEvent=null}ngOnChanges(n){"actionEvent"in n&&n.actionEvent.currentValue&&this.handleEvent(n.actionEvent.currentValue)}handleEvent(n){let{event:r,props:s}=n;switch(r){case K.ADD_TEXT:{this.fabricService.addText();break}case K.ADD_IMAGE:{this.fabricService.addMedia(s);break}case K.DELETE_SELECTED:{this.viewContainerRef.clear(),this.fabricService.deleteSelected();break}case K.FLIP_VERTICAL:case K.FLIP_HORIZONTAL:{this.fabricService.flip(r);break}case K.SEND_BACKWARDS:{this.fabricService.sendBackwards();break}case K.BRING_FORWARD:{this.fabricService.bringForward();break}case K.LOCK_OBJECT:{this.fabricService.flipLock();break}case K.APPLY_FILTER:{s.filter&&this.fabricService.applyFilter(s.filter);break}case K.LOAD_IMG_FROM_FILE:{this.fabricService.loadMedia(s);break}case K.CREATE_MASK:{this.fabricService.createMask(s);break}case K.OPEN_GALLERY:case K.OBJ_SELECTED:{this.eventService.activeSelection.set(!0),this.createModalComponent(n);break}case K.OBJ_DESELECTED:case K.CLOSE_MODAL:{this.viewContainerRef.clear(),this.eventService.activeSelection.set(!1),this.fabricService.deselect();break}}}createModalComponent(n){let{props:r}=n,s=this.getComponentType(n);if(this.viewContainerRef.clear(),s){let a=this.viewContainerRef.createComponent(s).instance;switch(s){case wh:{a.mediaItems=this.dataService.mediaItems;break}case Sh:{let c=r.selected;a.src=c.getSrc();break}}}}getComponentType(n){let{event:r,props:s}=n;switch(r){case K.OPEN_GALLERY:return wh;case K.OBJ_SELECTED:{let o=s.selected?.type;if(o=="i-text")return CC;if(o==="image")return Sh}}return null}};e.\u0275fac=function(r){return new(r||e)(D(Nt),D(rs),D(Me),D(un))},e.\u0275dir=ve({type:e,selectors:[["","eventDispatcher",""]],inputs:{actionEvent:"actionEvent"},standalone:!0,features:[Kt]});let i=e;return i})();function xM(i,e){i&1&&(ae(),w(0,"svg",3)(1,"g"),T(2,"path",17),x()())}function EM(i,e){i&1&&(ae(),w(0,"svg",3)(1,"g"),T(2,"path",18),x()())}function IM(i,e){if(i&1){let t=We();w(0,"button",2),ee("click",function(){Be(t);let r=ie(2);return He(r.clicked(r.EventType.FLIP_HORIZONTAL))}),ae(),w(1,"svg",3)(2,"g"),T(3,"path",19)(4,"path",20)(5,"path",21),x()()()}}function TM(i,e){if(i&1){let t=We();w(0,"button",2),ee("click",function(){Be(t);let r=ie(2);return He(r.clicked(r.EventType.FLIP_VERTICAL))}),ae(),w(1,"svg",22)(2,"g"),T(3,"path",19)(4,"path",20)(5,"path",21),x()()()}}function MM(i,e){if(i&1){let t=We();w(0,"button",2),ee("click",function(){Be(t);let r=ie(2);return He(r.clicked(r.EventType.BRING_FORWARD))}),ae(),w(1,"svg",23),T(2,"path",24),x()()}}function AM(i,e){if(i&1){let t=We();w(0,"button",2),ee("click",function(){Be(t);let r=ie(2);return He(r.clicked(r.EventType.SEND_BACKWARDS))}),ae(),w(1,"svg",25),T(2,"path",24),x()()}}function OM(i,e){if(i&1){let t=We();w(0,"button",2),ee("click",function(){Be(t);let r=ie();return He(r.clicked(r.EventType.DELETE_SELECTED))}),ae(),w(1,"svg",3),T(2,"path",12)(3,"path",13)(4,"path",14)(5,"path",15),x()(),Ze(),w(6,"button",2),ee("click",function(){Be(t);let r=ie();return He(r.clicked(r.EventType.LOCK_OBJECT))}),Re(7,xM,3,0,":svg:svg",3)(8,EM,3,0,":svg:svg",3),x(),Re(9,IM,6,0,"button",16)(10,TM,6,0,"button",16)(11,MM,3,0,"button",16)(12,AM,3,0,"button",16)}if(i&2){let t=ie();F(7),Ft(t.eventService.activeObjectLocked()?7:8)}}function kM(i,e){if(i&1){let t=We();w(0,"button",26),ee("click",function(){Be(t);let r=ie();return He(r.save())}),w(1,"span"),Lt(2,"Save"),x()()}}var bC=(()=>{let e=class e{constructor(n,r,s){this.eventService=n,this.validatorService=r,this.fabricService=s,this.EventType=K}clicked(n){this.eventService.emit({event:n,props:{}})}save(){this.eventEmitter&&this.eventEmitter.emit(this.fabricService.getCanvasData())}};e.\u0275fac=function(r){return new(r||e)(D(Me),D(Wr),D(un))},e.\u0275cmp=J({type:e,selectors:[["app-action-bar"]],inputs:{eventEmitter:"eventEmitter"},standalone:!0,features:[te],decls:18,vars:1,consts:[[1,"action-grid"],[1,"flex","gap-1"],[1,"btn-icon",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["opacity","0.5","d","M2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12Z","fill","currentColor"],["d","M9.95197 6.25001C9.52212 6.24994 9.12024 6.24987 8.79192 6.29892C8.42103 6.35433 8.04 6.48531 7.73543 6.82372C7.44103 7.15083 7.3371 7.54062 7.29205 7.91295C7.24993 8.26097 7.24997 8.69239 7.25 9.17955L7.25 9.75001C7.25 10.1642 7.58579 10.5 8 10.5C8.41422 10.5 8.75 10.1642 8.75 9.75001V9.22223C8.75 8.67932 8.7513 8.34012 8.78118 8.09314C8.79521 7.97726 8.81273 7.91049 8.8269 7.87222C8.83886 7.83994 8.8474 7.83047 8.85023 7.82732L8.85104 7.82638C8.85241 7.82474 8.85341 7.82354 8.86242 7.81941C8.87905 7.81181 8.92169 7.79618 9.01354 7.78246C9.21765 7.75197 9.50512 7.75001 10 7.75001H11.25V16.25H9.5C9.08579 16.25 8.75 16.5858 8.75 17C8.75 17.4142 9.08579 17.75 9.5 17.75H15C15.4142 17.75 15.75 17.4142 15.75 17C15.75 16.5858 15.4142 16.25 15 16.25H12.75V7.75001H14C14.4949 7.75001 14.7824 7.75197 14.9865 7.78246C15.0783 7.79618 15.121 7.81181 15.1376 7.81941C15.1466 7.82354 15.1476 7.82474 15.149 7.82638L15.1496 7.82717C15.1525 7.83032 15.1612 7.83994 15.1731 7.87222C15.1873 7.91049 15.2048 7.97726 15.2188 8.09314C15.2487 8.34012 15.25 8.67932 15.25 9.22223V9.75001C15.25 10.1642 15.5858 10.5 16 10.5C16.4142 10.5 16.75 10.1642 16.75 9.75001L16.75 9.17954V9.17953C16.75 8.69239 16.7501 8.26096 16.708 7.91295C16.6629 7.54062 16.559 7.15083 16.2646 6.82372C15.96 6.48531 15.579 6.35433 15.2081 6.29892C14.8798 6.24987 14.4779 6.24994 14.048 6.25001H9.95197Z","fill","currentColor"],["d","M18.5116 10.0767C18.5116 10.8153 17.8869 11.4142 17.1163 11.4142C16.3457 11.4142 15.7209 10.8153 15.7209 10.0767C15.7209 9.33801 16.3457 8.7392 17.1163 8.7392C17.8869 8.7392 18.5116 9.33801 18.5116 10.0767Z","fill","currentColor"],["fill-rule","evenodd","clip-rule","evenodd","d","M18.0363 5.53205C16.9766 5.39548 15.6225 5.39549 13.9129 5.39551H10.0871C8.37751 5.39549 7.02343 5.39548 5.9637 5.53205C4.87308 5.6726 3.99033 5.96873 3.29418 6.63601C2.59803 7.30329 2.28908 8.14942 2.14245 9.19481C1.99997 10.2106 1.99999 11.5085 2 13.1472V13.2478C1.99999 14.8864 1.99997 16.1843 2.14245 17.2001C2.28908 18.2455 2.59803 19.0916 3.29418 19.7589C3.99033 20.4262 4.87307 20.7223 5.9637 20.8629C7.02344 20.9994 8.37751 20.9994 10.0871 20.9994H13.9129C15.6225 20.9994 16.9766 20.9994 18.0363 20.8629C19.1269 20.7223 20.0097 20.4262 20.7058 19.7589C21.402 19.0916 21.7109 18.2455 21.8575 17.2001C22 16.1843 22 14.8864 22 13.2478V13.1472C22 11.5085 22 10.2106 21.8575 9.19481C21.7109 8.14942 21.402 7.30329 20.7058 6.63601C20.0097 5.96873 19.1269 5.6726 18.0363 5.53205ZM6.14963 6.8576C5.21373 6.97821 4.67452 7.2044 4.28084 7.58175C3.88716 7.95911 3.65119 8.47595 3.52536 9.37303C3.42443 10.0926 3.40184 10.9919 3.3968 12.1682L3.86764 11.7733C4.99175 10.8305 6.68596 10.8846 7.74215 11.897L11.7326 15.7219C12.1321 16.1049 12.7611 16.1571 13.2234 15.8457L13.5008 15.6589C14.8313 14.7626 16.6314 14.8664 17.8402 15.9092L20.2479 17.9862C20.3463 17.7222 20.4206 17.4071 20.4746 17.0219C20.6032 16.1056 20.6047 14.8977 20.6047 13.1975C20.6047 11.4972 20.6032 10.2893 20.4746 9.37303C20.3488 8.47595 20.1128 7.95911 19.7192 7.58175C19.3255 7.2044 18.7863 6.97821 17.8504 6.8576C16.8944 6.73441 15.6343 6.73298 13.8605 6.73298H10.1395C8.36575 6.73298 7.10559 6.73441 6.14963 6.8576Z","fill","currentColor"],["opacity","0.5"],["d","M17.0866 2.61039C16.2268 2.49997 15.1321 2.49998 13.7675 2.5H10.6778C9.31314 2.49998 8.21844 2.49997 7.35863 2.61039C6.46826 2.72473 5.72591 2.96835 5.13712 3.53075C4.79755 3.8551 4.56886 4.22833 4.41309 4.64928C4.91729 4.41928 5.48734 4.28374 6.12735 4.20084C7.21173 4.06037 8.5973 4.06038 10.3466 4.06039H14.2615C16.0108 4.06038 17.3963 4.06037 18.4807 4.20084C19.0397 4.27325 19.5453 4.38581 20.0003 4.56638C19.8457 4.17917 19.6253 3.83365 19.3081 3.53075C18.7193 2.96835 17.977 2.72473 17.0866 2.61039Z","fill","currentColor"],[1,"flex","justify-center","gap-1"],["class","btn-primary",3,"click",4,"validatePlan"],["d","M3 6.52381C3 6.12932 3.32671 5.80952 3.72973 5.80952H8.51787C8.52437 4.9683 8.61554 3.81504 9.45037 3.01668C10.1074 2.38839 11.0081 2 12 2C12.9919 2 13.8926 2.38839 14.5496 3.01668C15.3844 3.81504 15.4756 4.9683 15.4821 5.80952H20.2703C20.6733 5.80952 21 6.12932 21 6.52381C21 6.9183 20.6733 7.2381 20.2703 7.2381H3.72973C3.32671 7.2381 3 6.9183 3 6.52381Z","fill","currentColor"],["d","M11.5956 22.0001H12.4044C15.1871 22.0001 16.5785 22.0001 17.4831 21.1142C18.3878 20.2283 18.4803 18.7751 18.6654 15.8686L18.9321 11.6807C19.0326 10.1037 19.0828 9.31524 18.6289 8.81558C18.1751 8.31592 17.4087 8.31592 15.876 8.31592H8.12405C6.59127 8.31592 5.82488 8.31592 5.37105 8.81558C4.91722 9.31524 4.96744 10.1037 5.06788 11.6807L5.33459 15.8686C5.5197 18.7751 5.61225 20.2283 6.51689 21.1142C7.42153 22.0001 8.81289 22.0001 11.5956 22.0001Z","fill","currentColor"],["fill-rule","evenodd","clip-rule","evenodd","d","M9.42543 11.4815C9.83759 11.4381 10.2051 11.7547 10.2463 12.1885L10.7463 17.4517C10.7875 17.8855 10.4868 18.2724 10.0747 18.3158C9.66253 18.3592 9.29499 18.0426 9.25378 17.6088L8.75378 12.3456C8.71256 11.9118 9.01327 11.5249 9.42543 11.4815Z","fill","white"],["fill-rule","evenodd","clip-rule","evenodd","d","M14.5747 11.4815C14.9868 11.5249 15.2875 11.9118 15.2463 12.3456L14.7463 17.6088C14.7051 18.0426 14.3376 18.3592 13.9254 18.3158C13.5133 18.2724 13.2126 17.8855 13.2538 17.4517L13.7538 12.1885C13.795 11.7547 14.1625 11.4381 14.5747 11.4815Z","fill","white"],["class","btn-icon",3,"click",4,"validatePlan"],["fill-rule","evenodd","clip-rule","evenodd","d","M5.25 10.0546V8C5.25 4.27208 8.27208 1.25 12 1.25C15.7279 1.25 18.75 4.27208 18.75 8V10.0546C19.8648 10.1379 20.5907 10.348 21.1213 10.8787C22 11.7574 22 13.1716 22 16C22 18.8284 22 20.2426 21.1213 21.1213C20.2426 22 18.8284 22 16 22H8C5.17157 22 3.75736 22 2.87868 21.1213C2 20.2426 2 18.8284 2 16C2 13.1716 2 11.7574 2.87868 10.8787C3.40931 10.348 4.13525 10.1379 5.25 10.0546ZM6.75 8C6.75 5.10051 9.10051 2.75 12 2.75C14.8995 2.75 17.25 5.10051 17.25 8V10.0036C16.867 10 16.4515 10 16 10H8C7.54849 10 7.13301 10 6.75 10.0036V8ZM14 16C14 17.1046 13.1046 18 12 18C10.8954 18 10 17.1046 10 16C10 14.8954 10.8954 14 12 14C13.1046 14 14 14.8954 14 16Z","fill","currentColor"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.75 8C6.75 5.10051 9.10051 2.75 12 2.75C14.4453 2.75 16.5018 4.42242 17.0846 6.68694C17.1879 7.08808 17.5968 7.32957 17.9979 7.22633C18.3991 7.12308 18.6405 6.7142 18.5373 6.31306C17.788 3.4019 15.1463 1.25 12 1.25C8.27208 1.25 5.25 4.27208 5.25 8V10.0546C4.13525 10.1379 3.40931 10.348 2.87868 10.8787C2 11.7574 2 13.1716 2 16C2 18.8284 2 20.2426 2.87868 21.1213C3.75736 22 5.17157 22 8 22H16C18.8284 22 20.2426 22 21.1213 21.1213C22 20.2426 22 18.8284 22 16C22 13.1716 22 11.7574 21.1213 10.8787C20.2426 10 18.8284 10 16 10H8C7.54849 10 7.13301 10 6.75 10.0036V8ZM14 16C14 17.1046 13.1046 18 12 18C10.8954 18 10 17.1046 10 16C10 14.8954 10.8954 14 12 14C13.1046 14 14 14.8954 14 16Z","fill","currentColor"],["d","M2 18.1136V5.88638C2 4.18423 2 3.33316 2.54242 3.05402C3.08484 2.77488 3.77738 3.26956 5.16247 4.25891L6.74371 5.38837C7.35957 5.82827 7.6675 6.04822 7.83375 6.37127C8 6.69432 8 7.07274 8 7.82957V16.1704C8 16.9273 8 17.3057 7.83375 17.6287C7.6675 17.9518 7.35957 18.1717 6.74372 18.6116L5.16248 19.7411C3.77738 20.7304 3.08484 21.2251 2.54242 20.946C2 20.6668 2 19.8158 2 18.1136Z","fill","currentColor"],["d","M22 18.1136V5.88638C22 4.18423 22 3.33316 21.4576 3.05402C20.9152 2.77488 20.2226 3.26956 18.8375 4.25891L17.2563 5.38837C16.6404 5.82827 16.3325 6.04822 16.1662 6.37127C16 6.69432 16 7.07274 16 7.82957V16.1704C16 16.9273 16 17.3057 16.1662 17.6287C16.3325 17.9518 16.6404 18.1717 17.2563 18.6116L18.8375 19.7411C20.2226 20.7304 20.9152 21.2251 21.4576 20.946C22 20.6668 22 19.8158 22 18.1136Z","fill","currentColor"],["fill-rule","evenodd","clip-rule","evenodd","d","M12 1.25C12.4142 1.25 12.75 1.58579 12.75 2V6C12.75 6.41421 12.4142 6.75 12 6.75C11.5858 6.75 11.25 6.41421 11.25 6V2C11.25 1.58579 11.5858 1.25 12 1.25ZM12 9.25C12.4142 9.25 12.75 9.58579 12.75 10V14C12.75 14.4142 12.4142 14.75 12 14.75C11.5858 14.75 11.25 14.4142 11.25 14V10C11.25 9.58579 11.5858 9.25 12 9.25ZM12 17.25C12.4142 17.25 12.75 17.5858 12.75 18V22C12.75 22.4142 12.4142 22.75 12 22.75C11.5858 22.75 11.25 22.4142 11.25 22V18C11.25 17.5858 11.5858 17.25 12 17.25Z","fill","currentColor"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg",1,"rotate-90"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","d","M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"rotate-180"],[1,"btn-primary",3,"click"]],template:function(r,s){r&1&&(w(0,"div",0)(1,"div",1)(2,"button",2),ee("click",function(){return s.clicked(s.EventType.ADD_TEXT)}),ae(),w(3,"svg",3)(4,"g"),T(5,"path",4)(6,"path",5),x()()(),Ze(),w(7,"button",2),ee("click",function(){return s.clicked(s.EventType.OPEN_GALLERY)}),ae(),w(8,"svg",3)(9,"g"),T(10,"path",6)(11,"path",7),w(12,"g",8),T(13,"path",9),x()()()()(),Ze(),w(14,"div",10),Re(15,OM,13,1),x(),w(16,"div"),Re(17,kM,3,0,"button",11),x()()),r&2&&(F(15),Ft(s.eventService.activeSelection()?15:-1))},dependencies:[$n],styles:["[_nghost-%COMP%]{padding:.5rem;position:absolute;top:0;left:0;width:100%;box-sizing:border-box}[_nghost-%COMP%]   .action-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto}"]});let i=e;return i})();function PM(i,e){i&1&&(w(0,"div",0),ae(),w(1,"svg",1)(2,"g",2)(3,"g",3),T(4,"animate",4)(5,"path",5)(6,"path",6)(7,"path",7)(8,"path",8)(9,"path",9)(10,"path",10)(11,"path",11),x()(),w(12,"defs")(13,"clipPath",12),T(14,"rect",13),x(),w(15,"clipPath",14),T(16,"rect",15),x()()()())}var DC=(()=>{let e=class e{constructor(n){this.eventService=n}};e.\u0275fac=function(r){return new(r||e)(D(Me))},e.\u0275cmp=J({type:e,selectors:[["app-spinner"]],standalone:!0,features:[te],decls:1,vars:1,consts:[[1,"spinner"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0_1863_177)"],["clip-path","url(#clip1_1863_177)"],["attributeName","opacity","values","0.5;0.6;0.8;1;0.8;0.6;0.5","dur","2s","repeatCount","indefinite"],["d","M4.82353 17.4316H1.72897C0.774085 17.4316 0 18.2076 0 19.1648V22.2668C0 23.2241 0.774085 24 1.72897 24H4.82353C5.77842 24 6.5525 23.2241 6.5525 22.2668V19.1648C6.5525 18.2076 5.77842 17.4316 4.82353 17.4316Z","fill","white"],["d","M22.0384 0.213745H18.9438C17.9889 0.213745 17.2148 0.989727 17.2148 1.94695V5.04901C17.2148 6.00623 17.9889 6.78216 18.9438 6.78216H22.0384C22.9933 6.78216 23.7673 6.00623 23.7673 5.04901V1.94695C23.7673 0.989727 22.9933 0.213745 22.0384 0.213745Z","fill","white"],["d","M4.82866 0H1.7341C0.779211 0 0.00512695 0.775982 0.00512695 1.7332V4.83527C0.00512695 5.79249 0.779211 6.56842 1.7341 6.56842H4.82866C5.78355 6.56842 6.55763 5.79249 6.55763 4.83527V1.7332C6.55763 0.775982 5.78355 0 4.82866 0Z","fill","white"],["d","M21.9659 17.179H18.8713C17.9164 17.179 17.1423 17.9549 17.1423 18.9122V22.0142C17.1423 22.9714 17.9164 23.7474 18.8713 23.7474H21.9659C22.9208 23.7474 23.6948 22.9714 23.6948 22.0142V18.9122C23.6948 17.9549 22.9208 17.179 21.9659 17.179Z","fill","white"],["d","M15.1262 11.8737C15.1262 13.6875 13.6594 15.1579 11.85 15.1579C10.0406 15.1579 8.57373 13.6875 8.57373 11.8737C8.57373 10.0599 10.0406 8.58948 11.85 8.58948C13.6594 8.58948 15.1262 10.0599 15.1262 11.8737Z","fill","white"],["d","M13.8476 17.2467H11.1414C10.016 17.1871 8.94487 16.7425 8.10696 15.9868L7.99375 15.8847C7.23754 15.0373 6.79399 13.9557 6.73693 12.8202V10.0961C6.73134 9.63715 6.54928 9.19802 6.22866 8.87026C5.90804 8.54254 5.47361 8.35146 5.01589 8.33685H1.77764C1.30617 8.33685 0.854042 8.52461 0.520671 8.85879C0.187299 9.19297 0 9.64619 0 10.1188V13.3082C0 13.7808 0.187299 14.234 0.520671 14.5683C0.854042 14.9024 1.30617 15.0901 1.77764 15.0901H4.49507C5.61953 15.1542 6.6892 15.5983 7.52953 16.35L7.63145 16.4635C8.38524 17.3035 8.82884 18.3771 8.88822 19.5053V22.218C8.88822 22.453 8.93459 22.6856 9.02461 22.9025C9.11468 23.1195 9.24664 23.3164 9.41292 23.4821C9.57916 23.6477 9.77649 23.7787 9.99347 23.8676C10.2105 23.9565 10.4428 24.0015 10.6772 24H13.8476C14.319 24 14.7712 23.8123 15.1045 23.4781C15.4379 23.1439 15.6252 22.6906 15.6252 22.218V19.0286C15.6252 18.556 15.4379 18.1028 15.1045 17.7686C14.7712 17.4344 14.319 17.2467 13.8476 17.2467Z","fill","white"],["d","M22.2223 9.12356H19.5162C18.3907 9.06399 17.3196 8.61935 16.4817 7.86373L16.3685 7.76157C15.6123 6.91419 15.1687 5.83257 15.1117 4.69705V1.97302C15.1061 1.51404 14.924 1.07491 14.6034 0.747151C14.2828 0.419437 13.8484 0.228347 13.3906 0.213745H10.1524C9.68092 0.213745 9.2288 0.401501 8.89543 0.735682C8.56206 1.06986 8.37476 1.52308 8.37476 1.99571V5.18508C8.37476 5.6577 8.56206 6.11092 8.89543 6.44515C9.2288 6.77934 9.68092 6.96704 10.1524 6.96704H12.8698C13.9943 7.03111 15.064 7.47518 15.9043 8.22691L16.0062 8.3404C16.76 9.18035 17.2036 10.254 17.263 11.3822V14.0949C17.263 14.3299 17.3093 14.5625 17.3994 14.7794C17.4894 14.9964 17.6214 15.1933 17.7877 15.359C17.9539 15.5246 18.1512 15.6556 18.3682 15.7445C18.5852 15.8333 18.8176 15.8784 19.052 15.8769H22.2223C22.6937 15.8769 23.1459 15.6891 23.4793 15.355C23.8127 15.0208 24 14.5675 24 14.0949V10.9055C24 10.4329 23.8127 9.97967 23.4793 9.64549C23.1459 9.31131 22.6937 9.12356 22.2223 9.12356Z","fill","white"],["id","clip0_1863_177"],["width","24","height","24","rx","0.375","fill","white"],["id","clip1_1863_177"],["width","24","height","24","fill","white"]],template:function(r,s){r&1&&Re(0,PM,17,0,"div",0),r&2&&Ft(s.eventService.waiting()?0:-1)},styles:[".spinner[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background-color:#000c;color:#fff;z-index:10;display:flex;justify-content:center;align-items:center}"]});let i=e;return i})();var NM=["canvas"];function RM(i,e){if(i&1&&(w(0,"div",3),T(1,"app-action-bar",4),x()),i&2){let t=ie();F(),H("eventEmitter",t.save)}}var SC=(()=>{let e=class e{set enableSave(n){this.dataService.saveEnabled=n}set busy(n){this.eventService.wait(n)}constructor(n,r,s,o,a,c){this.eventService=n,this.validatorService=r,this.dataService=s,this.fabricService=o,this.renderer=a,this.el=c,this.mediaItems=[],this.fonts=[],this.digest="",this.plan="free",this.save=new se}async ngAfterViewInit(){let{clientWidth:n,clientHeight:r}=this.el.nativeElement,s=await this.fabricService.init(this.canvas.nativeElement,{backgroundColor:"#f1f1f1",width:n,height:r},this.data,this.background),o=this.el.nativeElement;this.renderer.setStyle(o,"height",`${s.height}px`),this.renderer.setStyle(o,"width",`${s.width}px`)}async ngOnInit(){this.eventService.wait(),await this.validatorService.validate(this.digest,this.plan,this.expiry),this.dataService.mediaItems=this.mediaItems,this.dataService.fonts=this.fonts,this.eventService.wait(!1)}};e.\u0275fac=function(r){return new(r||e)(D(Me),D(Wr),D(rs),D(un),D(bt),D(ye))},e.\u0275cmp=J({type:e,selectors:[["app-root"]],viewQuery:function(r,s){if(r&1&&Hd(NM,7),r&2){let o;io(o=ro())&&(s.canvas=o.first)}},inputs:{mediaItems:"mediaItems",fonts:"fonts",data:"data",background:"background",digest:"digest",plan:"plan",expiry:"expiry",enableSave:"enableSave",busy:"busy"},outputs:{save:"save"},standalone:!0,features:[ht([Me,un]),te],decls:6,vars:2,consts:[["canvas",""],["eventDispatcher","",1,"image-craft",3,"actionEvent"],[1,"fabric-container"],[1,"actions-bar"],[3,"eventEmitter"]],template:function(r,s){r&1&&(w(0,"div",1)(1,"div",2),T(2,"canvas",null,0),x(),Re(4,RM,2,1,"div",3),T(5,"app-spinner"),x()),r&2&&(H("actionEvent",s.eventService.event()),F(4),Ft(s.validatorService.valid()!==null?4:-1))},dependencies:[wC,bC,DC],styles:[`:host{--primary-color: #1c274c;--button-primary: rgb(0, 122, 255);--button-primary-hover: rgb(0, 100, 255);--card-background: #ffffff;--border-color: #e9e9e9;--hightlight-color: #eeeeee;--checkbox-checked: #4e8ece}.grid{display:grid}.grid-1{grid-template-columns:1fr}.grid-2{grid-template-columns:repeat(2,1fr)}.flex{display:flex}.flex-1{flex:1}.flex-col{flex-direction:column}.item-center{align-items:center}.gap-1{gap:8px}.gap-2{gap:16px}.justify-center{justify-content:center}.absolute{position:absolute}.top-0{top:0}.right-0{right:0;left:auto!important}.p-1{padding:8px}.rotate-90{transform:rotate(90deg);transform-origin:50% 50%}.rotate-180{transform:rotate(180deg);transform-origin:50% 50%}.border-b{border-bottom:1px solid var(--border-color)}.overflow-y{overflow-y:auto}button,ul,h2,h3{padding:0;margin:0;border:none;outline:none;display:block;background:none}h2{font-size:15px;font-weight:700}h3{font-size:14px;font-weight:700}button:hover{cursor:pointer}.btn-icon{color:var(--primary-color)}.btn-icon:hover{background-color:var(--hightlight-color);border-radius:4px}.btn-icon svg{display:block;height:24px;width:24px}.btn-primary{box-shadow:1px 2px 3px #0000004d;border-radius:4px;padding:4px 8px;background-color:var(--button-primary);color:#fff;font-size:14px}.btn-primary:hover{background-color:var(--button-primary-hover)}label{box-sizing:border-box;display:block}label input{display:none}label.lbl-color{width:100%;height:100%}label.lbl-color{height:24px;width:100%;border-radius:4px;border:1px solid #cacaca}label.lbl-color input[type=color]{border:none;outline:none;height:100%;width:100%;visibility:hidden;display:block}label.lbl-file{background-color:#ccc;color:#666;display:flex;justify-content:center;align-items:center;box-sizing:border-box;cursor:pointer;padding:32px 16px;width:100%}label.lbl-file svg{height:24px;width:24px}.lbl-fonts{display:block;width:100%;cursor:pointer;padding:2px 4px;box-sizing:border-box;border-bottom:1px solid var(--border-color)}.lbl-fonts:hover{background-color:var(--hightlight-color)}.radio-group{display:flex;height:fit-content;background-color:#cecdcc;border-radius:4px;overflow:hidden}.radio-group .lbl-radio input{display:none}.radio-group .lbl-radio input:checked+label{background-color:var(--checkbox-checked);color:#f1f1f1}.radio-group .lbl-radio label{width:24px;height:24px;box-sizing:border-box;padding:4px}:host{display:block;position:relative;color:var(--primary-color);font-size:12px}
`],encapsulation:3});let i=e;return i})();var xC={providers:[Gv()]};(async()=>{let i=a0(xC),e=Yv(SC,{injector:(await i).injector});customElements.define("image-craft",e)})();
